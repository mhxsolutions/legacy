//
//	  Copyright (C) 2003-2010 GrapeCity Inc.	All rights reserved.
//

var the_fpSpread=new Fpoint_FPSpread;Function.prototype.CreateDelegate=function(a,b){return function(){return b.apply(a,arguments)}};Function.prototype.CreateCallback=function(b,a){return function(){var e=arguments.length;if(e>0){for(var d=[],c=0;c<e;c++)d[c]=arguments[c];d[e]=a;return b.apply(this,d)}return b.call(this,a)}};var SelectionBlockOptions=new function(){this.None=0;this.Cells=1;this.Rows=2;this.Columns=4;this.Sheet=8};function FpSpread_EventHandlers(){var a=the_fpSpread;this.TranslateKey=function(b){a.TranslateKey(b)};this.SetActiveSpread=function(b){a.SetActiveSpread(b)};this.MouseDown=function(b){a.MouseDown(b)};this.MouseUp=function(b){a.MouseUp(b)};this.MouseMove=function(b){a.MouseMove(b)};this.MouseWheel=function(b){a.MouseWheel(b)};this.DblClick=function(b){a.DblClick(b)};this.HandleFirstKey=function(b){a.HandleFirstKey(b)};this.DoPropertyChange=function(b){a.DoPropertyChange(b)};this.CmdbarMouseOver=function(b){a.CmdbarMouseOver(b)};this.CmdbarMouseOut=function(b){a.CmdbarMouseOut(b)};this.ScrollViewport=function(b){a.ScrollViewport(b)};this.Focus=function(b){var c=b.target;a.Focus(c)};this.docLoad=function(){if(a.spreads==null||a.spreads.length==0)return;for(var g=a.spreads.length,c=0;c<g;c++){if(a.spreads[c]==b)return;var b=a.spreads[c],e=a.GetRowCount(b);if(e>0)for(var d=0;d<e;d++){var f=a.GetRowHeightInternal(b,d);a.SetRowHeight2(b,d,f)}}};this.pageLoad=function(){for(var e=a.spreads.length,b=0;b<e;b++){var d=a.spreads[b];if(d.parentNode==null){var c=document.getElementById(d.id);if(c!=null){a.spreads[b]=c;a.Init(c,"pageLoad")}}}};a.AttachEvent(document,"keydown",this.TranslateKey,true);a.AttachEvent(document,"mouseup",this.MouseUp,false);a.AttachEvent(document,"mousedown",this.SetActiveSpread,false);a.AttachEvent(document,"keyup",this.HandleFirstKey,true);a.AttachEvent(window,"resize",a.DoResize,false);a.AttachEvent(window,"load",this.docLoad,false);typeof Sys!="undefined"&&Sys.Application.add_load(this.pageLoad);this.AttachEvents=function(b){a.AttachEvent(b,"mousedown",this.MouseDown,false);a.AttachEvent(b,"mouseup",this.MouseUp,false);a.AttachEvent(b,"mousemove",this.MouseMove,false);a.AttachEvent(b,"dblclick",this.DblClick,false);a.AttachEvent(b,"focus",this.Focus,false);var f=a.GetViewport(b);if(f!=null){a.AttachEvent(a.GetViewport(b).parentNode,"DOMAttrModified",this.DoPropertyChange,true);a.AttachEvent(a.GetViewport(b).parentNode,"scroll",this.ScrollViewport);a.AttachEvent(f,"mousewheel",this.MouseWheel)}var e=a.GetCommandBar(b);if(e!=null){a.AttachEvent(e,"mouseover",this.CmdbarMouseOver,false);a.AttachEvent(e,"mouseout",this.CmdbarMouseOut,false)}var c=a.GetPager1(b);if(c!=null){a.AttachEvent(c,"mouseover",this.CmdbarMouseOver,false);a.AttachEvent(c,"mouseout",this.CmdbarMouseOut,false)}var d=a.GetPager2(b);if(d!=null){a.AttachEvent(d,"mouseover",this.CmdbarMouseOver,false);a.AttachEvent(d,"mouseout",this.CmdbarMouseOut,false)}};this.DetachEvents=function(b){a.DetachEvent(b,"mousedown",this.MouseDown,false);a.DetachEvent(b,"mouseup",this.MouseUp,false);a.DetachEvent(b,"mousemove",this.MouseMove,false);a.DetachEvent(b,"dblclick",this.DblClick,false);a.DetachEvent(b,"focus",this.Focus,false);var f=a.GetViewport(b);if(f!=null){a.DetachEvent(a.GetViewport(b).parentNode,"DOMAttrModified",this.DoPropertyChange,true);a.DetachEvent(a.GetViewport(b).parentNode,"scroll",this.ScrollViewport)}var e=a.GetCommandBar(b);if(e!=null){a.DetachEvent(e,"mouseover",this.CmdbarMouseOver,false);a.DetachEvent(e,"mouseout",this.CmdbarMouseOut,false)}var c=a.GetPager1(b);if(c!=null){a.DetachEvent(c,"mouseover",this.CmdbarMouseOver,false);a.DetachEvent(c,"mouseout",this.CmdbarMouseOut,false)}var d=a.GetPager2(b);if(d!=null){a.DetachEvent(d,"mouseover",this.CmdbarMouseOver,false);a.DetachEvent(d,"mouseout",this.CmdbarMouseOut,false)}}}function Fpoint_FPSpread(){this.working=false;this.editing=false;this.editor=null;this.editingValue=null;this.editingFormula=null;this.editorSelectedIndex=-1;this.renderAsEditor=-1;this.validationMsg=null;this.editorMargin=null;this.sizeColumn=null;this.sizeRow=null;this.activeX=-1;this.activeY=-1;this.activeElement=null;this.clipboardData=null;this.editorList=[];this.error=false;this.activeChartObj=null;this.preventScrollView=false;this.left=37;this.right=39;this.up=38;this.down=40;this.tab=9;this.enter=13;this.shift=16;this.space=32;this.altkey=18;this.home=36;this.end=35;this.pup=33;this.pdn=34;this.backspace=8;this.InitFields=function(a){if(this.editorMargin==null)this.editorMargin=new this.Margin;a.hierBar=null;a.groupBar=null;a.pager1=null;a.pager2=null;a.anchorCell=null;a.leadingCell=null;a.leadingCellRow=null;a.leadingCellCol=null;a.selectStartRow=null;a.selectStartCol=null;a.selectType="";a.dataBuff=null;a.dirty=false;a.slideLeft=0;a.slideRight=0;a.setAttribute("rowCount",0);a.setAttribute("colCount",0);a.spanCells=[];a.rowSpanCells=[];a.colSpanCells=[];a.footerSpanCells=[];this.activePager=null;this.dragSlideBar=false;a.allowColMove=a.getAttribute("colMove")=="true";a.allowGroup=a.getAttribute("allowGroup")=="true";a.selectionBlockOptions=SelectionBlockOptions.Cells|SelectionBlockOptions.Rows|SelectionBlockOptions.Columns|SelectionBlockOptions.Sheet;a.selectedCols=[];a.msgList=[];a.mouseY=null};this.RegisterSpread=function(a){var d=this.GetTopSpread(a);if(d!=a)return;if(this.spreads==null)this.spreads=[];for(var c=this.spreads.length,b=0;b<c;b++)if(this.spreads[b]==a)return;this.spreads.length=c+1;this.spreads[c]=a};this.Init=function(a,p){a==null&&alert("spread is not defined!");var b=new Fpoint_FPSpread;b.getViewport0=function(){return null};b.getViewport1=function(){return null};b.getViewport2=function(){return null};b.getViewport=function(){return the_fpSpread.GetViewport(a)};b.GetRowCountInternal=function(){return the_fpSpread.GetRowCountInternal(a)};b.getRowKeyFromRow=function(b){return the_fpSpread.GetRowKeyFromRow(a,b)};b.getColKeyFromCol=function(b){return the_fpSpread.GetColKeyFromCol(a,b)};b.IsChildSpreadRow=function(b,c){return the_fpSpread.IsChildSpreadRow(a,b,c)};b.frzRowCount=function(){return 0};b.frzColCount=function(){return 0};b.getAttributeInternal=function(b){return a.getAttribute(b)};b.getRowFromCell=function(b){return the_fpSpread.GetRowFromCell(a,b)};b.getViewportFromCell=function(b){return the_fpSpread.GetViewportFromCell(a,b)};b.getLeadingCellRow=function(){return a.leadingCellRow};b.getLeadingCellCol=function(){return a.leadingCellCol};b.getCellFromRowCol=function(c,b){return the_fpSpread.GetCellFromRowCol(a,c,b)};a.fpSpreadJS=new FpSpreadJS(a,b,a.fpSpreadJS);a.initialized=false;a.ignoreVirtualPaging=true;this.validationMsg=null;this.editorList=[];this.RegisterSpread(a);this.InitFields(a);this.InitMethods(a);a.selectionBlockOptions=parseInt(a.getAttribute("selectionBlockOptions"));a.retainSelectionBlock=true;a.editModePermanent=false;a.bSuspendLayout=null;a.scrollLeftInner=0;a.scrollTopInner=0;var k=a.getAttribute("RetainSelectionBlock");if(k!=null&&k=="false")a.retainSelectionBlock=false;var q=a.getAttribute("EditModePermanent");if(q)a.editModePermanent=true;a.tableData=document.getElementById(a.id+"_XMLDATA");if(a.tableData==null){a.tableData=document.createElement("XML");a.tableData.id=a.id+"_XMLDATA";a.tableData.style.display="none";document.body.insertBefore(a.tableData,null)}var e=document.getElementById(a.id+"_data");if(e!=null&&e.getAttribute("data")!=null){a.tableData.innerHTML=e.getAttribute("data");e.value=""}this.SaveData(a);a.viewport=document.getElementById(a.id+"_viewport");if(a.viewport!=null)a.tableView=a.viewport.parentNode;a.virtualPaging=a.getAttribute("virtualPaging");if(a.virtualPaging=="true"){var i=document.getElementById(a.id+"_VirtualPaging_Top");if(i==null)a.virtualPagingTop=a.virtualTop=0;else a.virtualPagingTop=a.virtualTop=parseInt(i.style.height)}else a.virtualPagingTop=a.virtualTop=0;a.preventScrollView=a.preventScrollView||false;a.corner=document.getElementById(a.id+"_corner");if(a.corner!=null&&a.corner.childNodes.length>0)a.corner=a.corner.getElementsByTagName("TABLE")[0];a.frzRows=a.frzCols=0;a.rowHeader=document.getElementById(a.id+"_rowHeader");if(a.rowHeader!=null)a.rowHeader=a.rowHeader.getElementsByTagName("TABLE")[0];a.colHeader=document.getElementById(a.id+"_colHeader");if(a.colHeader!=null)a.colHeader=a.colHeader.getElementsByTagName("TABLE")[0];a.colFooter=document.getElementById(a.id+"_colFooter");if(a.colFooter!=null)a.colFooter=a.colFooter.getElementsByTagName("TABLE")[0];a.footerCorner=document.getElementById(a.id+"_footerCorner");if(a.footerCorner!=null&&a.footerCorner.childNodes.length>0)a.footerCorner=a.footerCorner.getElementsByTagName("TABLE")[0];var d=a.commandBar=document.getElementById(a.id+"_commandBar"),f=this.GetViewport(a);if(f!=null){a.setAttribute("rowCount",f.rows.length);f.rows.length==1&&a.setAttribute("rowCount",0);a.setAttribute("colCount",f.getAttribute("cols"))}var n=a.spanCells,l=a.colSpanCells,m=a.rowSpanCells,r=a.footerSpanCells;this.InitSpan(a,this.GetViewport(a),n);this.InitSpan(a,this.GetColHeader(a),l);this.InitSpan(a,this.GetRowHeader(a),m);a.getViewport=function(){return this.viewport};a.getViewport0=function(){return this.viewport0};a.getViewport1=function(){return this.viewport1};a.getViewport2=function(){return this.viewport2};a.getRowHeader=function(){return this.rowHeader};the_fpSpread.initChartObj(a);a.fpSpreadJS.countChildViews();this.InitLayout(a);a.dirty=true;if(this.GetPageActiveSpread()==a&&(a.getAttribute("AllowInsert")=="false"||a.getAttribute("IsNewRow")=="true")){var g=this.GetCmdBtn(a,"Insert");this.UpdateCmdBtnState(g,true);g=this.GetCmdBtn(a,"Add");this.UpdateCmdBtnState(g,true)}this.CreateTextbox(a);this.CreateFocusBorder(a);a.activeChartObj==null&&this.InitSelection(a);a.initialized=true;if(this.GetPageActiveSpread()==a)try{if(document.activeElement==null||document.activeElement==a||this.IsChild(document.activeElement,a))p!="LoadOnDemand"&&this.Focus(a)}catch(s){}if(this.GetPageActiveSpread()==a)if(a.anchorCell!=null){var c=this.GetEditor(a.anchorCell);if(c!=null){this.editing=true;this.editor=c;this.renderAsEditor=1;this.editingValue=this.GetEditorValue(c,a);(c.focus||c.getAttribute("fpeditor")=="MultiColumnComboBoxCellType")&&this.SetEditorFocus(c)}}this.SaveData(a);if(this.handlers==null)this.handlers=new FpSpread_EventHandlers;this.handlers.DetachEvents(a);this.handlers.AttachEvents(a);if(d!=null&&a.style.position==""){d.parentNode.style.backgroundColor=d.style.backgroundColor;d.parentNode.style.borderTop=d.style.borderTop}this.SyncColSelection(a);a.getAttribute("ajax")=="false"&&this.fireOperationEndEvent(a);a.style.overflow="hidden";if(this.GetParentSpread(a)==null){this.LoadScrollbarState(a);var j=this.GetData(a);if(j!=null){var o=j.getElementsByTagName("root")[0],h=o.getElementsByTagName("activespread")[0];h!=null&&h.innerHTML!=""&&this.SetPageActiveSpread(document.getElementById(this.Trim(h.innerHTML)))}}a.ignoreVirtualPaging=false;this.doIgnoreVirtualPaging(a)};this.Dispose=function(a){if(this.handlers==null)this.handlers=new FpSpread_EventHandlers;this.handlers.DetachEvents(a);this.chartDispose(a)};this.fireOperationEndEvent=function(a){this.FireAutoFilterColumnCompleted(a)};this.FireAutoFilterColumnCompleted=function(a,c){if(a.getAttribute("isFiltering")=="true"&&(c==null||c==a.getAttribute("FilteringString")))if(a.getAttribute("isFilteringCancel")!="true"){var b=this.CreateEvent("AutoFilteredColumn");b.col=a.getAttribute("FilteringCol");b.spread=a;b.filterString=a.getAttribute("FilteringString");this.FireEvent(a,b)}};this.CmdbarMouseOver=function(b){var a=this.GetTarget(b);if(a!=null&&a.tagName=="IMG"&&a.getAttribute("disabled")!="true"&&a.getAttribute("disabled")!="disabled"&&a.className!="aspNetDisabled"){a.style.backgroundColor="cyan";this.SetImageButtonSrc(a,"hover")}};this.CmdbarMouseOut=function(b){var a=this.GetTarget(b);if(a!=null&&a.tagName=="IMG"&&a.getAttribute("disabled")!="true"&&a.getAttribute("disabled")!="disabled"&&a.className!="aspNetDisabled"){a.style.backgroundColor="";this.SetImageButtonSrc(a,"enable")}};this.DoPropertyChange=function(a){if(a.attrName=="curpos")this.ScrollViewport(a);else if(this.sizeColumn==null&&this.sizeRow==null&&a.attrName=="pageincrement"&&a.ctrlKey){var b=this.GetSpread(this.GetTarget(a));b!=null&&this.SizeAll(this.GetTopSpread(b))}};this.HandleFirstKey=function(){var b=this.GetPageActiveSpread();if(b==null)return;var c=this.GetTopSpread(b),a=document.getElementById(c.id+"_textBox");if(a!=null&&a.value!="")a.value=""};this.IsXHTML=function(c){var b=this.GetTopSpread(c);if(b==null)return false;var a=b.getAttribute("strictMode");return a!=null&&a=="true"};this.GetData=function(a){return a.tableData};this.AttachEvent=function(a,c,b,d){if(a.addEventListener!=null)a.addEventListener(c,b,d);else a.attachEvent!=null&&a.attachEvent("on"+c,b)};this.DetachEvent=function(a,c,b,d){if(a.removeEventListener!=null)a.removeEventListener(c,b,d);else a.detachEvent!=null&&a.detachEvent("on"+c,b)};this.CancelDefault=function(a){if(a.preventDefault!=null){a.preventDefault();a.stopPropagation()}else{a.cancelBubble=false;a.returnValue=false}return false};this.CreateEvent=function(b){var a=document.createEvent("Events");a.initEvent(b,true,true);return a};this.Refresh=function(a){var b=a.style.display;a.style.display="none";a.style.display=b};this.InitMethods=function(ss){var gso=this;ss.Edit=function(){gso.Edit(this)};ss.Update=function(){gso.Update(this)};ss.Cancel=function(){gso.Cancel(this)};ss.Clear=function(){gso.Clear(this)};ss.Copy=function(){gso.Copy(this)};ss.Paste=function(){gso.Paste(this)};ss.Prev=function(){gso.Prev(this)};ss.Next=function(){gso.Next(this)};ss.Add=function(){gso.Add(this)};ss.Insert=function(){gso.Insert(this)};ss.Delete=function(){gso.Delete(this)};ss.Print=function(){gso.Print(this)};ss.PrintPDF=function(){gso.PrintPDF(this)};ss.StartEdit=function(a){gso.StartEdit(this,a)};ss.EndEdit=function(){gso.EndEdit(this)};ss.IsValid=function(){return ss.valid!=null?ss.valid:true};ss.ClearSelection=function(){gso.ClearSelection(this)};ss.GetSelectedRange=function(){return gso.GetSelectedRange(this)};ss.SetSelectedRange=function(d,c,b,a){gso.SetSelectedRange(this,d,c,b,a)};ss.GetSelectedRanges=function(){return gso.GetSelectedRanges(this)};ss.AddSelection=function(d,c,b,a){gso.AddSelection(this,d,c,b,a)};ss.AddSpan=function(e,d,c,b,a){gso.AddSpan(this,e,d,c,b,a)};ss.RemoveSpan=function(c,b,a){gso.RemoveSpan(this,c,b,a)};ss.GetCurrentPageIndex=function(){return gso.GetCurrentPageIndex(this)};ss.GetActiveRow=function(){var a=gso.GetRowFromCell(this,this.anchorCell);return a<0?a:gso.GetSheetIndex(this,a)};ss.GetActiveCol=function(){return gso.GetColFromCell(this,this.anchorCell)};ss.SetActiveCell=function(b,a){gso.SetActiveCell(this,b,a)};ss.GetCellByRowCol=function(b,a){return gso.GetCellByRowCol(this,b,a)};ss.GetValue=function(b,a){return gso.GetValue(this,b,a)};ss.SetValue=function(d,c,e,a,b){gso.SetValue(this,d,c,e,a,b)};ss.GetFormula=function(b,a){return gso.GetFormula(this,b,a)};ss.SetFormula=function(e,c,d,b,a){gso.SetFormula(this,e,c,d,b,a)};ss.GetHiddenValue=function(b,a){return gso.GetHiddenValue(this,b,a)};ss.GetSheetRowIndex=function(a){return gso.GetSheetRowIndex(this,a)};ss.GetSheetColIndex=function(a){return gso.GetSheetColIndex(this,a)};ss.GetRowCount=function(){return gso.GetRowCount(this)};ss.GetColCount=function(){return gso.GetColCount(this)};ss.GetRowByKey=function(a){return gso.GetRowByKey(this,a,-1)};ss.GetColByKey=function(a){return gso.GetColByKey(this,a,-1)};ss.GetRowKeyFromRow=function(b){var a=gso.GetRowKeyFromRow(this,b);return a==null?-1:a};ss.GetColKeyFromCol=function(b){var a=gso.GetColKeyFromCol(this,b);return a==null?-1:a};ss.GetTotalRowCount=function(){return gso.GetTotalRowCount(this)};ss.GetPageCount=function(){return gso.GetPageCount(this)};ss.GetParentSpread=function(){return gso.GetParentSpread(this)};ss.GetChildSpread=function(b,a){return gso.GetChildSpread(this,b,a)};ss.GetChildSpreads=function(){return gso.GetChildSpreads(this)};ss.GetParentRowIndex=function(){return gso.GetParentRowIndex(this)};ss.GetActiveChildSheetView=function(){return gso.GetActiveChildSheetView(this)};ss.GetSpread=function(a){return gso.GetSpread(a)};ss.UpdatePostbackData=function(){gso.UpdatePostbackData(this)};ss.SizeToFit=function(a){gso.SizeToFit(this,a)};ss.SetColWidth=function(a,b){gso.SetColWidth(this,a,b)};ss.GetPreferredRowHeight=function(a){return gso.GetPreferredRowHeight(this,a)};ss.SetRowHeight2=function(b,a){gso.SetRowHeight2(this,b,a)};ss.CallBack=function(b,a){gso.SyncData(this.getAttribute("name"),b,this,a)};ss.LoadData=function(a){gso.LoadData(this,a)};ss.AddKeyMap=function(a,d,c,e,b){gso.AddKeyMap(this,a,d,c,e,b)};ss.RemoveKeyMap=function(a,c,b,d){gso.RemoveKeyMap(this,a,c,b,d)};ss.MoveToPrevCell=function(){gso.MoveToPrevCell(this)};ss.MoveToNextCell=function(){gso.MoveToNextCell(this)};ss.MoveToNextRow=function(a){gso.MoveToNextRow(this,a)};ss.MoveToPrevRow=function(a){gso.MoveToPrevRow(this,a)};ss.MoveToFirstColumn=function(){gso.MoveToFirstColumn(this)};ss.MoveToLastColumn=function(){gso.MoveToLastColumn(this)};ss.ScrollTo=function(b,a){gso.ScrollTo(this,b,a)};ss.focus=function(){gso.Focus(this)};ss.GetTopRowIndex=function(){return gso.GetTopRowIndex(this)};ss.GetLeftColIndex=function(){return gso.GetLeftColIndex(this)};ss.ShowMessage=function(b,d,c,a){return gso.ShowMessage(this,b,d,c,a)};ss.HideMessage=function(b,a){return gso.HideMessage(this,b,a)};ss.SetActiveChart=function(a){gso.SetActiveChart(this,a)};ss.GetActiveChart=function(){return gso.GetActiveChart(this)};ss.ProcessKeyMap=function(event){if(this.keyMap!=null)for(var n=this.keyMap.length,i=0;i<n;i++){var ka=this.keyMap[i];if(event.keyCode==ka.key&&event.ctrlKey==ka.ctrl&&event.shiftKey==ka.shift&&event.altKey==ka.alt){var ret=false;if(typeof ka.action=="function")ret=ka.action();else ret=eval(ka.action);return ret}}return true};ss.Cells=function(b,a){return gso.Cells(this,b,a)};ss.Rows=function(b,a){return gso.Rows(this,b,a)};ss.Columns=function(b,a){return gso.Columns(this,b,a)};ss.GetTitleInfo=function(b,a){return gso.GetTitleInfo(this,b,a)};ss.SizeSpread=function(a){return gso.SizeSpread(a)};ss.SortColumn=function(a){return gso.SortColumn(this,a)};ss.ExpandRow=function(a){return gso.ExpandRow(this,a)};ss.SuspendLayout=function(){gso.SuspendLayout(this)};ss.ResumeLayout=function(a){gso.ResumeLayout(this,a)};ss.rowEditTemplateContainer_keyDown=function(a){return gso.rowEditTemplateContainer_keyDown(a)};ss.rowEditTemplateContainer_textBoxFocus=function(a){return gso.rowEditTemplateContainer_textBoxFocus(a)};ss.isEditing=function(){return gso.editing};ss.startVirtualPaging=function(a){a.ignoreVirtualPaging=false};ss.stopVirtualPaging=function(a){a.ignoreVirtualPaging=true}};this.FindContentTag=function(a){if(a){if(a.attributes!=null&&a.getAttribute("content"))return a;for(var b=0;b<a.childNodes.length;b++){var c=this.FindContentTag(a.childNodes[b]);if(c)return c}}return null};this.CreateTextbox=function(b){var c=this.GetTopSpread(b);if(c==null)return;var a=document.getElementById(c.id+"_textBox");if(a==null){a=document.createElement("INPUT");a.type="text";a.setAttribute("autocomplete","off");a.style.position="absolute";a.style.borderWidth=0;a.style.top="-10px";a.style.left="-100px";a.style.width="1px";a.style.height="1px";if(b.tabIndex!=null)a.tabIndex=b.tabIndex;a.id=b.id+"_textBox";b.insertBefore(a,b.firstChild)}};this.CreateLineBorder=function(b,c){var a=document.getElementById(c);if(a==null){a=document.createElement("div");a.style.position="absolute";a.style.left="-1000px";a.style.top="0px";a.style.overflow="hidden";a.style.border="1px solid black";if(b.getAttribute("FocusBorderColor")!=null)a.style.borderColor=b.getAttribute("FocusBorderColor");if(b.getAttribute("FocusBorderStyle")!=null)a.style.borderStyle=b.getAttribute("FocusBorderStyle");a.id=c;var d=this.GetViewport(b).parentNode;d.insertBefore(a,null)}return a};this.CreateFocusBorder=function(a){if(this.GetTopSpread(a).getAttribute("hierView")=="true")return;if(this.GetTopSpread(a).getAttribute("showFocusRect")=="false")return;if(this.GetViewport(a)==null)return;var b=this.CreateLineBorder(a,a.id+"_focusRectT");b.style.height=0;b=this.CreateLineBorder(a,a.id+"_focusRectB");b.style.height=0;b=this.CreateLineBorder(a,a.id+"_focusRectL");b.style.width=0;b=this.CreateLineBorder(a,a.id+"_focusRectR");b.style.width=0};this.GetPosIndicator=function(b){var a=b.posIndicator;if(a==null)a=this.CreatePosIndicator(b);else a.parentNode!=b&&b.insertBefore(a,null);return a};this.CreatePosIndicator=function(b){var a=document.createElement("img");a.style.position="absolute";a.style.top="0px";a.style.left="-400px";a.style.width="10px";a.style.height="10px";a.style.zIndex=1e3;a.id=b.id+"_posIndicator";if(b.getAttribute("clienturl")!=null)a.src=b.getAttribute("clienturl")+"down.gif";else a.src=b.getAttribute("clienturlres");b.insertBefore(a,null);b.posIndicator=a;return a};this.InitSpan=function(b,c,j){if(c!=null){var e=0;if(c==this.GetViewport(b))e=c.rows.length;for(var h=c.rows,k=this.GetColCount(b),d=0;d<h.length;d++)if(this.IsChildSpreadRow(b,c,d)){if(c==this.GetViewport(b))e--}else for(var g=h[d].cells,f=0;f<g.length;f++){var a=g[f];if(a!=null&&(a.rowSpan!=null&&a.rowSpan>1||a.colSpan!=null&&a.colSpan>1)){var l=this.GetRowFromCell(b,a),i=parseInt(a.getAttribute("scol"));i<k&&this.AddSpan(b,l,i,a.rowSpan,a.colSpan,j)}}c==this.GetViewport(b)&&b.setAttribute("rowCount",e)}};this.GetColWithSpan=function(g,e,a,d){var f=0,c=0;if(d==0)while(this.IsCovered(g,e,c,a))c++;for(var b=0;b<a.length;b++)if(a[b].rowCount>1&&(a[b].col<=d||d==0&&a[b].col<c)&&e>=a[b].row&&e<a[b].row+a[b].rowCount)f+=a[b].colCount;return f};this.AddSpan=function(c,g,f,e,d,a){if(a==null)a=c.spanCells;var b=new this.Range;this.SetRange(b,"Cell",g,f,e,d);a.push(b);this.PaintFocusRect(c)};this.RemoveSpan=function(e,h,g,a){if(a==null)a=e.spanCells;for(var b=0;b<a.length;b++){var d=a[b];if(d.row==h&&d.col==g){for(var f=a.length-1,c=b;c<f;c++)a[c]=a[c+1];a.length=a.length-1;break}}this.PaintFocusRect(e)};this.selectAllText=function(b){if(b.anchorCell==null)return;var a=this.GetEditor(b.anchorCell);if(a!=null&&a.select){var c=a.getValue?a.getValue():a.value;if(a.setValue){a.setValue("");a.setValue(c)}else{a.value="";a.value=c}a.select()}};this.isEditModeReplace=function(c,b){var a=this.GetCellType(b);return a=="ExtenderCellType"?false:c.getAttribute("EditMode")=="replace"};this.Focus=function(a,d){if(d){var i=d.explicitOriginalTarget;if(i!=null&&this.HitCommandBar(i)&&this.GetSpread(i,true)==a)return}var h=a!=null&&this.isEditModeReplace(a,a.anchorCell);if(this.editing&&h){this.selectAllText(a);h=false;d&&this.CancelDefault(d)}if(this.editing)return;if(a.activeChartObj!=null){a.ClearSelection();a.activeChartObj.container.focus();return}if(!a.isactive){this.SetPageActiveSpread(a);a.isactive=true}var j=this.GetOperationMode(a);if(a.anchorCell==null&&j!="MultiSelect"&&j!="ExtendedSelect"&&a.GetRowCount()>0&&a.GetColCount()>0){var o=this.GetColCount(a),p=this.GetRowCount(a),l=d&&d.type=="keydown"&&d.keyCode==tab,f=this.GetNextCellRowIndex(a,0,0,l,true),e=this.GetNextCellColIndex(a,0,0,l,true);if(f<p&&e<o){var r=this.FireActiveCellChangingEvent(a,f,e,0);if(!r){var k=this.GetSelectionPolicy(a);!(j=="Normal"&&(k=="MultiRange"&&a.getAttribute("multiRange")=="true"||k=="Range"))&&this.ClearSelection(a);a.leadingCellRow=f;a.leadingCellCol=e;this.UpdateAnchorCell(a,f,e);var c=this.CreateEvent("ActiveCellChanged");c.cmdID=a.id;c.row=c.Row=f;c.col=c.Col=e;if(a.getAttribute("LayoutMode"))c.InnerRow=c.innerRow=0;this.FireEvent(a,c)}}}var q=this.GetTopSpread(a),b=document.getElementById(q.id+"_textBox"),n=b.style.top,m=b.style.left;b.style.top=document.body.scrollTop+"px";b.style.left=document.body.scrollLeft+"px";if(a.anchorCell!=null){var g=this.GetEditor(a.anchorCell);if(g==null){if(b!=null)if(this.activeElement!=b)try{b.focus()}catch(c){}}else{g.tagName!="SELECT"&&g.focus();this.SetEditorFocus(g)}}else if(b!=null)try{b.focus()}catch(c){}h&&this.selectAllText(a);b.style.top=n;b.style.left=m;this.EnableButtons(a)};this.GetTotalRowCount=function(b){var a=parseInt(b.getAttribute("totalRowCount"));if(isNaN(a))a=0;return a};this.GetPageCount=function(b){var a=parseInt(b.getAttribute("pageCount"));if(isNaN(a))a=0;return a};this.GetColCount=function(b){var a=parseInt(b.getAttribute("colCount"));if(isNaN(a))a=0;return a};this.GetRowCount=function(b){var a=parseInt(b.getAttribute("rowCount"));if(isNaN(a))a=0;return a};this.GetRowCountInternal=function(b){var a=parseInt(this.GetViewport(b).rows.length);if(isNaN(a))a=0;return a};this.IsChildSpreadRow=function(c,a,b){return FpSpreadJS.isChildSpreadRow(a,b)};this.GetChildSpread=function(e,f,d){var b=this.GetViewport(e);if(b!=null){var a=this.GetDisplayIndex(e,f)+1;if(typeof d=="number")a+=d;if(a>=1&&a<b.rows.length)if(b.rows[a].cells.length>0&&b.rows[a].cells[0]!=null&&b.rows[a].cells[0].firstChild!=null){var c=b.rows[a].cells[0].firstChild;if(c.nodeName!="#text"&&c.getAttribute("FpSpread")=="Spread")return c}}return null};this.GetChildSpreads=function(c,a){var b=a==null?c:document.getElementById(a);return b==null?null:FpSpreadJS.getChildViews(b)};this.GetDisplayIndex=function(b,a){return b.fpSpreadJS.getDisplayIndex(a)};this.GetSheetIndex=function(c,b,a){return a!=null&&a!=this.GetViewport(c)?this.GetSpread(a,true).fpSpreadJS.getSheetIndex(b):c.fpSpreadJS.getSheetIndex(b)};this.GetParentRowIndex=function(d){var a=this.GetParentSpread(d);if(a==null)return-1;var c=this.GetViewport(a);if(c==null)return-1;for(var e=d.parentNode.parentNode,b=e.rowIndex-1;b>0;b--)if(this.IsChildSpreadRow(a,c,b))continue;else break;return this.GetSheetIndex(a,b,c)};this.CreateTestBox=function(b){var a=document.getElementById(b.id+"_testBox");if(a==null){a=document.createElement("span");a.style.position="absolute";a.style.borderWidth=0;a.style.top="-500px";a.style.left="-100px";a.id=b.id+"_testBox";b.insertBefore(a,b.firstChild)}return a};this.SizeToFit=function(a,b){if(b==null||b<0)b=0;var e=this.GetViewport(a);if(e!=null){for(var h=this.CreateTestBox(a),i=e.rows,d=0,c=0;c<i.length;c++)if(!this.IsChildSpreadRow(a,e,c)){var f=this.GetCellFromRowCol(a,c,b);if(f.colSpan>1)continue;var g=this.GetPreferredCellWidth(a,f,h);if(g>d)d=g}this.SetColWidth(a,b,d)}};this.GetPreferredCellWidth=function(d,a,b){if(b==null)b=this.CreateTestBox(d);var c=this.GetRender(d,a),h=this.GetCellType(a),g=this.GetEditor(a);if(c!=null){b.style.fontFamily=c.style.fontFamily;b.style.fontSize=c.style.fontSize;b.style.fontWeight=c.style.fontWeight;b.style.fontStyle=c.style.fontStyle}if(c!=null&&h=="MultiColumnComboBoxCellType"){var f=a.getElementsByTagName("Table")[0];if(f!=null)b.innerHTML=this.GetEditorValue(g,d)+"123"}else b.innerHTML=a.innerHTML;var e=b.offsetWidth+8;if(a.style.paddingLeft!=null&&a.style.paddingLeft.length>0)e+=parseInt(a.style.paddingLeft);if(a.style.paddingRight!=null&&a.style.paddingRight.length>0)e+=parseInt(a.style.paddingRight);return e};this.GetHierBar=function(a){if(a.hierBar==null)a.hierBar=document.getElementById(a.id+"_hierBar");return a.hierBar};this.GetGroupBar=function(a){if(a.groupBar==null)a.groupBar=document.getElementById(a.id+"_groupBar");return a.groupBar};this.GetPager1=function(a){if(a.pager1==null)a.pager1=document.getElementById(a.id+"_pager1");return a.pager1};this.GetPager2=function(a){if(a.pager2==null)a.pager2=document.getElementById(a.id+"_pager2");return a.pager2};this.SynRowHeight=function(g,c,b,a,m,n){if(c==null||b==null)return;var d=c.rows[a].offsetHeight,f=b.rows[a].offsetHeight;if(b.rows[a].cells.length>0){var k=parseFloat(document.defaultView.getComputedStyle(b.rows[a].cells[0],"").getPropertyValue("height"));if(Math.round(k)!=k)f=b.rows[a].offsetHeight+1}if(d==f&&a>0)return;var i=this.IsXHTML(g);if(a==0)if(!i){d+=c.rows[a].offsetTop;f+=b.rows[a].offsetTop}else d-=b.rows[a].offsetTop-c.rows[a].offsetTop;if(i)b.rows[a].style.height="";else{for(var j=false,h=0;h<b.rows[a].cells.length;h++)if(b.rows[a].cells[h]!=null&&b.rows[a].cells[h].firstChild!=null&&b.rows[a].cells[h].firstChild.tagName=="INPUT"){j=true;break}if(j)b.rows[a].style.height=""}var e=Math.max(d,f);if(c.rows[a].style.height=="")c.rows[a].style.height=""+d+"px";if(b.rows[a].style.height=="")b.rows[a].style.height=""+f+"px";if(this.IsChildSpreadRow(g,b,a)){c.rows[a].style.height=e;return}if(e>0)if(i)if(e==d)b.rows[a].style.height=""+(parseInt(b.rows[a].style.height)+(e-f))+"px";else c.rows[a].style.height=""+(parseInt(c.rows[a].style.height)+(e-d))+"px";else if(n&&b.rows.length>=2&&b.cellSpacing=="0")if(a==0)if(e==d)b.rows[a].style.height=""+(parseInt(b.rows[a].style.height)+(e-f))+"px";else c.rows[a].style.height=""+(parseInt(c.rows[a].style.height)+(e-d))+"px";else if(g.frzRows>0&&a==g.frzRows-1&&c==this.GetFrozRowHeader(g)){d+=this.GetRowHeader(g).rows[0].offsetTop;f+=this.GetViewport(g).rows[0].offsetTop;c.rows[a].style.height=""+(parseInt(c.rows[a].style.height)+(Math.max(d,f)-d))+"px"}else{c.rows[a].style.height=""+e+"px";b.rows[a].style.height=""+e+"px"}else if(e==d)b.rows[a].style.height=""+(parseInt(b.rows[a].style.height)+(e-f))+"px";else c.rows[a].style.height=""+(parseInt(c.rows[a].style.height)+(e-d))+"px";if(m){var l=this.GetParentSpread(g);l!=null&&this.UpdateRowHeight(l,g)}};this.SizeAll=function(b){var a=this.GetChildSpreads(b);if(a!=null&&a.length>0)for(var c=0;c<a.length;c++)this.SizeAll(a[c]);this.SizeSpread(b);this.GetParentSpread(b)!=null&&this.Refresh(b)};this.SuspendLayout=function(a){a.bSuspendLayout=true};this.ResumeLayout=function(a,b){a.bSuspendLayout=false;b&&this.SizeSpread(a)};this.SizeSpread=function(a){if(a.bSuspendLayout)return;if(a.offsetHeight==0){var g=a;while(g!=null&&g!=document.body){g.displaySetting=g.style.display;g.style.display="";g=g.parentNode}}if(a.clientHeight==0||a.clientWidth==0)return;var r=this.IsXHTML(a),b=this.GetViewport(a);if(b==null)return;this.SyncMsgs(a);var c=this.GetRowHeader(a);if(c!=null){for(var j=0;j<b.rows.length&&j<c.rows.length;j++){this.SynRowHeight(a,c,b,j,false,true);this.SynRowHeight(a,c,b,j,false,true);if(j==0&&c.rows[0].cells[0]&&b.rows[0].cells[0]&&b.rows[0].cells[0].getAttribute("CellType2")=="SlideShowCellType")c.rows[0].cells[0].style.posHeight=b.rows[0].cells[0].offsetHeight-1}var n=c.rows.length-1;if(n>=0)if(typeof c.rows[n]!="undefined"&&typeof c.rows[n].cells[0]!="undefined")if(c.rows[n].style.posHeight!=null||c.rows[n].style.posHeight!="")c.rows[n].cells[0].style.posHeight=c.rows[n].style.posHeight-1}var o=this.GetColFooter(a),e=this.GetColHeader(a),k=this.GetCorner(a);if(k!=null&&e!=null&&k.getAttribute("allowTableCorner"))for(var j=0;j<k.rows.length&&j<e.rows.length;j++)if(e.rows[j].cells.length){e.rows[0].cells.length>1&&this.SynRowHeight(a,e,k,j,true,true,false);this.SynRowHeight(a,k,e,j,true,false,true)}var t=this.GetColGroup(b),C=this.GetColGroup(e);if(t!=null&&t.childNodes.length>0&&C!=null&&C.childNodes.length>0){var J=-1;if(this.sizeColumn!=null)J=parseInt(this.sizeColumn.getAttribute("index"));if(this.sizeColumn==null||J==0){var z=parseInt(t.childNodes[0].width),K=parseInt(t.childNodes[0].offsetLeft);C.childNodes[0].width=""+(z-K)+"px";t.childNodes[0].width=""+z+"px";this.SetWidthFix(e,0,z-K);this.SetWidthFix(b,0,z)}}var D=a.getAttribute("ClientAutoSize")=="True";if(D){var i=0;if(this.GetTitleBar(a)!=null)i+=this.GetTitleBar(a).offsetHeight;if(this.GetSubTitleBar(a)!=null)i+=this.GetSubTitleBar(a).offsetHeight;if(this.GetCommandBar(a)!=null)i+=this.GetCommandBar(a).offsetHeight;if(this.GetColHeader(a)!=null)i+=this.GetColHeader(a).offsetHeight;if(this.GetColFooter(a)!=null)i+=this.GetColFooter(a).offsetHeight;var v=getViewPortSize(a,D);if(!isNaN(v.height))i+=v.height;else if(this.GetViewport(a)!=null)i+=this.GetViewport(a).offsetHeight;if(this.GetPager1(a)!=null)i+=this.GetPager1(a).offsetHeight;if(this.GetPager2(a)!=null)i+=this.GetPager2(a).offsetHeight;if(this.GetHierBar(a)!=null)i+=this.GetHierBar(a).offsetHeight;if(this.GetGroupBar(a)!=null)i+=this.GetGroupBar(a).offsetHeight;a.style.height=""+i+"px";var y=0;if(this.GetRowHeader(a)!=null)y+=this.GetRowHeader(a).offsetWidth;if(!isNaN(v.width))y+=v.width;else if(this.GetViewport(a)!=null)y+=this.GetViewport(a).offsetWidth;a.style.width=""+y+"px";this.GetViewport(a).parentNode.style.overflow="hidden"}var H=this.GetParentSpread(a);H!=null&&this.UpdateRowHeight(H,a);var h=a.clientHeight,d=this.GetCommandBar(a);if(d!=null){d.style.width=""+a.clientWidth+"px";if(a.style.position!="absolute"&&a.style.position!="relative"){d.parentNode.style.borderTop="1px solid white";d.parentNode.style.backgroundColor=d.style.backgroundColor}var l=this.GetElementById(d,a.id+"_cmdTable");if(l!=null){if(a.style.position!="absolute"&&a.style.position!="relative"&&(l.style.height==""||parseInt(l.style.height)<27))l.style.height=""+(l.offsetHeight+3)+"px";if(!r&&parseInt(b.cellSpacing)>0)l.parentNode.style.height=""+(l.offsetHeight+3)+"px";h-=l.parentNode.offsetHeight}if(a.style.position!="absolute"&&a.style.position!="relative")d.style.position=""}var e=this.GetColHeader(a);if(e!=null){h-=e.offsetHeight;e.parentNode.style.height=""+(e.offsetHeight-parseInt(e.cellSpacing))+"px";if(r)h+=parseInt(e.cellSpacing)}var o=this.GetColFooter(a);if(o!=null){h-=o.offsetHeight;o.parentNode.style.height=""+o.offsetHeight+"px"}var F=this.GetHierBar(a);if(F!=null)h-=F.offsetHeight;var I=document.getElementById(a.id+"_titleBar");if(I)h-=I.parentNode.parentNode.offsetHeight;var E=this.GetGroupBar(a);if(E!=null)h-=E.offsetHeight;var w=this.GetPager1(a);if(w!=null)h-=w.offsetHeight;var G=a.getAttribute("cmdTop")=="true",f=this.GetPager2(a);if(f!=null){f.style.width=""+(a.clientWidth-10)+"px";h-=Math.max(f.offsetHeight,28)}var m=null;if(c!=null)m=c.parentNode;var q=null;if(e!=null)q=e.parentNode;var x=null;if(o!=null)x=o.parentNode;var s=this.GetFooterCorner(a);if(x!=null){x.style.height=""+o.offsetHeight-parseInt(b.cellSpacing)+"px";if(s!=null)s.parentNode.style.height=x.style.height}if(s!=null&&!r)s.width=""+(s.parentNode.offsetWidth+parseInt(b.cellSpacing))+"px";var p=b.parentNode,k=this.GetCorner(a);if(r&&q!=null){q.style.height=""+e.offsetHeight-parseInt(b.cellSpacing)+"px";if(k!=null)k.parentNode.style.height=q.style.height}if(k!=null&&!r)k.width=""+(k.parentNode.offsetWidth+parseInt(b.cellSpacing))+"px";var u=0;if(this.GetColFooter(a))u=this.GetColFooter(a).offsetHeight;if(d!=null&&!G)if(f!=null)if(a.style.position=="absolute"||a.style.position=="relative"){d.style.position="absolute";d.style.top=""+(a.clientHeight-Math.max(f.offsetHeight,28)-d.offsetHeight)+"px"}else d.style.top=""+(b.parentNode.offsetTop+u+b.parentNode.offsetHeight)+"px";else if(a.style.position=="absolute"||a.style.position=="relative"){d.style.position="absolute";d.style.top=""+(a.clientHeight-d.offsetHeight)+"px"}else if(f!=null)d.style.top=""+(this.GetOffsetTop(a,a,document.body)+a.clientHeight-Math.max(f.offsetHeight,28)-d.offsetHeight)+"px";else d.style.top=""+(this.GetOffsetTop(a,a,document.body)+a.clientHeight-d.offsetHeight+1)+"px";if(f!=null)if(a.style.position=="absolute"||a.style.position=="relative"){f.style.position="absolute";f.style.top=""+(a.clientHeight-Math.max(f.offsetHeight,28))+"px"}else if(d!=null&&!G)f.style.top=""+(b.parentNode.offsetTop+b.parentNode.offsetHeight+d.offsetHeight+u)+"px";else f.style.top=""+(b.parentNode.offsetTop+b.parentNode.offsetHeight+u)+"px";if(b){h+=parseInt(b.cellSpacing);b.parentNode.style.height=""+Math.max(h,1)+"px"}if(m!=null)m.style.height=""+Math.max(b.parentNode.offsetHeight,1)+"px";if(this.GetParentSpread(a)==null&&q!=null){var A=0;if(m!=null)A=Math.max(a.clientWidth-m.offsetWidth,1);else A=Math.max(a.clientWidth,1);q.style.width=A;q.parentNode.style.width=A}if(r){if(b!=null){b.style.posTop=-b.cellSpacing;var B=a.clientWidth;if(c!=null)B-=c.parentNode.offsetWidth;b.parentNode.style.width=""+B+"px"}if(c!=null){c.style.position="relative";c.parentNode.style.position="relative";c.style.posTop=-b.cellSpacing;c.width=""+c.parentNode.offsetWidth+"px"}}else if(b!=null){var B=a.clientWidth;if(c!=null){B-=c.parentNode.offsetWidth;c.width=""+(c.parentNode.offsetWidth+parseInt(b.cellSpacing))+"px"}b.parentNode.style.width=""+B+"px"}if(p!=null)if(m!=null){p.style.width=""+Math.max(a.clientWidth-m.offsetWidth+parseInt(b.cellSpacing),1)+"px";p.style.height=""+Math.max(h,1)+"px";p.style.width=""+Math.max(a.clientWidth-m.offsetWidth+parseInt(b.cellSpacing),1)+"px"}else{p.style.width=""+Math.max(a.clientWidth,1)+"px";p.style.height=""+Math.max(h,1)+"px";p.style.width=""+Math.max(a.clientWidth,1)+"px"}w!=null&&this.InitSlideBar(a,w);f!=null&&this.InitSlideBar(a,f);this.ScrollView(a);var L=a.getAttribute("showFocusRect")=="true";L&&(a.retainSelectionBlock||!a.retainSelectionBlock&&a.isactive)&&this.PaintFocusRect(a);var g=a;while(g!=null&&g!=document.body){if(g.displaySetting!=null){g.style.display=g.displaySetting;g.displaySetting=null}else break;g=g.parentNode}};this.InitSlideBar=function(a,b){var c=this.GetElementById(b,a.id+"_slideBar");if(c!=null){var m=this.IsXHTML(a);if(m)c.style.height=Math.max(b.offsetHeight,28)+"px";else c.style.height=b.offsetHeight-2+"px";var g=b.getElementsByTagName("TABLE");if(g!=null&&g.length>0){var j=g[0].rows[0],d=j.cells[0],e=j.cells[2];a.slideLeft=Math.max(107,d.offsetWidth+1);if(d.style.paddingRight!="")a.slideLeft+=parseInt(d.style.paddingRight);a.slideRight=b.offsetWidth-e.offsetWidth-c.offsetWidth-3;if(e.style.paddingRight!="")a.slideRight-=parseInt(e.style.paddingLeft);var n=parseInt(b.getAttribute("curPage")),f=parseInt(b.getAttribute("totalPage"))-1;if(f==0)f=1;var h=false,k=Math.max(107,a.slideLeft)+n/f*(a.slideRight-a.slideLeft);if((b.id.indexOf("pager1")>=0||b.id.indexOf("pager2")>=0)&&a.style.position!="absolute"&&a.style.position!="relative"){k+=this.GetOffsetLeft(a,b,document);var l=this.GetOffsetTop(a,d,b)+this.GetOffsetTop(a,b,document);c.style.top=l+"px";h=true}var i=document.getElementById(a.id+"_titleBar");if((b.id.indexOf("pager1")>=0||b.id.indexOf("pager2")>=0)&&!h&&i!=null){var l=i.parentNode.parentNode.offsetHeight;c.style.top=l+"px"}c.style.left=k+"px"}}};this.GetTopRowIndex=function(d){var c=this.GetViewport(d);if(c.rows.length==0)return d.frzRows-1;var a=c.parentNode.scrollTop;if(d.virtualPaging=="true"){var g=this.GetParent(c),e=document.getElementById(d.id+"_VirtualPaging_Top").style.height;e=parseInt(e);a=a-e;if(a<0)a=0}for(var f=0,b=0,b=0;b<c.rows.length;b++){f+=c.rows[b].offsetHeight;if(f>a)break}return f>a?b:b-1};this.GetLeftColIndex=function(b){for(var e=this.GetViewport(b),d=e.parentNode.scrollLeft,c=0,a=0,a=0;a<this.GetColCount(b);a++){c+=this.GetColWidthFromCol(b,a);if(c>d)break}return c>d?a:a-1};this.InitLayout=function(a){this.SizeSpread(a);this.SizeSpread(a)};this.GetRowByKey=function(c,b,a){return c.fpSpreadJS.getRowByKey(b,a)};this.GetColByKey=function(e,d,c){if(d=="-1")return-1;var g=this.GetViewport(e),a=this.GetColGroup(g);if(a==null||a.childNodes.length==0)a=this.GetColGroup(this.GetColHeader(e));if(a!=null)for(var b=0;b<a.childNodes.length;b++){var f=a.childNodes[b];if(f.getAttribute("FpCol")==d)return b}return c?c:0};this.IsRowSelected=function(f,c){var b=this.GetSelection(f);if(b!=null){var a=b.firstChild;while(a!=null){var d=parseInt(a.getAttribute("rowIndex")),e=parseInt(a.getAttribute("rowcount"));if(d<=c&&c<d+e)return true;a=a.nextSibling}}};this.InitSelection=function(a){a.anchorCell=this.findAnchorCell(a);var r=this.GetData(a),k=this.getSingleNode(r,"root"),j=this.getSingleNode(k,"state"),c=this.getSingleNode(j,"selection"),o=this.getSingleNode(j,"activerow"),n=this.getSingleNode(j,"activecolumn"),h=o!=null?parseInt(o.innerHTML):-1,g=n!=null?parseInt(n.innerHTML):-1,f=Math.max(h,0),e=Math.max(g,0);f=this.GetRowByKey(a,f);e=this.GetColByKey(a,e);a.leadingCellRow=f;a.leadingCellCol=e;if(h>-1&&g>-1){var m=r;if(this.GetParentSpread(a)!=null){var p=this.GetTopSpread(a);if(p.initialized)m=this.GetData(p);k=this.getSingleNode(m,"root")}var d=this.getSingleNode(k,"activechild");if(this.GetParentSpread(a)==null&&(d==null||d.innerHTML=="")||d!=null&&a.id==this.Trim(d.innerHTML)){var q=a.retainSelectionBlock||this.GetPageActiveSheetView()!=null&&this.GetPageActiveSheetView().id==a.id,s=this.GetCmdBtn(a,"Update"),t=this.getCmdButtonState(s),i=[];if(q)while(c.firstChild!=null){i.push(c.firstChild);c.removeChild(c.firstChild)}this.UpdateAnchorCell(a,f,e,q);for(var l=0;l<i.length;l++)c.appendChild(i[l]);var s=this.GetCmdBtn(a,"Update");!t&&this.UpdateCmdBtnState(s,true)}}var b=c.firstChild;while(b!=null){this.updateSelectionViewIndexes(a,b);b=b.nextSibling}if(!a.retainSelectionBlock)return;b=c.firstChild;while(b!=null){var h=this.GetRowByKey(a,b.getAttribute("row")),g=this.GetColByKey(a,b.getAttribute("col")),v=parseInt(b.getAttribute("rowcount")),u=parseInt(b.getAttribute("colcount"));b.setAttribute("rowIndex",h);b.setAttribute("colIndex",g);this.PaintSelection(a,h,g,v,u,true);b=b.nextSibling}this.PaintFocusRect(a)};this.TranslateKey=function(b){b=this.GetEvent(b);var c=this.GetTarget(b);try{if(document.readyState!=null&&document.readyState!="complete")return;var a=this.GetPageActiveSpread();if(a==null)return;a.preventPopUp=false;if(b.altKey&&b.keyCode==this.down&&typeof c.getAttribute("mccbparttype")!="undefined"&&c.getAttribute("mccbparttype")=="DropDownButton")return;if(typeof a.getAttribute("mcctCellType")!="undefined"&&a.getAttribute("mcctCellType")=="true")return;if(this.GetOperationMode(a)=="RowMode"&&this.GetEnableRowEditTemplate(a)=="true"&&this.IsInRowEditTemplate(a,c))return;if(a!=null){if(!this.IsChild(c,this.GetTopSpread(a)))return;this.KeyDown(a,b);var d=false;if(b.keyCode==this.tab){var e=this.GetProcessTab(a);d=e=="true"||e=="True"}d&&this.CancelDefault(b)}}catch(f){}};var rowEditTemplateContainer_keyDownEvent=null,rowEditTemplateContainer_textBoxFocusing=false;this.rowEditTemplateContainer_textBoxFocus=function(){if(rowEditTemplateContainer_keyDownEvent&&rowEditTemplateContainer_keyDownEvent.keyCode==rowEditTemplateContainer_keyDownEvent.DOM_VK_TAB){rowEditTemplateContainer_textBoxFocusing=true;rowEditTemplateContainer_keyDownEvent.sourceElement.dispatchEvent(rowEditTemplateContainer_keyDownEvent)}};this.rowEditTemplateContainer_keyDown=function(a){if(a.keyCode==a.DOM_VK_TAB)if(!rowEditTemplateContainer_textBoxFocusing){var b=document.createEvent("KeyboardEvent");b.initKeyEvent(a.type,a.bubbles,a.cancelable,a.view,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.keyCode,a.charCode);b.sourceElement=a.target;rowEditTemplateContainer_keyDownEvent=b}else{rowEditTemplateContainer_textBoxFocusing=false;var c=this.GetPageActiveSpread();this.KeyDown(c,a)}else rowEditTemplateContainer_keyDownEvent=null;if(a.preventDefault==null){a.cancelBubble=true;a.returnValue=true}return true};this.IsInRowEditTemplate=function(b,a){while(a&&a.parentNode){a=a.parentNode;if(a.tagName=="DIV"&&a.id==b.id+"_RowEditTemplateContainer")return true}return false};this.KeyAction=function(e,c,b,d,a){this.key=e;this.ctrl=c;this.shift=b;this.alt=d;this.action=a};this.RemoveKeyMap=function(a,f,h,g,i){if(a.keyMap==null)a.keyMap=[];for(var e=a.keyMap.length,c=0;c<e;c++){var b=a.keyMap[c];if(b!=null&&b.key==f&&b.ctrl==h&&b.shift==g&&b.alt==i){for(var d=c+1;d<e;d++)a.keyMap[d-1]=a.keyMap[d];a.keyMap.length=a.keyMap.length-1;break}}};this.AddKeyMap=function(a,b,e,d,f,c){if(a.keyMap==null)a.keyMap=[];var g=this.GetKeyAction(a,b,e,d,f);if(g!=null)g.action=c;else{var h=a.keyMap.length;a.keyMap.length=h+1;a.keyMap[h]=new this.KeyAction(b,e,d,f,c)}};this.GetKeyAction=function(b,d,f,e,g){if(b.keyMap==null)b.keyMap=[];for(var h=b.keyMap.length,c=0;c<h;c++){var a=b.keyMap[c];if(a!=null&&a.key==d&&a.ctrl==f&&a.shift==e&&a.alt==g)return a}return null};this.MoveToPrevCell=function(a){var b=this.EndEdit(a);if(!b)return;this.doIgnoreVirtualPaging(a);var d=a.GetActiveRow(),c=a.GetActiveCol();this.MoveLeft(a,d,c)};this.MoveToNextCell=function(a){var e=this.EndEdit(a);if(!e)return;this.doIgnoreVirtualPaging(a);var d=a.anchorCell,c=a.leadingCellRow,b=a.leadingCellCol;if(this.GetCellFromRowCol(a,c,b)!=a.anchorCell){c=this.GetRowFromCell(a,a.anchorCell);b=this.GetColFromCell(a,a.anchorCell)}this.MoveRight(a,c,b);d!=a.anchorCell&&this.FireActiveCellChangedEvent(a,a.leadingCellRow,a.leadingCellCol)};this.MoveToNextRow=function(b,h){var g=this.EndEdit(b);if(!g)return;this.doIgnoreVirtualPaging(b);var f=b.GetActiveRow(),e=b.GetActiveCol();this.MoveDown(b,f,e,h);f!=b.leadingCellRow&&this.FireActiveCellChangedEvent(b,b.leadingCellRow,e);var c=this.GetParent(this.GetViewport(b)),a=this.GetCellFromRowCol(b,b.leadingCellRow,b.leadingCellCol);if(a.cellIndex==0)c.scrollLeft=0;if(a.parentNode.rowIndex==1&&b.virtualTop==0)c.scrollTop=0;var d=this.GetParent(this.GetViewport(b));c=this.GetParent(this.GetViewport(b));if(this.IsChild(a,c)&&a.offsetTop+a.offsetHeight>c.scrollTop+c.clientHeight-b.virtualTop)d.scrollTop+=a.offsetHeight;if(a!=null&&a.offsetWidth<c.clientWidth)if(this.IsChild(a,c)&&a.offsetLeft+a.offsetWidth>c.scrollLeft+c.clientWidth)d.scrollLeft=a.offsetLeft+a.offsetWidth-c.clientWidth;if(this.IsChild(a,c)&&a.offsetTop+a.offsetHeight>c.scrollTop+c.clientHeight&&a.offsetHeight<c.clientHeight-b.virtualTop)d.scrollTop=a.offsetTop+a.offsetHeight-c.clientHeight;if(a.offsetTop<c.scrollTop-b.virtualTop)d.scrollTop=a.offsetTop==0?b.virtualTop:a.offsetTop};this.MoveToPrevRow=function(b,h){var g=this.EndEdit(b);if(!g)return;this.doIgnoreVirtualPaging(b);var e=b.GetActiveRow(),f=b.GetActiveCol();if(e>=0){this.MoveUp(b,e,f,h);e!=b.leadingCellRow&&this.FireActiveCellChangedEvent(b,b.leadingCellRow,f);var c=this.GetParent(this.GetViewport(b)),a=this.GetCellFromRowCol(b,b.leadingCellRow,b.leadingCellCol);if(a.cellIndex==0)c.scrollLeft=0;if(a.parentNode.offsetTop<c.scrollTop)if(a.parentNode.rowIndex>1)c.scrollTop=a.parentNode.offsetTop>b.virtualTop?a.parentNode.offsetTop:b.virtualTop;else c.scrollTop=b.virtualTop;else if(a.parentNode.rowIndex==1&&b.virtualTop==0)c.scrollTop=0;var d=this.GetParent(this.GetViewport(b));c=this.GetParent(this.GetViewport(b));if(a!=null&&a.offsetWidth<c.clientWidth)if(this.IsChild(a,c)&&a.offsetLeft+a.offsetWidth>c.scrollLeft+c.clientWidth)d.scrollLeft=a.offsetLeft+a.offsetWidth-c.clientWidth;if(this.IsChild(a,c)&&a.offsetTop+a.offsetHeight>c.scrollTop+c.clientHeight&&a.offsetHeight<c.clientHeight-b.virtualTop)d.scrollTop=a.offsetTop+a.offsetHeight-c.clientHeight;if(a.offsetTop<c.scrollTop-b.virtualTop)d.scrollTop=a.offsetTop==0?b.virtualTop:a.offsetTop}};this.MoveToFirstColumn=function(a){var c=this.EndEdit(a);if(!c)return;var b=a.GetActiveRow();if(a.anchorCell.parentNode.rowIndex>=0){this.UpdateLeadingCell(a,b,0);this.FireActiveCellChangedEvent(a,b,0)}};this.MoveToLastColumn=function(a){var d=this.EndEdit(a);if(!d)return;var b=a.GetActiveRow();if(a.anchorCell.parentNode.rowIndex>=0){c=this.GetColCount(a)-1;this.UpdateLeadingCell(a,b,c);this.FireActiveCellChangedEvent(a,b,c)}};this.UpdatePostbackData=function(a){this.SaveData(a)};this.PrepareData=function(a){var b="";if(a!=null)if(a.nodeName=="#text")b=a.nodeValue;else{b=this.GetBeginData(a);var c=a.firstChild;while(c!=null){var d=this.PrepareData(c);if(d!="")b+=d;c=c.nextSibling}b+=this.GetEndData(a)}return b};this.GetBeginData=function(b){var c="<"+b.nodeName.toLowerCase();if(b.attributes!=null)for(var d=0;d<b.attributes.length;d++){var a=b.attributes[d];if(a.nodeName!=null&&a.nodeName!=""&&a.nodeName!="style"&&a.nodeValue!=null&&a.nodeValue!="")c+=" "+a.nodeName+'="'+a.nodeValue+'"'}c+=">";return c};this.GetEndData=function(a){return"</"+a.nodeName.toLowerCase()+">"};this.SaveData=function(a){if(a==null)return;try{var b=this.GetData(a),c=b.getElementsByTagName("root")[0],e=this.PrepareData(c),d=document.getElementById(a.id+"_data");d.value=encodeURIComponent(e)}catch(f){alert("e "+f)}};this.SetActiveSpread=function(f){try{f=this.GetEvent(f);var c=this.GetTarget(f);if(this.editing&&c!=null&&c.tagName=="HTML")return;if(this.isExtenderPopupControl(c))return;var b=this.GetSpread(c,false),a=this.GetPageActiveSpread();if(this.editing&&(b==null||b!=a&&b.getAttribute("mcctCellType")!="true"&&a.getAttribute("mcctCellType")!="true")){if(c!=this.editor&&this.editor!=null)this.editor.blur!=null&&this.editor.blur();var h=this.EndEdit();if(!h)return}var e=false;if(b==null){b=this.GetSpread(c,true);e=b!=null}if(b!=null&&(e||c==this.GetTopSpread(b).viewport.parentNode)){var g=this.getLastActiveSpread(b);if(g!=null)b=g}var i=this.GetCell(c,true);if(i==null&&a!=null&&a.dirty){this.SaveData(a);a.dirty=false}if(a!=null&&a.dirty&&(b!=a||b==null||e)){this.SaveData(a);a.dirty=false}if(a!=null&&a.dirty&&b==a&&c.tagName=="INPUT"&&(c.type=="submit"||c.type=="button"||c.type=="image")){this.SaveData(a);a.dirty=false}if(b!=null&&this.GetOperationMode(b)=="ReadOnly")return;var d=null;if(b==null){if(a==null)return;d=this.GetTopSpread(a);this.SetActiveSpreadID(d,"",null,false);this.SetPageActiveSpread(null)}else if(b!=a){if(a!=null){d=this.GetTopSpread(a);this.SetActiveSpreadID(d,"",null,false)}if(e){d=this.GetTopSpread(b);var j=this.GetTopSpread(a);if(d!=j){this.SetActiveSpreadID(d,b.id,b.id,true);this.SetPageActiveSpread(b)}else{this.SetActiveSpreadID(d,a.id,a.id,true);this.SetPageActiveSpread(a)}}else{d=this.GetTopSpread(b);this.SetPageActiveSpread(b);this.SetActiveSpreadID(d,b.id,b.id,false)}}}catch(k){}};this.isExtenderPopupControl=function(a){return a.id.indexOf("CalendarExtender")!=-1||a.id.indexOf("FpComboBox")!=-1};this.SetActiveSpreadID=function(c,h,d,f){var g=this.GetData(c),e=g.getElementsByTagName("root")[0],b=e.getElementsByTagName("activespread")[0],a=e.getElementsByTagName("activechild")[0];if(b==null)return;if(f&&a!=null&&a.nodeValue!="")b.innerHTML=a.innerHTML;else{b.innerHTML=h;if(d!=null&&a!=null)a.innerHTML=d}this.SaveData(c);c.dirty=false};this.GetSpread=function(d,e){var a=d;while(a!=null&&a.tagName!="BODY"){if(typeof a.getAttribute!="function")break;var c=a.getAttribute("FpSpread");if(c==null)c=a.FpSpread;if(c=="Spread"){if(!e){var b=d;while(b!=null&&b!=a){if(b.id==a.id+"_commandBar"||b.id==a.id+"_pager1"||b.id==a.id+"_pager2")return null;b=b.parentNode}}return a}a=a.parentNode}return null};this.DoVirtualPaging=function(a){a=this;var e=the_fpSpread.GetViewport(a),d=the_fpSpread.GetParent(e);if(e==null||d==null)return;var b=d.scrollTop;if(a.virtualPagingCurrentScroll!=null&&b==a.virtualPagingCurrentScroll){var g=the_fpSpread.GetCurrentPageIndex(a),c=the_fpSpread.canMoveToPage(a);if(c.canMove){var f=Math.abs(c.scrollValue-b);the_fpSpread.ScrollToPage(a,f,a.isScrollUp,true)}a.virtualPagingProcessing=false}else{a.virtualPagingCurrentScroll=b;setTimeout(Function.CreateDelegate(a,the_fpSpread.DoVirtualPaging),500)}};this.canMoveToPage=function(a){var g=this.GetViewport(a),d=this.GetParent(g);if(g==null||d==null)return false;var f=d.scrollTop,b=getViewPortSize(a,false),e=this.GetCurrentPageIndex(a),h=this.GetPageCount(a),c={canMove:false,scrollValue:-1};if(a.isScrollUp&&f<b.top&&e!=0){c.canMove=true;c.scrollValue=b.top}else if(!a.isScrollUp&&b.height+b.top-f<d.offsetHeight&&e!=h-1){c.canMove=true;var i=b.height>d.offsetHeight?b.height-d.offsetHeight:0;c.scrollValue=a.virtualTop+i}return c};this.ScrollViewport=function(b){var c=this.GetTarget(b),a=this.GetTopSpread(c);a!=null&&this.ScrollView(a)};this.GetActiveChildSheetView=function(d){var a=this.GetPageActiveSheetView();if(typeof a=="undefined")return null;var c=this.GetTopSpread(d),b=this.GetTopSpread(a);return b!=c?null:a==b?null:a};this.ScrollTo=function(c,e,d){var a=this.GetCellByRowCol(c,e,d);if(a==null)return;var b=this.GetViewport(c).parentNode;if(b==null)return;b.scrollTop=a.offsetTop;b.scrollLeft=a.offsetLeft};this.ScrollView=function(a){var c=this.GetTopSpread(a),h=this.GetParent(this.GetRowHeader(c)),g=this.GetParent(this.GetColHeader(c)),f=this.GetParent(this.GetColFooter(c)),b=this.GetParent(this.GetViewport(c));if(b==null)return;if(a.scrollTopInner==b.scrollTop&&a.scrollLeftInner==b.scrollLeft)return;var i=a.scrollTopInner!=b.scrollTop,d=a.scrollLeftInner!=b.scrollLeft;if(h!=null)h.scrollTop=b.scrollTop;if(g!=null)g.scrollLeft=b.scrollLeft;if(f!=null)f.scrollLeft=b.scrollLeft;var j=b.scrollTop;this.GetParentSpread(a)==null&&this.SaveScrollbarState(a,b.scrollTop,b.scrollLeft);if(i||d){var e=this.CreateEvent("Scroll");e.vertical=i;e.horizontal=d;this.FireEvent(a,e);(a.frzRows!=0||a.frzCols!=0)&&this.SyncMsgs(a)}var k=a.scrollTopInner!=null&&a.scrollTopInner>j;a.scrollLeftInner=b.scrollLeft;a.scrollTopInner=b.scrollTop;if(a.getAttribute("AllRowsLoaded")==null&&b.scrollTop>0&&b.scrollTop+b.offsetHeight>=this.GetViewport(c).offsetHeight)if(!this.editing&&a.getAttribute("loadOnDemand")=="true"){if(a.LoadState!=null)return;a.LoadState=true;this.SaveData(a);a.CallBack("LoadOnDemand",true)}var l=this.GetViewport(c);if(a.virtualPaging=="true"&&!a.ignoreVirtualPaging&&!d&&!a.virtualPagingProcessing&&a.getAttribute("loadOnDemand")!="true"&&this.IsChild(l,b)){a.isScrollUp=k;if(!a.FromProcessData&&this.canMoveToPage(a).canMove){a.virtualPagingProcessing=true;setTimeout(Function.CreateDelegate(a,the_fpSpread.DoVirtualPaging),0)}}};this.LoadData=function(a,b){if(a.initialized&&!this.editing&&a.getAttribute("loadOnDemand")=="true"){if(a.LoadState!=null)return;a.LoadState=true;this.SaveData(a);a.CallBack("LoadOnDemand",b)}};this.SaveScrollbarState=function(b,d,e){if(this.GetParentSpread(b)!=null)return;var g=this.GetData(b),f=g.getElementsByTagName("root")[0],a=f.getElementsByTagName("scrollTop")[0],c=f.getElementsByTagName("scrollLeft")[0];if(b.getAttribute("scrollContent")=="true")if(a!=null&&c!=null)(a.innerHTML!=d||c.innerHTML!=e)&&this.ShowScrollingContent(b,a.innerHTML==d);if(a!=null)a.innerHTML=d;if(c!=null)c.innerHTML=e;b.dirty=true};this.LoadScrollbarState=function(a){if(this.GetParentSpread(a)!=null)return;if(a.getAttribute("ClientAutoSize")=="True")return;var o=this.GetData(a),n=o.getElementsByTagName("root")[0],i=n.getElementsByTagName("scrollTop")[0],h=n.getElementsByTagName("scrollLeft")[0],c=0;if(i!=null&&i.innerHTML!="")c=parseInt(i.innerHTML);else c=0;var d=0;if(h!=null&&h.innerHTML!="")d=parseInt(h.innerHTML);else d=0;a.virtualPagingProcessing=false;c=c>0&&c>=a.virtualTop?c:c+a.virtualTop;a.virtualPaging=a.getAttribute("virtualPaging");a.isScrollUp=false;if(a.virtualPaging=="true"){var b=this.GetViewport(a);if(b!=null&&b.isBuild==null){var e=document.getElementById(a.id+"_VirtualPaging_Bottom"),j=parseInt(e.style.height),f=b.parentNode.clientHeight-b.offsetHeight;if(f>0)e.style.height=f+j+"px";b.isBuild=true}var g=null;if(g!=null){var e=document.getElementById(a.id+"_VirtualPaging_Bottom2"),j=parseInt(e.style.height),f=g.parentNode.clientHeight-g.offsetHeight;if(f>0)e.style.height=f+j+"px";g.isBuild=true}}var b=this.GetParent(this.GetViewport(a));if(b!=null){if(!isNaN(c))b.scrollTop=c;if(!isNaN(d))b.scrollLeft=d;var m=this.GetParent(this.GetRowHeader(a)),l=this.GetParent(this.GetColHeader(a)),k=this.GetParent(this.GetColFooter(a));if(k!=null)k.scrollLeft=b.scrollLeft;if(m!=null)m.scrollTop=b.scrollTop;if(l!=null)l.scrollLeft=b.scrollLeft}};this.GetParent=function(a){return a==null?null:a.parentNode};this.GetViewport=function(a){return a.viewport};this.GetCommandBar=function(a){return a.commandBar};this.GetRowHeader=function(a){return a.rowHeader};this.GetColHeader=function(a){return a.colHeader};this.GetColFooter=function(a){return a.colFooter};this.GetFooterCorner=function(a){return a.footerCorner};this.GetCmdBtn=function(d,c){var a=this.GetTopSpread(d),b=this.GetCommandBar(a);return b!=null?this.GetElementById(b,a.id+"_"+c):null};this.Range=function(){this.type="Cell";this.row=-1;this.col=-1;this.rowCount=0;this.colCount=0};this.SetRange=function(a,b,d,c,f,e){a.type=b;a.row=d;a.col=c;a.rowCount=f;a.colCount=e;if(b=="Row")a.col=a.colCount=-1;else if(b=="Column")a.row=a.rowCount=-1;else if(b=="Table"){a.col=a.colCount=-1;a.row=a.rowCount=-1}};this.Margin=function(){this.left;this.top;this.right;this.bottom};this.GetRender=function(b){var a=b;if(a.firstChild!=null&&a.firstChild.tagName!=null&&a.firstChild.tagName!="BR")return a.firstChild;if(a.firstChild!=null&&a.firstChild.value!=null)a=a.firstChild;return a};this.GetPreferredRowHeight=function(c,d){var b=this.CreateTestBox(c);d=this.GetDisplayIndex(c,d);for(var e=this.GetViewport(c),f=0,h=e.rows[d].offsetHeight,n=e.rows[d].cells.length,j=0;j<n;j++){var g=e.rows[d].cells[j],a=this.GetRender(g);if(a!=null){b.style.fontFamily=a.style.fontFamily;b.style.fontSize=a.style.fontSize;b.style.fontWeight=a.style.fontWeight;b.style.fontStyle=a.style.fontStyle}var m=this.GetColFromCell(c,g);b.style.posWidth=this.GetColWidthFromCol(c,m);if(a!=null&&a.tagName=="SELECT"){for(var l="",k=0;k<a.childNodes.length;k++){var i=a.childNodes[k];if(i.text!=null&&i.text.length>l.length)l=i.text}b.innerHTML=l}else if(a!=null&&a.tagName=="INPUT")b.innerHTML=a.value;else b.innerHTML=g.innerHTML;h=b.offsetHeight;if(h>f)f=h}return Math.max(0,f)+3};this.SetRowHeight2=function(b,d,c){if(c<1)c=1;d=this.GetDisplayIndex(b,d);var a=null;if(this.GetRowHeader(b)!=null)a=this.GetRowHeader(b).rows[d];if(a!=null){a.style.posHeight=c;a.cells[0].style.posHeight=c}var e=this.GetViewport(b);if(a!=null)e.rows[a.rowIndex].cells[0].style.posHeight=a.style.posHeight;else if(e!=null){e.rows[d].cells[0].style.posHeight=c;a=e.rows[d]}var f=this.AddRowInfo(b,a.FpKey);f!=null&&this.SetRowHeight(b,f,a.style.posHeight);var g=this.GetParentSpread(b);g!=null&&g.UpdateRowHeight(b);this.SizeSpread(b)};this.GetRowHeightInternal=function(b,c){var a=null;if(this.GetRowHeader(b)!=null)a=this.GetRowHeader(b).rows[c];else if(this.GetViewport(b)!=null)a=this.GetViewport(b).rows[c];return a!=null?a.offsetHeight:0};this.GetCell=function(c,b){var a=c;while(a!=null){if(b){if((a.tagName=="TD"||a.tagName=="TH")&&a.parentNode.getAttribute("FpSpread")=="r")return a}else if((a.tagName=="TD"||a.tagName=="TH")&&(a.parentNode.getAttribute("FpSpread")=="r"||a.parentNode.getAttribute("FpSpread")=="ch"||a.parentNode.getAttribute("FpSpread")=="rh"))return a;a=a.parentNode}return null};this.InRowHeader=function(b,a){return this.IsChild(a,this.GetRowHeader(b))};this.InColHeader=function(b,a){return this.IsChild(a,this.GetColHeader(b))};this.InColFooter=function(b,a){return this.IsChild(a,this.GetColFooter(b))};this.IsHeaderCell=function(b,a){return a!=null&&(a.tagName=="TD"||a.tagName=="TH")&&(a.parentNode.getAttribute("FpSpread")=="ch"||a.parentNode.getAttribute("FpSpread")=="rh")};this.GetSizeColumn=function(a,n,g){if(n.tagName!="TD"||this.GetColHeader(a)==null)return null;var b=-1,c=n,k=this.GetViewport(this.GetTopSpread(a)).parentNode.scrollLeft+window.scrollX;while(c!=null&&c.parentNode!=null&&c.parentNode!=document.documentElement){if(c.parentNode.getAttribute("FpSpread")=="ch"){var h=this.GetOffsetLeft(a,c),p=h+c.offsetWidth;if(g.clientX+k<h+3)b=this.GetColFromCell(a,c)-1;else if(g.clientX+k>p-4){b=this.GetColFromCell(a,c);var e=this.GetSpanCell(c.parentNode.rowIndex,b,a.colSpanCells);if(e!=null)b=e.col+e.colCount-1}else{b=this.GetColFromCell(a,c);var e=this.GetSpanCell(c.parentNode.rowIndex,b,a.colSpanCells);if(e!=null){var i=h;b=-1;for(var f=e.col;f<e.col+e.colCount&&f<this.GetColCount(a);f++){if(this.IsChild(c,this.GetColHeader(a)))i+=parseInt(this.GetElementById(this.GetColHeader(a),a.id+"col"+f).width);if(g.clientX>i-3&&g.clientX<i+3){b=f;break}}}else b=-1}if(isNaN(b)||b<0)return null;var m=0,l=this.GetColCount(a),j=true,q=null,d=b+1;while(d<l){var o=this.GetColGroup(this.GetColHeader(a));if(d<o.childNodes.length)m=parseInt(o.childNodes[d].width);if(m>1){j=false;break}d++}if(j){d=b+1;while(d<l){if(this.GetSizable(a,d)){b=d;break}d++}}if(!this.GetSizable(a,b))return null;if(this.IsChild(c,this.GetColHeader(a)))return this.GetElementById(this.GetColHeader(a),a.id+"col"+b)}c=c.parentNode}return null};this.GetColGroup=function(d){if(d==null)return null;var a=d.getElementsByTagName("COLGROUP");if(a!=null&&a.length>0){if(d.colgroup!=null)return d.colgroup;var b={};b.childNodes=[];for(var c=0;c<a[0].childNodes.length;c++)if(a[0].childNodes[c]!=null&&a[0].childNodes[c].tagName=="COL"){var e=b.childNodes.length;b.childNodes.length++;b.childNodes[e]=a[0].childNodes[c]}d.colgroup=b;return b}else return null};this.GetSizeRow=function(b,g,f){var m=this.GetRowCount(b);if(m==0)return null;var k=this.GetCell(g);if(k==null){if(g.getAttribute("FpSpread")=="rowpadding")if(f.clientY<3){var a=g.parentNode.rowIndex;if(a>1){var q=g.parentNode.parentNode.rows[a-1];if(this.GetSizable(b,q))return q}}var p=this.GetCorner(b);if(p!=null&&this.IsChild(g,p))if(f.clientY>g.offsetHeight-4){var c=null,a=0;c=this.GetRowHeader(b);if(c!=null){while(a<c.rows.length&&c.rows[a].offsetHeight<2&&!this.GetSizable(b,c.rows[a]))a++;if(a<c.rows.length&&this.GetSizable(b,c.rows[a])&&c.rows[a].offsetHeight<2)return c.rows[a]}}return null}var r=b.rowSpanCells,t=b.spanCells,d=k,o=this.GetViewport(this.GetTopSpread(b)).parentNode.scrollTop+window.scrollY;while(d!=null&&d!=document.documentElement){if(d.getAttribute("FpSpread")=="rh"){var a=-1,l=this.GetOffsetTop(b,d),s=l+d.offsetHeight;if(f.clientY+o<l+3){if(d.rowIndex>1)a=d.rowIndex-1}else if(f.clientY+o>s-4){var j=this.GetSpanCell(this.GetRowFromCell(b,k),this.GetColFromCell(b,k),r);if(j!=null)for(var h=l,i=j.row;i<j.row+j.rowCount;i++){if(this.GetRowHeader(b).rows[i].cells.length>0)h+=parseInt(this.GetRowHeader(b).rows[i].cells[0].style.height);if(f.clientY>h-3&&f.clientY<h+3){a=i;break}}else if(d.rowIndex>=0)a=d.rowIndex}else break;var h=0,m=this.GetRowHeader(b).rows.length,n=true,c=null;c=this.GetRowHeader(b);var e=a+1;while(e<m){if(c.rows[e].style.height!=null)h=parseInt(c.rows[e].style.height);else h=parseInt(c.rows[e].offsetHeight);if(h>1){n=false;break}e++}if(n){e=a+1;while(e<m){if(this.GetSizable(b,this.GetRowHeader(b).rows[e])){a=e;break}e++}}if(a>=0&&this.GetSizable(b,c.rows[a]))return c.rows[a];else if(f.clientY<3){while(a>0&&c.rows[a].offsetHeight==0&&!this.GetSizable(b,c.rows[a]))a--;return a>=0&&this.GetSizable(b,c.rows[a])?c.rows[a]:null}}d=d.parentNode}return null};this.GetElementById=function(c,b){if(c==null)return null;var a=c.firstChild;while(a!=null){if(a.id==b||typeof a.getAttribute=="function"&&a.getAttribute("name")==b)return a;var d=this.GetElementById(a,b);if(d!=null)return d;a=a.nextSibling}return null};this.GetSizable=function(c,a){if(typeof a=="number"){var b=this.GetElementById(this.GetColHeader(c),c.id+"col"+a);return b!=null&&(b.getAttribute("Sizable")==null||b.getAttribute("Sizable")=="True")}return a!=null&&(a.getAttribute("Sizable")==null||a.getAttribute("Sizable")=="True")};this.GetSpanWidth=function(g,b,f){var e=0,d=this.GetViewport(g);if(d!=null){var c=this.GetColGroup(d);if(c!=null)for(var a=b;a<b+f;a++)e+=parseInt(c.childNodes[a].width)}return e};this.GetCellType=function(a){if(a!=null&&a.getAttribute("FpCellType")!=null)return a.getAttribute("FpCellType");if(a!=null&&a.getAttribute("FpRef")!=null){var b=document.getElementById(a.getAttribute("FpRef"));return b.getAttribute("FpCellType")}return a!=null&&a.getAttribute("FpCellType")!=null?a.getAttribute("FpCellType"):"text"};this.GetCellType2=function(a){if(a!=null&&a.getAttribute("FpRef")!=null)a=document.getElementById(a.getAttribute("FpRef"));var b=null;if(a!=null){b=a.getAttribute("FpCellType");if(b=="readonly")b=a.getAttribute("CellType");if(b==null)b=a.getAttribute("CellType2")}return b!=null?b:"text"};this.GetCellEditorID=function(b,a){if(a!=null&&a.getAttribute("FpRef")!=null){var c=document.getElementById(a.getAttribute("FpRef"));return c.getAttribute("FpEditorID")}return a.getAttribute("FpEditorID")!=null?a.getAttribute("FpEditorID"):b.getAttribute("FpDefaultEditorID")};this.EditorMap=function(a,b){this.id=a;this.editor=b};this.ValidatorMap=function(a,b){this.id=a;this.validator=b};this.GetCellEditor=function(f,b,e){for(var a=null,c=0;c<this.editorList.length;c++){var d=this.editorList[c];if(d.id==b){a=d.editor;break}}if(a==null){a=document.getElementById(b);this.editorList[this.editorList.length]=new this.EditorMap(b,a)}return e?a:a.cloneNode(true)};this.GetCellValidatorID=function(){return null};this.GetCellValidator=function(){return null};this.GetTableRow=function(d,e){var c=this.GetData(d).getElementsByTagName("root")[0],b=c.getElementsByTagName("data")[0],a=b.firstChild;while(a!=null){if(a.getAttribute("key")==""+e)return a;a=a.nextSibling}return null};this.GetTableCell=function(b,c){if(b==null)return null;var a=b.firstChild;while(a!=null){if(a.getAttribute("key")==""+c)return a;a=a.nextSibling}return null};this.AddTableRow=function(b,c){if(c==null)return null;var a=this.GetTableRow(b,c);if(a!=null)return a;var e=this.GetData(b).getElementsByTagName("root")[0],d=e.getElementsByTagName("data")[0];if(document.all!=null)a=this.GetData(b).createNode("element","row","");else{a=document.createElement("row");a.style.display="none"}a.setAttribute("key",c);d.appendChild(a);return a};this.AddTableCell=function(b,c){if(b==null)return null;var a=this.GetTableCell(b,c);if(a!=null)return a;if(document.all!=null)a=this.GetData(ss).createNode("element","cell","");else{a=document.createElement("cell");a.style.display="none"}a.setAttribute("key",c);b.appendChild(a);return a};this.GetCellValue=function(b,a){if(a==null)return null;var e=this.GetRowKeyFromCell(b,a),d=this.GetColKeyFromCell(b,a),c=this.AddTableCell(this.AddTableRow(b,e),d);return c.innerHTML};this.SetCellValue=function(b,a,d,l,m){if(a==null)return;if(d==" ")a.setAttribute("whiteSpace","1");else a.removeAttribute("whiteSpace");a.getAttribute("specialValue")!=null&&a.removeAttribute("specialValue");if(d!=null&&d==""){var i=this.GetCellEditorID(b,a);if(i!=null){var h=this.GetCellEditor(b,i,true);h!=null&&h.tagName=="SELECT"&&a.setAttribute("specialValue","1")}}var k=this.GetCellType(a);if(k=="readonly"&&a.getAttribute("CellType2")!="MutuallyExclusiveCheckBoxCellType")return;var g=this.GetRowKeyFromCell(b,a),f=this.GetColKeyFromCell(b,a);if(g==null||f==null)return;var j=this.AddTableCell(this.AddTableRow(b,g),f);d=$$.utils.htmlEncode(d);j.innerHTML=d;if(!l){var e=this.CreateEvent("DataChanged");e.cell=a;e.cellValue=d;e.row=g;e.col=f;this.FireEvent(b,e)}var c=this.GetCmdBtn(b,"Update");c!=null&&c.getAttribute("disabled")!=null&&this.UpdateCmdBtnState(c,false);c=this.GetCmdBtn(b,"Cancel");c!=null&&c.getAttribute("disabled")!=null&&this.UpdateCmdBtnState(c,false);b.dirty=true;m&&this.UpdateValues(b)};this.GetSelectedRanges=function(d){var f=this.GetSelection(d),b=[],a=f.firstChild;while(a!=null){var c=new this.Range;this.GetRangeFromNode(d,a,c);var e=b.length;b.length=e+1;b[e]=c;a=a.nextSibling}return b};this.GetSelectedRange=function(c){var b=new this.Range,d=this.GetSelection(c),a=d.lastChild;a!=null&&this.GetRangeFromNode(c,a,b);return b};this.GetRangeFromNode=function(b,a,h){if(a==null||b==null||h==null)return;h.anchor=a.getAttribute("anchor")!=null;var e=this.GetRowByKey(b,a.getAttribute("row")),f=this.GetColByKey(b,a.getAttribute("col")),c=parseInt(a.getAttribute("rowcount")),g=parseInt(a.getAttribute("colcount")),j=this.GetViewport(b);if(j!=null)for(var k=this.GetDisplayIndex(b,e),i=k;i<k+c;i++)if(this.IsChildSpreadRow(b,j,i))c--;var d=null;if(e<0&&f<0&&c!=0&&g!=0)d="Table";else if(e<0&&f>=0&&g>0)d="Column";else if(f<0&&e>=0&&c>0)d="Row";else d="Cell";this.SetRange(h,d,e,f,c,g)};this.GetSelection=function(d){var a=this.GetData(d),b=a.getElementsByTagName("root")[0],e=b.getElementsByTagName("state")[0],c=e.getElementsByTagName("selection")[0];return c};this.GetRowKeyFromRow=function(c,b){if(b<0)return null;var a=null;a=this.GetViewport(c);return a.rows[b]==null?-1:a.rows[b].getAttribute("FpKey")};this.GetColKeyFromCol=function(c,b){if(b<0)return null;var d=this.GetViewport(c),a=this.GetColGroup(d);if(a==null||a.childNodes.length==0)a=this.GetColGroup(this.GetColHeader(c));return a!=null&&b>=0&&b<a.childNodes.length?a.childNodes[b].getAttribute("FpCol"):null};this.GetRowKeyFromCell=function(c,a){return a.parentNode.getAttribute("FpKey")};this.GetColKeyFromCell=function(c,d){var a=this.GetColFromCell(c,d),e=this.GetViewport(c),b=this.GetColGroup(e);return b!=null&&a>=0&&a<b.childNodes.length?b.childNodes[a].getAttribute("FpCol"):null};this.SetSelection=function(b,c,d,i,g,e){var j=c,h=d;if(c!=null&&parseInt(c)>=0){c=this.GetRowKeyFromRow(b,c);if(c!="newRow")c=parseInt(c)}if(d!=null&&parseInt(d)>=0)d=parseInt(this.GetColKeyFromCol(b,d));var f=this.GetSelection(b);if(f==null)return;if(e==null)e=b.getAttribute("multiRange")=="true"&&!this.working;var a=f.lastChild;if(a==null||e){if(document.all!=null)a=this.GetData(b).createNode("element","range","");else{a=document.createElement("range");a.style.display="none"}f.appendChild(a)}a.setAttribute("row",c);a.setAttribute("col",d);a.setAttribute("rowcount",i);a.setAttribute("colcount",g);a.setAttribute("rowIndex",j);a.setAttribute("colIndex",h);b.dirty=true;this.inactiveAllChart(b);this.PaintFocusRect(b);var k=this.GetCmdBtn(b,"Update");this.UpdateCmdBtnState(k,false);var l=this.CreateEvent("SelectionChanged");this.FireEvent(b,l)};this.CreateSelectionNode=function(h,g,f,d,b,e,c){var a=document.createElement("range");a.style.display="none";a.setAttribute("row",g);a.setAttribute("col",f);a.setAttribute("rowcount",d);a.setAttribute("colcount",b);a.setAttribute("rowIndex",e);a.setAttribute("colIndex",c);return a};this.AddRowToSelection=function(b,e,a){var c=a;if(typeof a!="undefined"&&parseInt(a)>=0){a=this.GetRowKeyFromRow(b,a);if(a!="newRow")a=parseInt(a)}if(!this.IsRowSelected(b,a)&&!isNaN(a)){var d=this.CreateSelectionNode(b,a,-1,1,-1,c,-1);e.appendChild(d)}};this.RemoveSelection=function(b,f){var c=this.GetSelection(b);if(c==null)return;var a=c.firstChild;while(a!=null){var e=parseInt(a.getAttribute("rowIndex")),g=parseInt(a.getAttribute("rowcount"));if(e<=f&&f<e+g){c.removeChild(a);for(var d=e;d<e+g;d++)d!=f&&this.AddRowToSelection(b,c,d);break}a=a.nextSibling}b.dirty=true;var h=this.GetCmdBtn(b,"Update");this.UpdateCmdBtnState(h,false);var i=this.CreateEvent("SelectionChanged");this.FireEvent(b,i)};this.updateSelectionViewIndexes=function(a,c){if(c.getAttribute("rowIndex")==null||c.getAttribute("colIndex")==null){var d=parseInt(c.getAttribute("row")),g=parseInt(c.getAttribute("col")),f=d==-1?-1:null,e=g==-1?-1:null;if(a.getAttribute("LayoutMode")){var b=null;if(g>-1)if(d>-1){b=this.GetCellByRowCol2(a,d,g);if(b){f=this.GetRowFromCell(a,b);e=this.GetColFromCell(a,b)}}else{b=this.getFirstCellFromCol(a,c.getAttribute("col"));if(b)e=b.cellIndex}else if(d>-1)f=this.GetFirstRowFromKey(a,d)}else{if(d>-1)f=this.GetRowByKey(a,d,-1);if(g>-1)e=this.GetColByKey(a,g,-1)}f!=null&&c.setAttribute("rowIndex",f);e!=null&&c.setAttribute("colIndex",e)}};this.GetColInfo=function(e,g){var b=this.GetData(e),c=b.getElementsByTagName("root")[0],f=c.getElementsByTagName("state")[0],d=f.getElementsByTagName("colinfo")[0],a=d.firstChild;while(a!=null){if(a.getAttribute("key")==""+g)return a;a=a.nextSibling}return null};this.GetColWidthFromCol=function(b,c){var a=this.GetColGroup(this.GetViewport(b));return parseInt(a.childNodes[c].width)};this.GetColWidth=function(a){if(a==null)return null;var b=a.getElementsByTagName("width")[0];return b!=null?b.innerHTML:0};this.AddColInfo=function(b,c){var a=this.GetColInfo(b,c);if(a!=null)return a;var d=this.GetData(b),e=d.getElementsByTagName("root")[0],g=e.getElementsByTagName("state")[0],f=g.getElementsByTagName("colinfo")[0];if(document.all!=null)a=this.GetData(b).createNode("element","col","");else{a=document.createElement("col");a.style.display="none"}a.setAttribute("key",c);f.appendChild(a);return a};this.SetColWidth=function(a,c,b){if(c==null)return;c=parseInt(c);if(b<10)b=10;var i=this.IsXHTML(a),f=null;if(this.GetViewport(a)!=null){var e=this.GetColGroup(this.GetViewport(a));if(e==null||e.childNodes.length==0)e=this.GetColGroup(this.GetColHeader(a));f=this.AddColInfo(a,e.childNodes[c].getAttribute("FpCol"));if(this.GetViewport(a).cellSpacing=="0"&&this.GetColCount(a)>1&&this.GetViewport(a).rules!="rows")if(c==0)b-=1;if(b==0)b=1;if(e!=null)e.childNodes[c].width=b;this.SetWidthFix(this.GetViewport(a),c,b)}if(this.GetColHeader(a)!=null){if(this.GetViewport(a)!=null)if(this.GetViewport(a).cellSpacing=="0"&&this.GetColCount(a)>1&&this.GetViewport(a).rules!="rows")if(i)if(c==this.colCount-1)b-=1;if(b<=0)b=1;document.getElementById(a.id+"col"+c).width=b;this.SetWidthFix(this.GetColHeader(a),c,b);if(this.GetViewport(a)!=null)if(this.GetViewport(a).cellSpacing=="0"&&this.GetColCount(a)>1&&this.GetViewport(a).rules!="rows")if(c==this.GetColCount(a)-1)b+=1}if(this.GetColFooter(a)!=null){var e=this.GetColGroup(this.GetColFooter(a));if(this.GetColFooter(a).cellSpacing=="0"&&this.GetColCount(a)>1&&this.GetColFooter(a).rules!="rows")if(c==0)b-=1;if(b==0)b=1;if(e!=null)e.childNodes[c].width=b}var h=this.GetTopSpread(a);this.SizeAll(h);this.Refresh(h);if(f!=null){var d=f.getElementsByTagName("width");if(d!=null&&d.length>0)d[0].innerHTML=b;else{if(document.all!=null)d=this.GetData(a).createNode("element","width","");else{d=document.createElement("width");d.style.display="none"}f.appendChild(d);d.innerHTML=b}}var g=this.GetCmdBtn(a,"Update");g!=null&&this.UpdateCmdBtnState(g,false);a.dirty=true};this.SetWidthFix=function(c,g,f){if(c==null||c.rows.length==0)return;var e=0,d=0,b=c.rows[0].cells[0],a=b.colSpan;if(a==null)a=1;while(g>d+a){e++;d=d+a;b=c.rows[0].cells[e];a=b.colSpan;if(a==null)a=1}b.width=f};this.GetRowInfo=function(e,g){var b=this.GetData(e),c=b.getElementsByTagName("root")[0],f=c.getElementsByTagName("state")[0],d=f.getElementsByTagName("rowinfo")[0],a=d.firstChild;while(a!=null){if(a.getAttribute("key")==""+g)return a;a=a.nextSibling}return null};this.GetRowHeight=function(b){if(b==null)return null;var a=b.getElementsByTagName("height");return a!=null&&a.length>0?a[0].innerHTML:0};this.AddRowInfo=function(b,c){var a=this.GetRowInfo(b,c);if(a!=null)return a;var d=this.GetData(b),e=d.getElementsByTagName("root")[0],g=e.getElementsByTagName("state")[0],f=g.getElementsByTagName("rowinfo")[0];if(document.all!=null)a=this.GetData(b).createNode("element","row","");else{a=document.createElement("row");a.style.display="none"}a.setAttribute("key",c);f.appendChild(a);return a};this.GetTopSpread=function(c){if(c==null)return null;var b=this.GetSpread(c);if(b==null)return null;var a=b.parentNode;while(a!=null&&a.tagName!="BODY"){if(a.getAttribute&&a.getAttribute("FpSpread")=="Spread")if(a.getAttribute("hierView")=="true")b=a;else break;a=a.parentNode}return b};this.GetParentSpread=function(b){try{var a=b.parentNode;while(a!=null&&a.getAttribute&&a.getAttribute("FpSpread")!="Spread")a=a.parentNode;return a!=null&&a.getAttribute&&a.getAttribute("hierView")=="true"?a:null}catch(c){return null}};this.SetRowHeight=function(c,b,d){if(b==null)return;var a=b.getElementsByTagName("height");if(a!=null&&a.length>0)a[0].innerHTML=d;else{if(document.all!=null)a=this.GetData(c).createNode("element","height","");else{a=document.createElement("height");a.style.display="none"}b.appendChild(a);a.innerHTML=d}var e=this.GetCmdBtn(c,"Update");e!=null&&this.UpdateCmdBtnState(e,false);c.dirty=true};this.getSingleNode=function(g,f){for(var e=f.split("/"),c=g,d=0;d<e.length;d++){var b=e[d].trim().toLowerCase();if(b=="/"||b=="")continue;var a=c.firstChild;while(a!=null&&a.tagName.toLowerCase()!=b)a=a.nextSibling;if(a!=null&&a.tagName.toLowerCase()==b)c=a;else return null}return c};this.findAnchorCell=function(a){var n=this.GetData(a),h=this.getSingleNode(n,"/root/state/activerow"),g=this.getSingleNode(n,"/root/state/activecolumn"),b=h!=null?parseInt(h.innerHTML):-1,c=g!=null?parseInt(g.innerHTML):-1;if(this.GetSelection(a).childNodes.length==0||b>-1&&c>-1){var d=null;if(b==-1&&c===-1)return null;else if(a.getAttribute("LayoutMode")){if(c>-1){if(b>-1)d=this.GetCellByRowCol2(a,h.innerHTML,g.innerHTML);if(d==null)d=this.getFirstCellFromCol(a,g.innerHTML)}if(d==null){b=this.GetFirstRowFromKey(a,b);if(b==null)b=0;for(var r=parseInt(a.getAttribute("LayoutRowCount")),q=this.GetColCount(a),p=false,e=b;e<b+r;e++){for(var m=0;m<q;m++){d=this.GetCellFromRowCol(a,e,m);if(d!=null){p=true;break}}if(p)break}}}else{b=h!=null&&b!=-1?this.GetRowByKey(a,h.innerHTML,0):0;c=g!=null&&c!=-1?this.GetColByKey(a,g.innerHTML,0):0;d=this.GetCellFromRowCol(a,b,c)}if(d!=null&&d.getAttribute("canFocus")=="false"){b=this.GetRowFromCell(a,d);c=this.GetColFromCell(a,d);var k=this.moveRightInternal(a,b,c,false);if(k!=null)d=this.GetCellFromRowCol(a,k.row,k.col)}d!=null&&this.saveAnchorCell(a,d);return d}else if(b<=-1&&c>-1||b>-1&&c<=-1)if(b<=-1&&c>-1){var j=c>=a.frzCols?this.GetColHeader(a):this.GetFrozColHeader(a);if(j){b=j.rows.length+b;if(b>=0&&b<j.rows.length)for(var f=j.rows[b],e=0;e<f.cells.length;e++)if(f.cells[e].getAttribute("col")!=null&&parseInt(f.cells[e].getAttribute("col"))==c)return f.cells[e];for(var l=this.GetColGroup(j),e=0;e<l.childNodes.length;e++)if(l.childNodes[e].getAttribute("FpCol")!=null&&parseInt(l.childNodes[e].getAttribute("FpCol"))==c)return f.cells[e]}}else{var i=this.GetRowByKey(a,b,-1),o=i>=a.frzRows?this.GetRowHeader(a):this.GetFrozRowHeader(a);if(o&&i>=0){if(i>=a.frzRows)i-=a.frzRows;var f=o.rows[i];c=f.cells.length+c;return f.cells[c]}}return null};this.saveAnchorCell=function(d,a){if(a==null)return;var b=a.parentNode.getAttribute("FpSpread");if(b=="r"||b=="rh"||b=="ch"){var f=null,c=null;if(b=="r"||b=="ch")if(a.getAttribute("col")!=null&&a.getAttribute("col")!="-1")c=parseInt(a.getAttribute("col"));else if(a.getAttribute("col")==null){var g=this.GetColFromCell(d,a),h=this.GetColGroup(a.parentNode.parentNode.parentNode);if(h.childNodes.length>g&&h.childNodes[g].getAttribute("FpCol")!=null)c=parseInt(h.childNodes[g].getAttribute("FpCol"))}else c=0;else{c=-1;for(var e=a.parentNode.cells.length-1;e>=0;e--){if(e==a.cellIndex)break;c--}}if(b=="r"||b=="rh")f=this.GetRowKeyFromCell(d,a);else{f=-1;for(var i=a.parentNode.parentNode.parentNode,e=i.rows.length-1;e>=0;e--){if(e==a.parentNode.rowIndex)break;f--}}if(f!=null&&c!=null){this.SetActiveRow(d,f);this.SetActiveCol(d,c)}}else if(this.IsChild(a,this.GetCorner(d))){this.SetActiveRow(d,-1);this.SetActiveCol(d,-1)}};this.SetActiveRow=function(a,d){if(this.GetRowCount(a)<1)return;if(d==null)d=-1;var e=this.GetData(a),f=e.getElementsByTagName("root")[0],g=f.getElementsByTagName("state")[0],c=g.firstChild;while(c!=null&&c.tagName!="activerow"&&c.tagName!="ACTIVEROW")c=c.nextSibling;if(c!=null)c.innerHTML=""+d;if(d!=null&&a.getAttribute("IsNewRow")!="true"&&a.getAttribute("AllowInsert")=="true"){var b=this.GetCmdBtn(a,"Insert");this.UpdateCmdBtnState(b,false);b=this.GetCmdBtn(a,"Add");this.UpdateCmdBtnState(b,false)}else{var b=this.GetCmdBtn(a,"Insert");this.UpdateCmdBtnState(b,true);b=this.GetCmdBtn(a,"Add");this.UpdateCmdBtnState(b,true)}if(d!=null&&a.getAttribute("IsNewRow")!="true"&&(a.getAttribute("AllowDelete")==null||a.getAttribute("AllowDelete")=="true")){var b=this.GetCmdBtn(a,"Delete");this.UpdateCmdBtnState(b,d==-1)}else{var b=this.GetCmdBtn(a,"Delete");this.UpdateCmdBtnState(b,true)}a.dirty=true};this.SetActiveCol=function(b,e){var c=this.GetData(b),d=c.getElementsByTagName("root")[0],f=d.getElementsByTagName("state")[0],a=f.firstChild;while(a!=null&&a.tagName!="activecolumn"&&a.tagName!="ACTIVECOLUMN")a=a.nextSibling;if(a!=null)a.innerHTML=""+parseInt(e);b.dirty=true};this.getTextElement=function(a){if(a.tagName.toUpperCase()=="INPUT"&&a.type=="text"||a.tagName.toUpperCase()=="TEXTAREA")return a;for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(!c.tagName)continue;var d=this.getTextElement(c);if(d!=null)return d}return null};this.GetEditor=function(d){if(d==null)return null;var e=this.GetCellType(d);if(e=="readonly")return null;var a=d.getElementsByTagName("DIV");if(a!=null&&a.length>0&&!a[0].select){var b=this.getTextElement(a[0]);if(b!=null&&b.select){a[0].select=Function.CreateDelegate(b,b.select);if(!b.getValue)b.getValue=function(){return this.value};if(!b.setValue)b.setValue=function(a){this.value=a};a[0].getValue=Function.CreateDelegate(b,b.getValue);a[0].setValue=Function.CreateDelegate(b,b.setValue)}}if(e=="MultiColumnComboBoxCellType")if(a!=null&&a.length>0){var c=a[0];c.type="div";return c}var a=d.getElementsByTagName("INPUT");if(a!=null&&a.length>0){var c=a[0];while(c!=null&&c.getAttribute&&c.getAttribute("FpEditor")==null)c=c.parentNode;if(!c.getAttribute)c=null;return c}a=d.getElementsByTagName("SELECT");if(a!=null&&a.length>0)return a[0];a=d.getElementsByTagName("TEXTAREA");if(a!=null&&a.length>0){var c=a[0];if(e=="text")return c}return null};this.GetPageActiveSpread=function(){var a=document.documentElement.getAttribute("FpActiveSpread"),b=null;if(a!=null)b=document.getElementById(a);return b};this.GetPageActiveSheetView=function(){var a=document.documentElement.getAttribute("FpActiveSheetView"),b=null;if(a!=null)b=document.getElementById(a);return b};this.SetPageActiveSpread=function(a){if(a==null)document.documentElement.setAttribute("FpActiveSpread",null);else{var b=this.GetTopSpread(a);b.lastActiveSpreadId=a.id;document.documentElement.setAttribute("FpActiveSpread",a.id);document.documentElement.setAttribute("FpActiveSheetView",a.id)}};this.getLastActiveSpread=function(c){var a=this.GetTopSpread(c);if(a==null)return null;var b=a.lastActiveSpreadId;return b?document.getElementById(b):null};this.DoResize=function(){if(the_fpSpread.spreads==null)return;for(var b=the_fpSpread.spreads.length,a=0;a<b;a++)the_fpSpread.spreads[a]!=null&&the_fpSpread.SizeSpread(the_fpSpread.spreads[a])};this.DblClick=function(d){var a=this.GetCell(this.GetTarget(d),true,d),b=this.GetSpread(a);if(a!=null&&!this.IsHeaderCell(a)&&this.GetOperationMode(b)=="RowMode"&&this.GetEnableRowEditTemplate(b)=="true"){var c=a.getElementsByTagName("DIV");if(c!=null&&c.length>0&&c[0].id==b.id+"_RowEditTemplateContainer")return;this.Edit(b,this.GetRowKeyFromCell(b,a));var e=this.GetCmdBtn(b,"Cancel");e!=null&&this.UpdateCmdBtnState(e,false);return}a!=null&&!this.IsHeaderCell(a)&&a==b.anchorCell&&this.StartEdit(b,a)};this.GetEvent=function(a){return a!=null?a:window.event};this.GetTarget=function(a){a=this.GetEvent(a);if(a.target==document)if(a.currentTarget!=null)return a.currentTarget;return a.target!=null?a.target:a.srcElement};this.StartEdit=function(b,o){var l=this.GetOperationMode(b);if(l=="SingleSelect"||l=="ReadOnly"||this.editing)return;if(l=="RowMode"&&this.GetEnableRowEditTemplate(b)=="true")return;var a=o;if(a==null)a=b.anchorCell;if(a==null)return;if(this.IsHeaderCell(b,a))return;this.renderAsEditor=-1;var i=this.GetEditor(a);if(i!=null){this.editing=true;this.editor=i;this.renderAsEditor=1}var p=this.IsXHTML(b);if(a!=null){var r=this.GetRowFromCell(b,a),q=this.GetColFromCell(b,a),f=this.CreateEvent("EditStart");f.cell=a;f.row=this.GetSheetIndex(b,r);f.col=q;f.cancel=false;this.FireEvent(b,f);if(f.cancel)return;var n=this.GetCellType(a);if(n=="readonly")return;if(b.anchorCell!=a){b.anchorCell=a;this.SetActiveRow(b,this.GetRowKeyFromCell(b,a));this.SetActiveCol(b,this.GetColKeyFromCell(b,a))}if(i==null){var e=this.GetRender(a),g=this.GetValueFromRender(b,e);this.editingValue=g;this.editingFormula=this.GetFormulaFromCell(a);if(this.editingFormula!=null)g=this.editingFormula;try{if(e!=a)e.style.display="none";else e.innerHTML=""}catch(f){return}var j=this.GetCellEditorID(b,a);if(j!=null&&j.length>0){this.editor=this.GetCellEditor(b,j,true);if(!this.editor.getAttribute("MccbId")&&!this.editor.getAttribute("Extenders"))this.editor.style.display="inline";else this.editor.style.display="block"}else{this.editor=document.createElement("INPUT");this.editor.type="text"}this.editor.style.fontFamily=e.style.fontFamily;this.editor.style.fontSize=e.style.fontSize;this.editor.style.fontWeight=e.style.fontWeight;this.editor.style.fontStyle=e.style.fontStyle;this.editor.style.textDecoration=e.style.textDecoration;this.editor.style.position="";if(p){var h=a.clientWidth-2,d=parseInt(a.style.paddingLeft);if(!isNaN(d))h-=d;else if(document.defaultView!=null&&document.defaultView.getComputedStyle!=null){d=parseInt(document.defaultView.getComputedStyle(a,"").getPropertyValue("padding-Left"));if(!isNaN(d))h-=d}d=parseInt(a.style.paddingRight);if(!isNaN(d))h-=d;else if(document.defaultView!=null&&document.defaultView.getComputedStyle!=null){d=parseInt(document.defaultView.getComputedStyle(a,"").getPropertyValue("padding-Right"));if(!isNaN(d))h-=d}this.editor.style.width=""+h+"px"}else this.editor.style.width=a.clientWidth-2;this.SaveMargin(a);if(this.editor.tagName=="TEXTAREA")this.editor.style.height=""+(a.offsetHeight-4)+"px";if(this.editor.tagName=="INPUT"&&this.editor.type=="text"||this.editor.tagName=="TEXTAREA"){if(this.editor.style.backgroundColor==""||this.editor.backColorSet!=null){var k="";if(document.defaultView!=null&&document.defaultView.getComputedStyle!=null)k=document.defaultView.getComputedStyle(a,"").getPropertyValue("background-color");if(k!="")this.editor.style.backgroundColor=k;else this.editor.style.backgroundColor=a.bgColor;this.editor.backColorSet=true}if(this.editor.style.color==""||this.editor.colorSet!=null){var m="";if(document.defaultView!=null&&document.defaultView.getComputedStyle!=null)m=document.defaultView.getComputedStyle(a,"").getPropertyValue("color");this.editor.style.color=m;this.editor.colorSet=true}this.editor.style.borderWidth="0px";this.RestoreMargin(this.editor,false)}this.renderAsEditor=0;a.insertBefore(this.editor,a.firstChild);this.SetEditorValue(this.editor,g,b);if(this.editor.tagName=="SELECT"){this.editorSelectedIndex=this.editor.selectedIndex;if(g==null||g==""&&a.getAttribute("specialValue")==null)this.editor.selectedIndex=this.editorSelectedIndex=-1}if(this.editor.offsetHeight<a.clientHeight&&this.editor.tagName!="TEXTAREA")if(a.vAlign=="middle")this.editor.style.posTop+=(a.clientHeight-this.editor.offsetHeight)/2;else if(a.vAlign=="bottom")this.editor.style.posTop+=a.clientHeight-this.editor.offsetHeight;this.SizeAll(this.GetTopSpread(b))}this.editing=true;this.SetEditorFocus(this.editor);if(this.isEditModeReplace(b,a))this.editor.select&&this.editor.select();var c=this.GetCmdBtn(b,"Update");c!=null&&c.disabled&&this.UpdateCmdBtnState(c,false);c=this.GetCmdBtn(b,"Copy");c!=null&&!c.disabled&&this.UpdateCmdBtnState(c,true);c=this.GetCmdBtn(b,"Paste");c!=null&&!c.disabled&&this.UpdateCmdBtnState(c,true);c=this.GetCmdBtn(b,"Clear");c!=null&&!c.disabled&&this.UpdateCmdBtnState(c,true)}this.ScrollView(b)};this.GetCurrency=function(a){var b=a.CurrencySymbol;if(b!=null)return b;var c=document.getElementById(a.id+"cs");return c!=null?c.innerText:""};this.GetValueFromRender=function(g,d){var b=this.GetCellType2(this.GetCell(d));if(b!=null){if(b=="text")b="TextCellType";var a=null;if(b=="ExtenderCellType"){a=this.GetFunction(b+"_getEditor");if(a!=null)if(a(d)!=null)a=this.GetFunction(b+"_getEditorValue");else a=null}else a=this.GetFunction(b+"_getValue");if(a!=null)return a(d,g)}var c=d;while(c.firstChild!=null&&c.firstChild.nodeName!="#text")c=c.firstChild;var f=this.GetCell(d);if(this.Trim(c.innerHTML)=="&nbsp;")return f.getAttribute("whiteSpace")==null?"":" ";var e=c.value;if(typeof e=="undefined")e=c.textContent.trim();return e};this.ReplaceAll=function(a,d,c){if(a==null)return a;var b=a.length;while(true){a=a.replace(d,c);if(a.length==b)break;b=a.length}return a};this.GetFormula=function(b,a,e){a=this.GetDisplayIndex(b,a);var d=this.GetCellFromRowCol(b,a,e),c=this.GetFormulaFromCell(d);return c};this.SetFormula=function(a,b,g,d,f,e){b=this.GetDisplayIndex(a,b);var c=this.GetCellFromRowCol(a,b,g);c.setAttribute("FpFormula",d);!e&&this.SetCellValue(a,c,d,null,f)};this.GetFormulaFromCell=function(b){var a=null;if(b.getAttribute("FpFormula")!=null)a=b.getAttribute("FpFormula");if(a!=null)a=this.Trim(new String(a));return a};this.IsDouble=function(b,l,h,i,g,f){if(b==null||b.length==0)return true;b=the_fpSpread.Trim(b);if(b.length==0)return true;if(h!=null)b=b.replace(h,"-");if(i!=null)b=b.replace(i,"+");if(b.charAt(b.length-1)=="-")b="-"+b.substring(0,b.length-1);var m=new RegExp("^\\s*([-\\+])?(\\d+)?(\\"+l+"(\\d+))?([eE]([-\\+])?(\\d+))?\\s*$"),a=b.match(m);if(a==null)return false;if((a[2]==null||a[2].length==0)&&(a[4]==null||a[4].length==0))return false;var c="";if(a[1]!=null&&a[1].length>0)c=a[1];if(a[2]!=null&&a[2].length>0)c+=a[2];else c+="0";if(a[4]!=null&&a[4].length>0)c+="."+a[4];if(a[6]!=null&&a[6].length>0){c+="E"+a[6];if(a[7]!=null)c+=a[7];else c+="0"}var e=parseFloat(c);if(isNaN(e))return false;var d=true;if(g!=null){var k=parseFloat(g);d=!isNaN(k)&&e>=k}if(d&&f!=null){var j=parseFloat(f);d=!isNaN(j)&&e<=j}return d};this.GetFunction=function(fn){if(fn==null||fn=="")return null;try{return eval(fn)}catch(e){return null}};this.SetValueToRender=function(a,b,f){var c=null,d=this.GetCellType2(this.GetCell(a));if(d!=null){if(d=="text")d="TextCellType";if(d=="ExtenderCellType"){c=this.GetFunction(d+"_getEditor");if(c!=null)if(c(a)!=null)c=this.GetFunction(d+"_setEditorValue");else c=null}else c=this.GetFunction(d+"_setValue")}if(c!=null)c(a,b);else if(typeof a.value!="undefined"){if(b==null)b="";if(typeof a.maxLength!="undefined"&&a.maxLength>0)b=b.substring(0,a.maxLength);a.value=b}else{var e=a;while(e.firstChild!=null&&e.firstChild.nodeName!="#text")e=e.firstChild;e.innerHTML=$$.utils.htmlEncode(b)}(f==null||!f)&&a.getAttribute("FpFormula")!=null&&a.setAttribute("FpFormula",b)};this.Trim=function(b){var a=b.match(new RegExp("^\\s*(\\S+(\\s+\\S+)*)\\s*$"));return a==null?"":a[1]};this.GetOffsetLeft=function(f,c,e){var b=e;if(b==null)b=this.GetViewportFromCell(f,c);var d=0,a=c;while(a!=null&&a!=b){d+=a.offsetLeft;a=a.offsetParent}return d};this.GetOffsetTop=function(f,c,e){var b=e;if(b==null)b=this.GetViewportFromCell(f,c);var d=0,a=c;while(a!=null&&a!=b){d+=a.offsetTop;a=a.offsetParent}return d};this.SetEditorFocus=function(a){if(a==null)return;var c=true,b=this.GetCell(a,true),d=this.GetCellType(b);if(d!=null){var e=this.GetFunction(d+"_setFocus");if(e!=null){e(a);c=false}}if(c)try{b.getAttribute("RowEditTemplate")!="true"&&a.focus()}catch(f){}};this.SetEditorValue=function(b,d,e){var f=this.GetCell(b,true),a=this.GetCellType(f);if(a!=null){var c=this.GetFunction(a+"_setEditorValue");if(c!=null){c(b,d,e);return}}a=b.getAttribute("FpEditor");if(a!=null){var c=this.GetFunction(a+"_setEditorValue");if(c!=null){c(b,d,e);return}}b.value=d};this.GetEditorValue=function(a,d){var e=this.GetCell(a,true),b=this.GetCellType(e);if(b!=null){var c=this.GetFunction(b+"_getEditorValue");if(c!=null)return c(a,d)}b=a.getAttribute("FpEditor");if(b!=null){var c=this.GetFunction(b+"_getEditorValue");if(c!=null)return c(a,d)}return a.type=="checkbox"?a.checked?"True":"False":a.value};this.CreateMsg=function(){if(this.validationMsg!=null)return;var a=this.validationMsg=document.createElement("div");a.style.position="absolute";a.style.background="yellow";a.style.color="red";a.style.border="1px solid black";a.style.display="none";a.style.width="120px"};this.SetMsg=function(a){this.CreateMsg();this.validationMsg.innerHTML=a};this.ShowMsg=function(a){this.CreateMsg();if(a)this.validationMsg.style.display="block";else this.validationMsg.style.display="none"};this.getMaskedEditValidtor=function(b){if(typeof Page_Validators!="undefined"){var a=null;for(i=0;i<Page_Validators.length;i++){a=Page_Validators[i];if(typeof a.enabled=="undefined"||a.enabled!=false)if(a.id==b+"")return a}}};this.EndEdit=function(){if(this.editor!=null&&this.editor.parentNode!=null){var cell=this.GetCell(this.editor.parentNode),ss=this.GetSpread(cell,false);if(ss==null)return true;ss.valid=true;var val=this.GetEditorValue(this.editor,ss),tval=val;if(typeof val=="string")tval=this.Trim(val);var ignoreValidation=ss.getAttribute("AcceptFormula")=="true"&&tval!=null&&tval.charAt(0)=="=",checkbox=this.renderAsEditor!=0,canExtenderValidation=false,maskedEditExtenderDiv=cell.getElementsByTagName("div")[0],maskedEditValidtorItem;if(typeof maskedEditExtenderDiv!="undefined"&&maskedEditExtenderDiv!=null)if(maskedEditExtenderDiv.getAttribute("Extenders")!=null&&maskedEditExtenderDiv.getAttribute("Extenders").indexOf("MaskedEditExtender")!=-1){canExtenderValidation=this.getMaskedEditValidtor((maskedEditExtenderDiv.id.replace("Editor","")+"validator").replace(new RegExp(",","g"),"_"))!=null;maskedEditValidtorItem=this.getMaskedEditValidtor((maskedEditExtenderDiv.id.replace("Editor","")+"validator").replace(new RegExp(",","g"),"_"))}if(!ignoreValidation&&!checkbox||canExtenderValidation){var msg=null,ct=this.GetCellType(cell);if(ct!=null){var f=this.GetFunction(ct+"_isValid");if(f!=null){msg=f(cell,val);var e=this.CreateEvent("ErrorMessageShown");e.spread=ss;e.row=this.GetRowFromCell(ss,cell);e.col=this.GetColFromCell(ss,cell);e.errorMessage=msg;if(msg=="")e.isValid=true;else e.isValid=false;this.FireEvent(ss,e)}}if(canExtenderValidation){var exvalidator=this.getMaskedEditValidtor((maskedEditExtenderDiv.id.replace("Editor","")+"validator").replace(new RegExp(",","g"),"_"));if(exvalidator)try{ExtenderCellType_validateValue&&ExtenderCellType_validateValue(this.editor);var crtret=true;if(typeof exvalidator.evaluationfunction=="function"){crtret=exvalidator.evaluationfunction(exvalidator);if(!crtret)if(typeof exvalidator.errormessage=="string"){if(msg!="")msg+=", ";msg=exvalidator.errormessage}}else if(typeof exvalidator.evaluationfunction=="string"){eval("crtret = "+exvalidator.evaluationfunction+"("+exvalidator.id+")");if(!crtret)if(typeof exvalidator.errormessage=="string"){if(msg!="")msg+=", ";msg=exvalidator.errormessage}}if(ExtenderCellType_setValidateEditor)if(!crtret){var inputs=this.editor.getElementsByTagName("INPUT");for(i=0;i<inputs.length;i++){var textInput=inputs[i];textInput.type=="text"&&textInput.setAttribute("isInvalid",true)}ExtenderCellType_setValidateEditor(this.editor)}else{var inputs=this.editor.getElementsByTagName("INPUT");for(i=0;i<inputs.length;i++){var textInput=inputs[i];textInput.type=="text"&&textInput.removeAttribute("isInvalid")}ExtenderCellType_setValidateEditor(null)}if(!crtret&&typeof exvalidator.focusOnError=="string"&&exvalidator.focusOnError=="t"){ctrl=this.editor.getElementsByTagName("input")[0];ctrl!=null&&ctrl.focus!="undefined"&&ctrl.focus!=null&&setTimeout(function(){ctrl.focus()},0)}}catch(e){}}if(msg!=null&&msg!=""){this.SetMsg(msg);this.GetViewport(ss).parentNode.insertBefore(this.validationMsg,this.GetViewport(ss).parentNode.lastChild);this.ShowMsg(true);this.SetValidatorPos(ss);this.editor.focus();ss.valid=false}else this.ShowMsg(false);if(msg!=null&&msg!=""||crtret!=null&&!crtret)return false}var selectedIndex=-1;if(!checkbox){if(this.editor.tagName=="SELECT")selectedIndex=this.editor.selectedIndex;cell.removeChild(this.editor);this.editor.style.display="none";this.GetViewport(ss).parentNode.appendChild(this.editor);this.SetEditorValue(this.editor,"",ss);if(this.editor.tagName=="SELECT")this.editor.selectedIndex=-1;var rd=this.GetRender(cell);if(rd.style.display=="none")rd.style.display="block";if(this.editingFormula!=null&&this.editingFormula==val)this.SetValueToRender(rd,this.editingValue,true);else this.SetValueToRender(rd,val);this.RestoreMargin(cell)}if(this.editingFormula!=null&&this.editingFormula!=val||this.editingFormula==null&&this.editingValue!=val||this.editor.tagName=="SELECT"&&this.editorSelectedIndex!=selectedIndex){this.SetCellValue(ss,cell,val);if(val!=null&&val.length>0&&val.indexOf("=")==0)cell.setAttribute("FpFormula",val);else cell.removeAttribute("FpFormula")}!checkbox&&this.SizeAll(this.GetTopSpread(ss));this.editor=null;this.editing=false;var e=this.CreateEvent("EditStopped");e.cell=cell;this.FireEvent(ss,e);this.Focus(ss);var autoCalc=ss.getAttribute("autoCalc");if(autoCalc!="false")(this.editingFormula!=null&&this.editingFormula!=val||this.editingFormula==null&&this.editingValue!=val)&&this.UpdateValues(ss)}this.renderAsEditor=-1;return true};this.SetValidatorPos=function(){if(this.editor==null)return;var b=this.GetCell(this.editor.parentNode);if(b==null)return;var a=this.validationMsg;if(a!=null&&a.style.display!="none")if(a!=null){a.style.left=""+b.offsetLeft+"px";a.style.top=""+(b.offsetTop+b.offsetHeight)+"px"}};this.SaveMargin=function(a){if(a.style.paddingLeft!=null&&a.style.paddingLeft!=""){this.editorMargin.left=a.style.paddingLeft;a.style.paddingLeft=0}if(a.style.paddingRight!=null&&a.style.paddingRight!=""){this.editorMargin.right=a.style.paddingRight;a.style.paddingRight=0}if(a.style.paddingTop!=null&&a.style.paddingTop!=""){this.editorMargin.top=a.style.paddingTop;a.style.paddingTop=0}if(a.style.paddingBottom!=null&&a.style.paddingBottom!=""){this.editorMargin.bottom=a.style.paddingBottom;a.style.paddingBottom=0}};this.RestoreMargin=function(b,a){if(this.editorMargin.left!=null&&this.editorMargin.left!=-1){b.style.paddingLeft=this.editorMargin.left;if(a==null||a)this.editorMargin.left=-1}if(this.editorMargin.right!=null&&this.editorMargin.right!=-1){b.style.paddingRight=this.editorMargin.right;if(a==null||a)this.editorMargin.right=-1}if(this.editorMargin.top!=null&&this.editorMargin.top!=-1){b.style.paddingTop=this.editorMargin.top;if(a==null||a)this.editorMargin.top=-1}if(this.editorMargin.bottom!=null&&this.editorMargin.bottom!=-1){b.style.paddingBottom=this.editorMargin.bottom;if(a==null||a)this.editorMargin.bottom=-1}};var colors={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};this.getColorValue=function(a){for(var b in colors)if(a!=null&&a.toLowerCase()==b)return"#"+colors[b];return null};this.darker=function(b,f){if(b==null)return null;var e,d,c,a;if(b.length>3&&b.substring(0,3).toUpperCase()=="RGB"){var h=b.match(new RegExp("\\d{1,3}","g"));e=h[0];d=h[1];c=h[2]}else if(b.substring(0,1)!="#"){var g=this.getColorValue(b);if(g==null)return b;b=g;e=parseInt(b.substring(1,3),16);d=parseInt(b.substring(3,5),16);c=parseInt(b.substring(5,7),16)}if(f.substring(0,1)!="#"){var g=this.getColorValue(f);if(g==null)g="#bbbbbb";f=g}var k=256-parseInt(f.substring(1,3),16),j=256-parseInt(f.substring(3,5),16),i=256-parseInt(f.substring(5,7),16);e-=k;if(e>255)e=255;if(e<0)e=0;d-=j;if(d>255)d=255;if(d<0)d=0;c-=i;if(c>255)c=255;if(c<0)c=0;a=c.toString(16);if(a.length<2)a="0"+a;a=d.toString(16)+a;if(a.length<4)a="0"+a;a=e.toString(16)+a;if(a.length<6)a="0"+a;return"#"+a.toUpperCase()};this.PaintSelectedCell=function(c,a,g,f){if(a==null)return;var e=f?c.getAttribute("anchorBackColor"):c.getAttribute("selectedBackColor");if(g){var b=document.defaultView.getComputedStyle(a,"").getPropertyValue("background-color");a.getAttribute("bgColorBak")==null&&a.setAttribute("bgColorBak",b);if(a.bgColor1==null)a.bgColor1=a.style.backgroundColor;if(a.getAttribute("paintSelected")==null||f){if(c.getAttribute("semiTransparentSelectedBackColor")==null||b==null||b.length==0||b=="transparent"||b=="rgb(0, 0, 0)"||b=="rgba(0, 0, 0, 0)")a.style.backgroundColor=e;else a.style.backgroundColor=this.darker(b,e);a.setAttribute("paintSelected",true)}if(a.getAttribute("bgSelImg"))a.style.backgroundImage=a.getAttribute("bgSelImg");else{var d=this.GetCurrentStyle2(a);if(d.backgroundImage!=null&&d.backgroundImage!="")a.style.backgroundImage=""}}else{a.removeAttribute("paintSelected");if(a.bgColor1!=null)a.style.backgroundColor="";if(a.bgColor1!=null&&a.bgColor1!="")a.style.backgroundColor=a.bgColor1;a.style.backgroundImage="";if(a.getAttribute("bgImg")!=null)a.style.backgroundImage=a.getAttribute("bgImg")}};this.PaintAnchorCell=function(a){var b=this.GetOperationMode(a);if(a.anchorCell==null||b!="Normal"&&b!="RowMode")return;if(b=="MultiSelect"||b=="ExtendedSelect")return;if(!this.IsChild(a.anchorCell,a))return;if(a.oldAnchorCell&&a.oldAnchorCell!=a.anchorCell){if(this.GetSelectionPolicy(a)!="MultiRange"){var h=this.GetRowFromCell(a,a.oldAnchorCell),e=this.GetColFromCell(a,a.oldAnchorCell),f=this.IsColSelected(a,e)||this.IsChild(window.event.target,this.GetCorner(a))||this.IsChild(window.event.target,this.GetRowHeader(a));this.GetColHeader(a)!=null&&!f&&this.PaintHeaderSelection(a,h,e,1,1,false,true)}var g=a.oldAnchorCell.getAttribute("paintSelected")!=null;this.PaintSelectedCell(a,a.oldAnchorCell,false);g&&this.PaintSelectedCell(a,a.oldAnchorCell,true,false);a.oldAnchorCell=null}var d=this.GetTopSpread(a).getAttribute("hierView")!="true";if(a.getAttribute("showFocusRect")=="false")d=false;if(d){this.PaintSelectedCell(a,a.anchorCell,false);this.PaintFocusRect(a);this.PaintAnchorCellHeader(a,true);return}var c=a.anchorCell.parentNode.cells[0].firstChild;if(c!=null&&c.nodeName!="#text"&&c.getAttribute("FpSpread")=="Spread")return;this.PaintSelectedCell(a,a.anchorCell,false);this.PaintSelectedCell(a,a.anchorCell,true,true);this.PaintAnchorCellHeader(a,true)};this.ClearSelection=function(a,j){var e=this.GetParentSpread(a);if(j==null&&e!=null&&e.getAttribute("hierView")=="true"){this.ClearSelection(e);return}var b=this.GetViewport(a),i=this.GetRowCount(a);if(b!=null&&b.rows.length>i)for(var c=0;c<b.rows.length;c++)if(b.rows[c].cells.length>0&&b.rows[c].cells[0]!=null&&b.rows[c].cells[0].firstChild!=null&&b.rows[c].cells[0].firstChild.nodeName!="#text"){var h=b.rows[c].cells[0].firstChild;h.getAttribute("FpSpread")=="Spread"&&this.ClearSelection(h,true)}this.DoclearSelection(a);if(a.anchorCell!=null){var d=this.GetOperationMode(a);if(d=="RowMode"||d=="SingleSelect"||d=="ExtendedSelect"||d=="MultiSelect"){var g=a.fpSpreadJS.getRowRangeFromCell(a.anchorCell);this.PaintSelection(a,g.row,-1,g.rowCount,-1,false)}this.PaintSelectedCell(a,a.anchorCell,false);this.PaintAnchorCellHeader(a,false)}else{var f=this.GetCellFromRowCol(a,1,0);f!=null&&this.PaintSelectedCell(a,f,false)}this.PaintFocusRect(a);a.selectedCols=[];a.dirty=true};this.SetSelectedRange=function(a,c,g,b,f){this.ClearSelection(a);var c=this.GetDisplayIndex(a,c),e=0,h=b,d=this.GetViewport(a);if(d!=null)for(i=c;i<d.rows.length&&e<h;i++)if(this.IsChildSpreadRow(a,d,i))b++;else e++;this.PaintSelection(a,c,g,b,f,true);this.SetSelection(a,c,g,b,f)};this.AddSelection=function(a,c,g,b,f){var c=this.GetDisplayIndex(a,c),e=0,h=b,d=this.GetViewport(a);if(d!=null)for(i=c;i<d.rows.length&&e<h;i++)if(this.IsChildSpreadRow(a,d,i))b++;else e++;this.PaintSelection(a,c,g,b,f,true);this.SetSelection(a,c,g,b,f,true)};this.SelectRow=function(a,b,e,f,h){if((a.selectionBlockOptions&SelectionBlockOptions.Rows)==0)return;a.selectStartRow=b;a.selectStartCol=-1;if(!h)for(var c=null,g=this.GetViewport(a),j=this.GetColGroup(g),i=g.parentNode.scrollLeft,d=0;d<j.childNodes.length;d++){c=this.GetCellFromRowCol(a,b,d);if(c!=null&&c.offsetLeft>=i)if(!(c.getAttribute("canFocus")=="false")){this.UpdateAnchorCell(a,b,d,false);break}}a.selectType="r";this.PaintSelection(a,b,-1,e,-1,f);if(f)this.SetSelection(a,b,-1,e,-1);else{this.RemoveSelection(a,b,-1,e,-1);this.PaintFocusRect(a)}};this.SelectColumn=function(a,c,k,j,l){if((a.selectionBlockOptions&SelectionBlockOptions.Columns)==0)return;a.selectStartRow=-1;a.selectStartCol=c;if(!l){for(var b=0,d=this.GetViewport(a),i=d.parentNode.scrollTop-a.virtualTop,b=0;b<d.rows.length;b++){if(!d.rows[b].getAttribute("FpKey"))continue;if(d.rows[b].offsetTop>=i)break}b+=a.frzRows;var g=c;if(a.getAttribute("LayoutMode")){var h=a.anchorCell;if(parseInt(a.anchorCell.getAttribute("col"))==-1)return;if(h){b=this.GetRowFromCell(a,h);g=this.GetColFromCell(a,h)}a.copymulticol=true}var f=b;while(f<d.rows.length){var e=this.GetCellFromRowCol(a,f,g);if(e!=null&&!e.getAttribute("group")&&e.getAttribute("canFocus")!="false"&&e.offsetTop>=i){this.UpdateAnchorCell(a,f,g,false,true);break}f+=a.getAttribute("LayoutMode")?parseInt(a.getAttribute("layoutrowcount")):1}}a.selectType="c";this.PaintSelection(a,-1,c,-1,k,j);if(j){this.SetSelection(a,-1,c,-1,k);this.AddColSelection(a,c)}};this.AdjustAnchorCell=function(a,i){var c=this.GetViewport(a);if(c==null)return-1;for(var b=0,h=c.parentNode.scrollTop-a.virtualTop,b=0;b<c.rows.length;b++){if(!c.rows[b].getAttribute("FpKey"))continue;if(c.rows[b].offsetTop>=h)break}b+=a.frzRows;var d=i;if(a.getAttribute("LayoutMode")){var g=a.anchorCell;if(parseInt(a.anchorCell.getAttribute("col"))==-1)return;if(g){b=this.GetRowFromCell(a,g);d=this.GetColFromCell(a,g)}a.copymulticol=true}var f=b;while(f<a.frzRows+c.rows.length){var e=this.GetCellFromRowCol(a,f,d);if(e!=null&&!e.getAttribute("group")&&e.getAttribute("canFocus")!="false"&&e.offsetTop>=h){this.UpdateAnchorCell(a,f,d,false,true);break}f+=a.getAttribute("LayoutMode")?parseInt(a.getAttribute("layoutrowcount")):1}return d};this.AddColSelection=function(b,c){for(var d=0,a=0;a<b.selectedCols.length;a++){if(b.selectedCols[a]==c)return;if(c>b.selectedCols[a])d=a+1}b.selectedCols.length++;for(var a=b.selectedCols.length-1;a>d;a--)b.selectedCols[a]=b.selectedCols[a-1];b.selectedCols[d]=c};this.IsColSelected=function(b,c){for(var a=0;a<b.selectedCols.length;a++)if(b.selectedCols[a]==c)return true;return false};this.SyncColSelection=function(b){b.selectedCols=[];for(var e=this.GetSelectedRanges(b),c=0;c<e.length;c++){var a=e[c];if(a.type=="Column")for(var d=a.col;d<a.col+a.colCount;d++)this.AddColSelection(b,d)}};this.InitMovingCol=function(a,f,k,i){if(a.getAttribute("LayoutMode")&&f==-1)return;if(this.GetOperationMode(a)!="Normal"){a.selectedCols=[];a.selectedCols.push(f)}if(k){this.dragCol=f;this.dragViewCol=this.GetColByKey(a,f)}else{this.dragCol=parseInt(this.GetSheetColIndex(a,f));this.dragViewCol=f}var b=this.GetMovingCol(a);if(k){this.ClearSelection(a);b.innerHTML="";var d=document.createElement("DIV");d.innerHTML=i.innerHTML;d.style.borderTop="0px solid";d.style.borderLeft="0px solid";d.style.borderRight="#808080 1px solid";d.style.borderBottom="#808080 1px solid";d.style.width=""+Math.max(this.GetPreferredCellWidth(a,i),80)+"px";b.appendChild(d);if(a.getAttribute("DragColumnCssClass")==null){b.style.backgroundColor=i.style.backgroundColor;b.style.paddingTop="1px";b.style.paddingBottom="1px"}b.style.top="-50px";b.style.left="-100px"}else{var l=0;b.style.top="0px";b.style.left="-1000px";b.style.display="";b.innerHTML="";var m=document.createElement("TABLE");b.appendChild(m);var p=document.createElement("TR");m.appendChild(p);for(var g=0;g<a.selectedCols.length;g++){var c=document.createElement("TD");p.appendChild(c);var h,j;if(a.getAttribute("columnHeaderAutoTextIndex")!=null)h=parseInt(a.getAttribute("columnHeaderAutoTextIndex"));else h=a.getAttribute("ColHeaders")-1;j=a.selectedCols[g];var e=this.GetHeaderCellFromRowCol(a,h,j,true);if(e.getAttribute("FpCellType")=="ExtenderCellType"&&e.getElementsByTagName("DIV").length>0){var q=this.GetEditor(e),r=this.GetFunction("ExtenderCellType_getEditorValue");if(q!=null&&r!=null)c.innerHTML=r(q)}else c.innerHTML=e.innerHTML;c.style.cssText=e.style.cssText;c.style.borderTop="0px solid";c.style.borderLeft="0px solid";c.style.borderRight="#808080 1px solid";c.style.borderBottom="#808080 1px solid";c.style.whiteSpace="nowrap";c.setAttribute("align","center");var s=Math.max(this.GetPreferredCellWidth(a,e),80);c.style.width=""+s+"px";l+=s}if(a.getAttribute("DragColumnCssClass")==null){b.style.backgroundColor=a.getAttribute("SelectedBackColor");b.style.tableLayout="fixed";b.style.width=""+l+"px"}}a.selectedCols.context=[];var t=a.selectedCols.context,o=0;cg=this.GetColGroup(this.GetColHeader(a));if(cg!=null)for(var g=0;g<cg.childNodes.length;g++){var n=cg.childNodes[g].offsetWidth;t.push({left:o,width:n});o+=n}};this.SelectTable=function(a,f){if((a.selectionBlockOptions&SelectionBlockOptions.Sheet)==0)return;if(f){this.ClearSelection(a);for(var b=null,c=this.GetViewport(a),i=this.GetColGroup(c),g=false,d=0;d<c.rows.length;d++){var h=d+a.frzRows;if(!c.rows[d].getAttribute("FpKey"))continue;for(var e=0;e<i.childNodes.length;e++){b=this.GetCellFromRowCol(a,h,e);if(b!=null&&!b.getAttribute("group")&&b.offsetTop>=c.parentNode.scrollTop-a.virtualTop&&b.offsetLeft>=c.parentNode.scrollLeft)if(!(b.getAttribute("canFocus")=="false")){this.UpdateAnchorCell(a,h,e,false);d=c.rows.length;g=true;break}}if(g)break}}a.selectType="t";this.PaintSelection(a,-1,-1,-1,-1,f);f&&this.SetSelection(a,-1,-1,-1,-1)};this.GetSpanCell=function(e,d,b){if(b==null)return null;for(var g=b.length,c=0;c<g;c++){var a=b[c],f=a.row<=e&&e<a.row+a.rowCount&&a.col<=d&&d<a.col+a.colCount;if(f)return a}return null};this.IsCovered=function(e,c,b,d){var a=this.GetSpanCell(c,b,d);return a==null?false:a.row==c&&a.col==b?false:true};this.IsSpanCell=function(f,h,g){for(var c=f.spanCells,e=c.length,b=0;b<e;b++){var a=c[b],d=a.row==h&&a.col==g;if(d)return a}return null};this.SelectRange=function(a,f,e,d,c,b){a.selectType="";this.UpdateRangeSelection(a,f,e,d,c,b);if(b){this.SetSelection(a,f,e,d,c);this.PaintAnchorCell(a)}};this.UpdateRangeSelection=function(a,g,f,e,d,b){var c=this.GetViewport(a);this.UpdateRangeSelection(a,g,f,e,d,b,c)};this.GetSpanCells=function(a,b){return b==this.GetViewport(a)?a.spanCells:b==this.GetColHeader(a)?a.colSpanCells:b==this.GetColFooter(a)?a.footerSpanCells:b==this.GetRowHeader(a)?a.rowSpanCells:null};this.UpdateRangeSelection=function(c,g,f,j,i,h,b){if(b==null)return;for(var a=g;a<g+j&&a<b.rows.length;a++){if(this.IsChildSpreadRow(c,b,a))continue;for(var d=this.GetCellIndex(c,a,f,this.GetSpanCells(c,b)),e=0;e<i;e++){if(this.IsCovered(c,a,f+e,this.GetSpanCells(c,b)))continue;d<b.rows[a].cells.length&&this.PaintSelectedCell(c,b.rows[a].cells[d],h);d++}}};this.GetColFromCell=function(b,a){if(a==null)return-1;var c=this.GetRowFromCell(b,a);return this.GetColIndex(b,c,a.cellIndex,this.GetSpanCells(b,a.parentNode.parentNode.parentNode),false,this.IsChild(a,this.GetRowHeader(b)))};this.GetRowFromCell=function(c,a){if(a==null||a.parentNode==null)return-1;var b=a.parentNode.rowIndex;return b};this.GetColIndex=function(a,l,f,i,m,k){var e=false,j=this.GetViewport(a);if(j!=null)e=j.parentNode.getAttribute("hiddenCells");if(e&&i==a.spanCells)return f;var g=0,c=this.GetColCount(a),h=0;if(k){h=0;var d=null;if(this.GetRowHeader(a)!=null)d=this.GetColGroup(this.GetRowHeader(a));if(d!=null)c=d.childNodes.length}for(var b=h;b<c;b++){if(this.IsCovered(a,l,b,i))continue;if(g==f)return b;g++}return c};this.GetCellIndex=function(a,j,d,f){var c=false,g=this.GetViewport(a);if(g!=null)c=g.parentNode.getAttribute("hiddenCells");if(c&&f==a.spanCells)return d;else{for(var i=0,h=d,e=0,b=0;b<h;b++){if(this.IsCovered(a,j,i+b,f))continue;e++}return e}};this.PaintSelections=function(b,f){var k=this.GetData(b),l=k.getElementsByTagName("root")[0],n=l.getElementsByTagName("state")[0],h=n.getElementsByTagName("selection")[0],a=h.firstChild;while(a!=null){var d=0,c=0;if(b.getAttribute("LayoutMode")&&a.getAttribute("row")!="-1"&&a.getAttribute("col")!="-1"){var e=this.GetCellByRowCol2(b,a.getAttribute("row"),a.getAttribute("col"));if(e){d=this.GetRowFromCell(b,e);c=this.GetColFromCell(b,e)}}else if(b.getAttribute("LayoutMode")&&a.getAttribute("col")!="-1"&&a.getAttribute("row")=="-1"&&a.getAttribute("rowcount")=="-1"){var m=this.GetRowTemplateRowFromGroupCell(b,parseInt(a.getAttribute("col"))),e=this.GetCellByRowCol2(b,m,parseInt(a.getAttribute("col")));if(e){d=parseInt(e.parentNode.getAttribute("row"));c=this.GetColFromCell(b,e)}}else{d=this.GetRowByKey(b,a.getAttribute("row"));c=this.GetColByKey(b,a.getAttribute("col"))}var g=parseInt(a.getAttribute("rowcount")),i=parseInt(a.getAttribute("colcount"));a.setAttribute("rowIndex",d);a.setAttribute("colIndex",c);if(b.getAttribute("LayoutMode")&&a.getAttribute("col")>=0&&a.getAttribute("row")>=0&&(a.getAttribute("rowcount")>=1||a.getAttribute("colcount")>=1)){var j=a.nextSibling;(parseInt(a.getAttribute("row"))!=parseInt(activeRow.innerHTML)||parseInt(a.getAttribute("col"))!=parseInt(activeCol.innerHTML))&&h.removeChild(a);a=j;continue}if(b.getAttribute("LayoutMode")&&a.getAttribute("col")=="-1"&&a.getAttribute("row")!=-1)g=parseInt(b.getAttribute("layoutrowcount"));if(b.getAttribute("LayoutMode")&&a.getAttribute("col")!="-1"&&a.getAttribute("row")=="-1"&&a.getAttribute("rowcount")=="-1")this.PaintMultipleRowSelection(b,d,c,1,1,f);else if(this.GetOperationMode(b)=="Normal"&&this.GetSelectionPolicy(b)=="MultiRange")this.paintSelection2(b,d,c,g,i,f);else this.PaintSelection(b,d,c,g,i,f);a=a.nextSibling}};this.NextCell=function(a,l,h){if(l.altKey)return;var c=this.GetParent(this.GetViewport(a));if(a.anchorCell==null){var t=this.FireActiveCellChangingEvent(a,0,0);if(!t){a.SetActiveCell(0,0);var g=this.CreateEvent("ActiveCellChanged");g.cmdID=a.id;g.row=g.Row=0;g.col=g.Col=0;this.FireEvent(a,g)}return}if(l.shiftKey&&h!=this.tab){var n=this.GetOperationMode(a);if(n=="RowMode"||n=="SingleSelect"||n=="MultiSelect"||n=="Normal"&&this.GetSelectionPolicy(a)=="Single")return;var d=this.GetSpanCell(a.leadingCellRow,a.leadingCellCol,this.GetSpanCells(a,this.GetViewportFromCell(a,a.anchorCell)));switch(h){case this.right:var b=a.leadingCellRow,f=a.leadingCellCol+1;if(d!=null)f=d.col+d.colCount;if(f>this.GetColCount(a)-1)return;a.leadingCellCol=f;a.leadingCell=this.GetCellFromRowCol(a,b,f);this.Select(a,a.anchorCell,a.leadingCell);break;case this.left:var b=a.leadingCellRow,f=a.leadingCellCol-1;if(d!=null)f=d.col-1;d=this.GetSpanCell(b,f,this.GetSpanCells(a,this.GetViewportFromCell(a,a.anchorCell)));if(d!=null)if(this.IsSpanCell(a,b,d.col))f=d.col;if(f<0)return;a.leadingCellCol=f;a.leadingCell=this.GetCellFromRowCol(a,b,f);this.Select(a,a.anchorCell,a.leadingCell);break;case this.down:var b=a.leadingCellRow+1,f=a.leadingCellCol;if(d!=null)b=d.row+d.rowCount;b=this.GetNextRow(a,b);if(b>this.GetRowCountInternal(a)-1)return;a.leadingCellRow=b;a.leadingCell=this.GetCellFromRowCol(a,b,f);this.Select(a,a.anchorCell,a.leadingCell);this.PaintSelections(a,true);break;case this.up:var b=a.leadingCellRow-1,f=a.leadingCellCol;if(d!=null)b=d.row-1;b=this.GetPrevRow(a,b);d=this.GetSpanCell(b,f,this.GetSpanCells(a,this.GetViewportFromCell(a,a.anchorCell)));if(d!=null)if(this.IsSpanCell(a,d.row,f))b=d.row;if(b<0)return;a.leadingCellRow=b;a.leadingCell=this.GetCellFromRowCol(a,b,f);this.Select(a,a.anchorCell,a.leadingCell);this.PaintSelections(a,true);break;case this.home:if(a.anchorCell.parentNode.rowIndex>=0){a.leadingCellCol=0;a.leadingCell=this.GetCellFromRowCol(a,a.leadingCellRow,a.leadingCellCol);this.Select(a,a.anchorCell,a.leadingCell)}break;case this.end:if(a.anchorCell.parentNode.rowIndex>=0){a.leadingCellCol=this.GetColCount(a)-1;a.leadingCell=this.GetCellFromRowCol(a,a.leadingCellRow,a.leadingCellCol);this.Select(a,a.anchorCell,a.leadingCell)}break;case this.pdn:if(this.GetViewport(a)!=null&&a.anchorCell.parentNode.rowIndex>=0){b=0;for(b=0;b<this.GetViewport(a).rows.length;b++)if(this.GetViewport(a).rows[b].offsetTop+this.GetViewport(a).rows[b].offsetHeight>this.GetViewport(a).parentNode.offsetHeight+this.GetViewport(a).parentNode.scrollTop)break;b=this.GetNextRow(a,b);if(b<this.GetViewport(a).rows.length){this.GetViewport(a).parentNode.scrollTop=this.GetViewport(a).rows[b].offsetTop;a.leadingCellRow=b}else{b=this.GetRowCountInternal(a)-1;a.leadingCellRow=b}a.leadingCell=this.GetCellFromRowCol(a,a.leadingCellRow,a.leadingCellCol);this.Select(a,a.anchorCell,a.leadingCell)}break;case this.pup:if(this.GetViewport(a)!=null&&a.anchorCell.parentNode.rowIndex>0){b=0;for(b=0;b<this.GetViewport(a).rows.length;b++)if(this.GetViewport(a).rows[b].offsetTop+this.GetViewport(a).rows[b].offsetHeight>this.GetViewport(a).parentNode.scrollTop)break;if(b<this.GetViewport(a).rows.length){var o=0;while(b>0){o+=this.GetViewport(a).rows[b].offsetHeight;if(o>this.GetViewport(a).parentNode.offsetHeight)break;b--}b=this.GetPrevRow(a,b);if(b>=0){this.GetViewport(a).parentNode.scrollTop=this.GetViewport(a).rows[b].offsetTop;a.leadingCellRow=b;a.leadingCell=this.GetCellFromRowCol(a,a.leadingCellRow,a.leadingCellCol);this.Select(a,a.anchorCell,a.leadingCell)}}}}this.SyncColSelection(a)}else{var q=h==this.tab;if(h==this.tab)if(l.shiftKey)h=this.left;else h=this.right;var s=a.anchorCell,b=a.leadingCellRow,f=a.leadingCellCol;switch(h){case this.right:this.MoveRight(a,b,f,q);break;case this.left:this.MoveLeft(a,b,f,q);break;case this.down:this.MoveDown(a,b,f,false,false,true);break;case this.up:this.MoveUp(a,b,f,false,false,true);break;case this.home:a.anchorCell.parentNode.rowIndex>=0&&this.MoveRight(a,b,-1,false);break;case this.end:a.anchorCell.parentNode.rowIndex>=0&&this.MoveLeft(a,b,this.GetColCount(a),false);break;case this.pdn:if(this.GetViewport(a)!=null&&a.anchorCell.parentNode.rowIndex>=0){var j=0;if(a.virtualPaging=="true"){var p=document.getElementById(a.id+"_VirtualPaging_Top");j=p.offsetHeight}b=0;for(b=0;b<this.GetViewport(a).rows.length;b++)if(this.GetViewport(a).rows[b].offsetTop+this.GetViewport(a).rows[b].offsetHeight>this.GetViewport(a).parentNode.offsetHeight+this.GetViewport(a).parentNode.scrollTop-j)break;b=this.GetNextRow(a,b);if(b<this.GetViewport(a).rows.length){var r=this.GetViewport(a).rows[b].offsetTop+j;this.UpdateLeadingCell(a,b,a.leadingCellCol);this.GetViewport(a).parentNode.scrollTop=r}else{b=this.GetPrevRow(a,this.GetRowCount(a)-1);this.UpdateLeadingCell(a,b,a.leadingCellCol)}}break;case this.pup:if(this.GetViewport(a)!=null&&a.anchorCell.parentNode.rowIndex>=0){var j=0;if(a.virtualPaging=="true"){var p=document.getElementById(a.id+"_VirtualPaging_Top");j=p.offsetHeight}b=0;for(b=0;b<this.GetViewport(a).rows.length;b++)if(this.GetViewport(a).rows[b].offsetTop+this.GetViewport(a).rows[b].offsetHeight>this.GetViewport(a).parentNode.scrollTop-j)break;if(b<this.GetViewport(a).rows.length){var o=0;while(b>=0){o+=this.GetViewport(a).rows[b].offsetHeight;if(o>this.GetViewport(a).parentNode.offsetHeight)break;b--}b=this.GetPrevRow(a,b);if(b>=0){var r=this.GetViewport(a).rows[b].offsetTop+j;this.UpdateLeadingCell(a,b,a.leadingCellCol);this.GetViewport(a).parentNode.scrollTop=r}}}}if(s!=a.anchorCell){var g=this.CreateEvent("ActiveCellChanged");g.cmdID=a.id;g.Row=g.row=this.GetSheetIndex(a,this.GetRowFromCell(a,a.anchorCell));g.Col=g.col=this.GetColFromCell(a,a.anchorCell);if(a.getAttribute("LayoutMode"))g.InnerRow=g.innerRow=a.anchorCell.parentNode.getAttribute("row");this.FireEvent(a,g)}}var e=this.GetCellFromRowCol(a,a.leadingCellRow,a.leadingCellCol);if(h==this.left)if(e.offsetLeft<c.scrollLeft)if(e.cellIndex>0)c.scrollLeft=a.anchorCell.offsetLeft;else c.scrollLeft=0;else if(e.offsetLeft>=c.scrollLeft+c.clientWidth)c.scrollLeft=a.anchorCell.offsetLeft+a.anchorCell.offsetWidth-c.clientWidth;if(h==this.right)if(e.offsetLeft+e.offsetWidth>c.scrollLeft+c.clientWidth)c.scrollLeft=a.anchorCell.offsetLeft+a.anchorCell.offsetWidth-c.clientWidth;else if(e.offsetLeft<c.scrollLeft)if(e.cellIndex>0)c.scrollLeft=a.anchorCell.offsetLeft;else c.scrollLeft=0;if((h==this.up||h==this.left)&&this.IsChild(e,c))if(e.parentNode.rowIndex>0){var m=e.parentNode.offsetTop-(c.scrollTop-a.virtualTop),k=m+e.parentNode.offsetHeight;if(k>c.clientHeight)c.scrollTop=c.scrollTop+k-c.clientHeight;else if(m<0)c.scrollTop=c.scrollTop-(c.scrollTop-a.virtualTop-e.parentNode.offsetTop)}else c.scrollTop=a.virtualTop;if((h==this.down||h==this.right)&&this.IsChild(e,c)){var m=e.parentNode.offsetTop-(c.scrollTop-a.virtualTop),k=m+e.parentNode.offsetHeight;if(e.parentNode.rowIndex<=e.parentNode.parentNode.rows.length-1)if(k>c.clientHeight)c.scrollTop=c.scrollTop+k-c.clientHeight;else if(m<0)c.scrollTop=c.scrollTop-(c.scrollTop-a.virtualTop-e.parentNode.offsetTop)}a.virtualPaging!="true"&&this.ScrollView(a);this.EnableButtons(a);this.SaveData(a);if(a.anchorCell!=null){var i=this.GetEditor(a.anchorCell);if(i!=null){if(this.isEditModeReplace(a,a.anchorCell)&&i.select){i.select();this.CancelDefault(l)}if(!i.disabled&&(i.type==null||i.type=="checkbox"||i.type=="radio"||i.type=="text"||i.type=="password")){this.editing=true;this.editor=i;this.editingValue=this.GetEditorValue(i,a)}}}this.Focus(a)};this.MoveUp=function(a,b,c,e){if(b==0&&!e)return;var d=this.GetRowCountInternal(a),f=this.GetColCount(a);b--;b=this.GetPrevRow2(a,b,a.leadingCellCol,true,true);if(b<0&&e)if(c==0){b=this.GetPrevCellRowIndex(a,d-1,f-1,true,true);c=this.GetPrevCellColIndex(a,d-1,f-1,true,true)}else{b=this.GetPrevCellRowIndex(a,d-1,c-1,true,true);c=this.GetPrevCellColIndex(a,d-1,c-1,true,true)}if(b>=0){a.leadingCellRow=b;a.leadingCellCol=c;this.UpdateLeadingCell(a,a.leadingCellRow,a.leadingCellCol)}};this.GetPrevCol=function(b,f,e,h,g){var c=null,a=e,j=this.GetColCount(b);while(a>=0){var d=this.GetSpanCell(f,e,this.GetSpanCells(b,this.GetViewportFromCell(b,b.anchorCell)));if(d!=null)a=d.col-1;else a--;c=this.GetCellFromRowCol(b,f,a);if(c==null)break;var i=h&&c.getAttribute("TabStop")=="false"||g&&c.getAttribute("canFocus")=="false";if(!i)break}return a};this.MoveDown=function(a,b,c,f){var e=this.GetRowCountInternal(a),g=this.GetColCount(a),d=this.GetSpanCell(b,c,this.GetSpanCells(a,this.GetViewportFromCell(a,a.anchorCell)));if(d!=null)b=d.row+d.rowCount;else b++;b=this.GetNextRow2(a,b,c,true,true);if(b==e)if(f)if(c==g-1){b=this.GetNextCellRowIndex(a,0,0,true,true);c=this.GetNextCellColIndex(a,0,0,true,true)}else{b=this.GetNextCellRowIndex(a,0,c+1,true,true);c=this.GetNextCellColIndex(a,0,c+1,true,true)}else b=e-1;if(b<e){a.leadingCellRow=b;a.leadingCellCol=c;this.UpdateLeadingCell(a,a.leadingCellRow,a.leadingCellCol)}};this.MoveLeft=function(a,b,c,d){var g=b,i=this.GetRowCountInternal(a),h=this.GetColCount(a);if(typeof d=="undefined")d=true;c=this.GetPrevCol(a,b,c,d,true);if(c<0){c=h-1;b--;if(b<0)b=i-1;b=this.GetPrevRow(a,b);a.leadingCellRow=b}var e=this.GetCellFromRowCol(a,a.leadingCellRow,c);if(a.anchorCell!=e&&(d&&e.getAttribute("TabStop")=="false"||e.getAttribute("canFocus")=="false"))this.MoveLeft(a,a.leadingCellRow,c,d);else{var f=this.UpdateLeadingCell(a,a.leadingCellRow,c);if(f)a.leadingCellRow=g}};this.MoveRight=function(b,c,g,e){var f=c,a=this.moveRightInternal(b,c,g,e);if(a!=null){var d=this.UpdateLeadingCell(b,a.row,a.col);if(d)b.leadingCellRow=f}};this.moveRightInternal=function(c,a,b,d){var i=this.GetRowCountInternal(c),h=this.GetColCount(c);if(i==0||h==0)return null;var g=a>-1&&a<i?a:-1,f=b>-1&&b<h?b:-1,j=-1;if(typeof d=="undefined")d=true;do{b=this.GetNextCol(c,a,b,d,true);if(b>=h){b=0;a++;if(a>=i)a=0;a=this.GetNextRow(c,a);c.leadingCellRow=a}if(g<0||f<0){g=a;f=b}var e=this.GetCellFromRowCol(c,a,b);if(e!=null&&e.getAttribute("canFocus")!="false"&&!(d&&e.getAttribute("TabStop")=="false"))return{row:a,col:b};j++}while(j==0||g!=a||f!=b);return null};this.GetPrevCellRowIndex=function(c,h,d,f,e){for(var b=h,i=this.GetColCount(c),g=this.GetRowCount(c),a=d,a=d;a>=0;a--){if(a==d)b=this.GetPrevRow2(c,h,a,f,e);else b=this.GetPrevRow2(c,g-1,a,f,e);if(b>=0)break}if(b<0)for(a=i-1;a>d;a--){b=this.GetPrevRow2(c,g-1,a,f,e);if(b>=0)break}return b};this.GetPrevCellColIndex=function(c,h,d,f,e){for(var b=h,i=this.GetColCount(c),g=this.GetRowCount(c),a=d,a=d;a>=0;a--){if(a==d)b=this.GetPrevRow2(c,h,a,f,e);else b=this.GetPrevRow2(c,g-1,a,f,e);if(b>=0)break}if(b<0)for(a=i-1;a>d;a--){b=this.GetPrevRow2(c,g-1,a,f,e);if(b>=0)break}return a};this.GetNextCellRowIndex=function(c,h,g,e,d){for(var b=h,i=this.GetColCount(c),f=this.GetRowCount(c),a=0,a=g;a<i;a++){if(a==g)b=this.GetNextRow2(c,h,a,e,d);else b=this.GetNextRow2(c,0,a,e,d);if(b<f)break}if(b==f)for(a=0;a<g;a++){b=this.GetNextRow2(c,0,a,e,d);if(b<f)break}return b};this.GetNextCellColIndex=function(c,h,g,e,d){for(var b=h,i=this.GetColCount(c),f=this.GetRowCount(c),a=0,a=g;a<i;a++){if(a==g)b=this.GetNextRow2(c,h,a,e,d);else b=this.GetNextRow2(c,0,a,e,d);if(b<f)break}if(b==f)for(a=0;a<g;a++){b=this.GetNextRow2(c,0,a,e,d);if(b<f)break}return a};this.GetPrevCol=function(b,f,e,h,g){var c=null,a=e,j=this.GetColCount(b);while(a>=0){var d=this.GetSpanCell(f,e,this.GetSpanCells(b,this.GetViewportFromCell(b,b.anchorCell)));if(d!=null)a=d.col-1;else a--;c=this.GetCellFromRowCol(b,f,a);if(c==null)break;var i=h&&c.getAttribute("TabStop")=="false"||g&&c.getAttribute("canFocus")=="false";if(!i)break}return a};this.GetNextCol=function(b,e,i,g,f){var c=null,a=i,h=this.GetColCount(b);while(a<h){var d=this.GetSpanCell(e,a,this.GetSpanCells(b,this.GetViewportFromCell(b,b.anchorCell)));if(d!=null)a=d.col+d.colCount;else a++;c=this.GetCellFromRowCol(b,e,a);if(c==null)break;var j=g&&c.getAttribute("TabStop")=="false"||f&&c.getAttribute("canFocus")=="false";if(!j)break}return a};this.UpdateLeadingCell=function(a,c,b){var d=0;if(a.getAttribute("LayoutMode")){d=this.GetRowFromViewPort(a,c,b);a.anchorCell=this.GetCellFromRowCol(a,c,b);var e=this.GetCellFromRowCol(a,d,b);if(e)d=e.parentNode.getAttribute("row")}var f=this.FireActiveCellChangingEvent(a,c,b,d);if(!f){var g=this.GetOperationMode(a);g!="MultiSelect"&&this.ClearSelection(a);a.leadingCellCol=b;a.leadingCellRow=c;a.selectStartCol=b;a.selectStartRow=c;this.UpdateAnchorCell(a,c,b)}return f};this.GetNextRow=function(c,a){var b=this.GetViewport(c);while(b!=null&&a<b.rows.length)if(this.IsChildSpreadRow(c,b,a))a++;else break;if(b!=null&&a>=0&&a<b.rows.length)if(b.rows[a].getAttribute("previewrow"))a++;return a};this.GetPrevRow=function(c,a){if(a<0)return 0;var b=this.GetViewport(c);if(b!=null)while(a>0&&b.rows[a].cells.length>0)if(this.IsChildSpreadRow(c,b,a))a--;else break;if(b!=null&&a>=0&&a<b.rows.length)if(b.rows[a].getAttribute("previewrow"))a--;return a};this.GetPrevRow2=function(b,h,f,e,d){var c=null,a=h,i=this.GetRowCountInternal(b);while(a>=0){a=this.GetPrevRow(b,a);c=this.GetCellFromRowCol(b,a,f);var g=e&&c.getAttribute("TabStop")=="false"||d&&c.getAttribute("canFocus")=="false";if(!g)break;a=a-1}return a};this.GetNextRow2=function(b,i,g,e,d){var c=null,a=i,f=this.GetRowCountInternal(b);while(a<f){a=this.GetNextRow(b,a);c=this.GetCellFromRowCol(b,a,g);var h=e&&c.getAttribute("TabStop")=="false"||d&&c.getAttribute("canFocus")=="false";if(!h)break;a=a+1}return a};this.FireActiveCellChangingEvent=function(b,e,d,c){var a=this.CreateEvent("ActiveCellChanging");a.cancel=false;a.cmdID=b.id;a.row=this.GetSheetIndex(b,e);a.col=d;if(b.getAttribute("LayoutMode"))a.innerRow=c;this.FireEvent(b,a);return a.cancel};this.FireActiveCellChangedEvent=function(b,d,c){var a=this.CreateEvent("ActiveCellChanged");a.cmdID=b.id;a.row=this.GetSheetIndex(b,d);a.col=c;this.FireEvent(b,a)};this.GetSheetRowIndex=function(b,a){a=this.GetDisplayIndex(b,a);if(a<0)return-1;var c=this.GetViewport(b).rows[a];return c!=null?c.getAttribute("FpKey"):-1};this.GetSheetColIndex=function(a,d){var b=-1;if(a.getAttribute("LayoutMode")){var e=this.GetDisplayIndex2(a,innerRow),c=this.GetCellByRowCol(a,e,d);if(c!=null)b=parseInt(c.getAttribute("col"))}else b=a.GetColKeyFromCol(d);return b};this.GetCellByRowCol=function(b,a,c){a=this.GetDisplayIndex(b,a);return this.GetCellFromRowCol(b,a,c)};this.GetHeaderCellFromRowCol=function(a,c,d,g){if(c<0||d<0)return null;var b=null;if(g)b=this.GetColHeader(a);else b=this.GetRowHeader(a);var e=this.GetSpanCell(c,d,this.GetSpanCells(a,b));if(e!=null){c=e.row;d=e.col}var f=this.GetCellIndex(a,c,d,this.GetSpanCells(a,b));return b.rows[c].cells[f]};this.GetCellFromRowCol=function(g,a,d,c){if(a<0||d<0)return null;var b=null;b=this.GetViewport(g);var i=g.spanCells,f=this.GetSpanCell(a,d,i);if(f!=null){a=f.row;d=f.col}var e=0,h=false;if(b!=null)h=b.parentNode.getAttribute("hiddenCells");if(c!=null&&!h){if(c.cellIndex<c.parentNode.cells.length-1)e=c.cellIndex+1}else e=this.GetCellIndex(g,a,d,i);return a>=0&&a<b.rows.length?b.rows[a].cells[e]:null};this.GetHiddenValue=function(e,a,c){if(c==null)return;a=this.GetDisplayIndex(e,a);var d=null,b=null;b=this.GetViewport(e);if(b!=null&&a>=0&&a<b.rows.length){var f=b.rows[a];d=f.getAttribute("hv"+c)}return d};this.GetValue=function(a,b,f){b=this.GetDisplayIndex(a,b);var c=this.GetCellFromRowCol(a,b,f),e=this.GetRender(c),d=this.GetValueFromRender(a,e);return d==" "&&c.getAttribute("whiteSpace")==null?"":d};this.SetValue=function(b,d,g,a,e,f){d=this.GetDisplayIndex(b,d);if(a!=null&&typeof a!="string")a=new String(a);var c=this.GetCellFromRowCol(b,d,g);if(this.ValidateCell(b,c,a)){this.SetCellValueFromView(c,a);if(a!=null)this.SetCellValue(b,c,""+a,e,f);else this.SetCellValue(b,c,"",e,f);this.SizeSpread(b)}else if(b.getAttribute("lcidMsg")!=null)alert(b.getAttribute("lcidMsg"));else alert("Can't set the data into the cell. The data type is not correct for the cell.")};this.SetActiveCell=function(a,b,c){if(c<a.GetColCount()&&c>0&&b<a.GetRowCount()&&b>0){var e=this.FireActiveCellChangingEvent(a,b,c);if(e)return}var d=a.anchorCell;this.ClearSelection(a,true);b=this.GetDisplayIndex(a,b);this.UpdateAnchorCell(a,b,c);this.ResetLeadingCell(a);a.anchorCell!=d&&this.FireActiveCellChangedEvent(a,b,c)};this.GetOperationMode=function(b){return b.getAttribute("OperationMode")};this.SetOperationMode=function(b,a){b.setAttribute("OperationMode",a)};this.GetEnableRowEditTemplate=function(b){return b.getAttribute("EnableRowEditTemplate")};this.GetSelectionPolicy=function(b){return b.getAttribute("SelectionPolicy")};this.UpdateAnchorCell=function(a,c,d,e){if(c<0||d<0)return;a.anchorCell=this.GetCellFromRowCol(a,c,d);if(a.anchorCell==null)return;this.SetActiveRow(a,this.GetRowKeyFromCell(a,a.anchorCell));this.SetActiveCol(a,this.GetColKeyFromCell(a,a.anchorCell));if(e==null||e){var b=this.GetOperationMode(a);if(b=="RowMode"||b=="SingleSelect"||b=="ExtendedSelect")this.SelectRow(a,c,1,true,true);else if(b!="MultiSelect")this.SelectRange(a,c,d,1,1,true);else this.PaintFocusRect(a)}};this.ResetLeadingCell=function(a){if(a.anchorCell==null||!this.IsChild(a.anchorCell,a))return;a.leadingCellRow=this.GetRowFromCell(a,a.anchorCell);a.leadingCellCol=this.GetColFromCell(a,a.anchorCell);this.SelectRange(a.leadingCellRow,a.leadingCellCol,1,1,true)};this.Edit=function(a,b){var e=this.GetOperationMode(a);if(e!="RowMode")return;var c=a.getAttribute("name"),d=a.getAttribute("ajax")!="false";if(d){FarPoint&&FarPoint.System.WebControl.MultiColumnComboBoxCellTypeUtilitis&&FarPoint.System.WebControl.MultiColumnComboBoxCellTypeUtilitis.CloseAll();this.SyncData(c,"Edit,"+b,a)}else __doPostBack(c,"Edit,"+b)};this.Update=function(a){if(this.editing&&this.GetOperationMode(a)!="RowMode"&&this.GetEnableRowEditTemplate(a)!="true")return;this.SaveData(a);var b=a.getAttribute("name");__doPostBack(b,"Update")};this.Cancel=function(a){var d=document.getElementById(a.id+"_data");d.value="";this.SaveData(a);var b=a.getAttribute("name"),c=a.getAttribute("ajax")!="false";if(c)this.SyncData(b,"Cancel",a);else __doPostBack(b,"Cancel")};this.Add=function(b){if(this.editing)return;var a=null,c=this.GetPageActiveSpread();if(c!=null)a=c.getAttribute("name");else a=b.getAttribute("name");var d=b.getAttribute("ajax")!="false";if(d)this.SyncData(a,"Add",b);else __doPostBack(a,"Add")};this.Insert=function(b){if(this.editing)return;var a=null,c=this.GetPageActiveSpread();if(c!=null)a=c.getAttribute("name");else a=b.getAttribute("name");var d=b.getAttribute("ajax")!="false";if(d)this.SyncData(a,"Insert",b);else __doPostBack(a,"Insert")};this.Delete=function(b){if(this.editing)return;var a=null,c=this.GetPageActiveSpread();if(c!=null)a=c.getAttribute("name");else a=b.getAttribute("name");var d=b.getAttribute("ajax")!="false";if(d)this.SyncData(a,"Delete",b);else __doPostBack(a,"Delete")};this.Print=function(d){if(this.editing)return;this.SaveData(d);if(document.printSpread==null){var a=document.createElement("IFRAME");a.name="printSpread";a.style.position="absolute";a.style.left="-10px";a.style.width="0px";a.style.height="0px";document.printSpread=a;document.body.insertBefore(a,null);a.addEventListener("load",function(){the_fpSpread.PrintSpread()},false)}var c=document.getElementsByTagName("FORM");if(c!=null&&c.length>0){var b=c[0];b.__EVENTTARGET.value=d.getAttribute("name");b.__EVENTARGUMENT.value="Print";var e=b.target;b.target="printSpread";b.submit();b.target=e}};this.PrintSpread=function(){document.printSpread.focus();document.printSpread.print();window.focus();var a=this.GetPageActiveSpread();a!=null&&this.Focus(a)};this.PrintPDF=function(c){if(this.editing)return;this.SaveData(c);var a=document.getElementsByTagName("FORM");if(a!=null&&a.length>0){var b=a[0];b.__EVENTTARGET.value=c.getAttribute("name");b.__EVENTARGUMENT.value="PrintPDF";b.submit()}};this.GotoPage=function(a,c,d){if(this.editing)return;if(a.dirty){this.SaveData(a);a.dirty=false}var b=a.getAttribute("name"),e=a.getAttribute("ajax")!="false";if(e)this.SyncData(b,"Page,"+c,a,d);else __doPostBack(b,"Page,"+c)};this.ScrollToPage=function(a,c,h,f){if(this.editing)return;if(a.dirty){this.SaveData(a);a.dirty=false}var d=h?"ScrollUpToPage":"ScrollDownToPage",e=a.getAttribute("name"),b=this.GetCurrentPageIndex(a),g=a.getAttribute("ajax")!="false";if(g)this.SyncData(e,d+","+c+","+b,a,f);else __doPostBack(e,d+","+c+","+b)};this.Next=function(a){if(this.editing)return;var b=a.getAttribute("name"),c=a.getAttribute("ajax")!="false";if(c)this.SyncData(b,"Next",a);else __doPostBack(b,"Next")};this.Prev=function(a){if(this.editing)return;var b=a.getAttribute("name"),c=a.getAttribute("ajax")!="false";if(c)this.SyncData(b,"Prev",a);else __doPostBack(b,"Prev")};this.GetViewportFromCell=function(c,b){if(b!=null){var a=b;while(a!=null){if(a.tagName=="TABLE")break;a=a.parentNode}if(a==this.GetViewport(c))return a}return null};this.IsChild=function(c,b){if(c==null||b==null)return false;var a=c.parentNode;while(a!=null){if(a==b)return true;a=a.parentNode}return false};this.GetCorner=function(a){return a.corner};this.Select=function(b,i,g){if(this.GetSpread(i)!=b||this.GetSpread(g)!=b)return;if(this.InRowHeader(b,i)||this.InRowHeader(b,g))if((b.selectionBlockOptions&SelectionBlockOptions.Rows)==0&&b.selectType!="r")return;if(this.InColHeader(b,i)||this.InColHeader(b,g))if((b.selectionBlockOptions&SelectionBlockOptions.Columns)==0&&b.selectType!="c")return;if(!this.IsHeaderCell(b,i)&&!this.IsHeaderCell(b,g))if((b.selectionBlockOptions&SelectionBlockOptions.Cells)==0&&b.selectType=="")return;var f=b.selectStartRow,e=b.selectStartCol,d=this.GetRowFromCell(b,g),c=0;if(b.selectType=="r"){c=-1;if(this.IsChild(g,this.GetColHeader(b)))d=0}else if(b.selectType=="c"){if(this.IsChild(g,this.GetRowHeader(b)))c=0;else c=this.GetColFromCell(b,g);d=-1}else if(this.IsChild(g,this.GetColHeader(b))){d=0;c=this.GetColFromCell(b,g)}else if(this.IsChild(g,this.GetRowHeader(b)))c=0;else c=this.GetColFromCell(b,g);if(b.selectType=="t")e=c=f=d=-1;var j=Math.max(f,d);f=Math.min(f,d);d=j;j=Math.max(e,c);e=Math.min(e,c);c=j;var a=null,k=this.GetSelection(b),h=k.lastChild;if(h!=null){var o=this.GetRowByKey(b,h.getAttribute("row")),n=this.GetColByKey(b,h.getAttribute("col")),m=parseInt(h.getAttribute("rowcount")),l=parseInt(h.getAttribute("colcount"));a=new this.Range;this.SetRange(a,"cell",o,n,m,l)}if(a!=null&&a.col==-1&&a.row==-1)return;if(a!=null&&a.col==-1&&a.row>=0)if(a.row>d||a.row+a.rowCount-1<f){this.PaintSelection(b,a.row,a.col,a.rowCount,a.colCount,false);this.PaintSelection(b,f,e,d-f+1,c-e+1,true)}else if(f>a.row){var j=f-a.row;this.PaintSelection(b,a.row,a.col,j,a.colCount,false);if(d<a.row+a.rowCount-1)this.PaintSelection(b,d,a.col,a.row+a.rowCount-d,a.colCount,false);else this.PaintSelection(b,a.row+a.rowCount,a.col,d-a.row-a.rowCount+1,a.colCount,true)}else{this.PaintSelection(b,f,a.col,a.row-f,a.colCount,true);if(d<a.row+a.rowCount-1)this.PaintSelection(b,d+1,a.col,a.row+a.rowCount-d-1,a.colCount,false);else this.PaintSelection(b,a.row+a.rowCount,a.col,d-a.row-a.rowCount+1,a.colCount,true)}else if(a!=null&&a.row==-1&&a.col>=0)if(a.col>c||a.col+a.colCount-1<e){this.PaintSelection(b,a.row,a.col,a.rowCount,a.colCount,false);this.PaintSelection(b,f,e,d-f+1,c-e+1,true)}else if(e>a.col){this.PaintSelection(b,a.row,a.col,a.rowCount,e-a.col,false);if(c<a.col+a.colCount-1)this.PaintSelection(b,a.row,c,a.rowCount,a.col+a.colCount-c,false);else this.PaintSelection(b,a.row,a.col+a.colCount,a.rowCount,c-a.col-a.colCount,true)}else{this.PaintSelection(b,a.row,e,a.rowCount,a.col-e,true);if(c<a.col+a.colCount-1)this.PaintSelection(b,a.row,c+1,a.rowCount,a.col+a.colCount-c-1,false);else this.PaintSelection(b,a.row,a.col+a.colCount,a.rowCount,c-a.col-a.colCount+1,true)}else if(a!=null&&a.row>=0&&a.col>=0)this.ExtendSelection(b,a,f,e,d-f+1,c-e+1);else this.PaintSelection(b,f,e,d-f+1,c-e+1,true);this.SetSelection(b,f,e,d-f+1,c-e+1,a==null)};this.ExtendSelection=function(d,a,c,b,h,g){var i=Math.max(a.col,b),f=Math.min(a.col+a.colCount-1,b+g-1),j=Math.max(a.row,c),e=Math.min(a.row+a.rowCount-1,c+h-1);a.row<j&&this.PaintSelection(d,a.row,a.col,j-a.row,a.colCount,false);a.col<i&&this.PaintSelection(d,a.row,a.col,a.rowCount,i-a.col,false);a.row+a.rowCount-1>e&&this.PaintSelection(d,e+1,a.col,a.row+a.rowCount-e-1,a.colCount,false);a.col+a.colCount-1>f&&this.PaintSelection(d,a.row,f+1,a.rowCount,a.col+a.colCount-f-1,false);c<j&&this.PaintSelection(d,c,b,j-c,g,true);b<i&&this.PaintSelection(d,c,b,h,i-b,true);c+h-1>e&&this.PaintSelection(d,e+1,b,c+h-e-1,g,true);b+g-1>f&&this.PaintSelection(d,c,f+1,h,b+g-f-1,true)};this.PaintAnchorCellHeader=function(a,e){var d,c;d=this.GetRowFromCell(a,a.anchorCell);c=this.GetColFromCell(a,a.anchorCell);if(e&&a.anchorCell.getAttribute("group")!=null){var f=this.GetSpanCell(d,c,a.spanCells);if(f!=null&&f.colCount>1){var b=this.GetSelectedRange(a);if(d<b.row||d>=b.row+b.rowCount||c<b.col||c>=b.col+b.colCount)return}}this.GetColHeader(a)!=null&&this.PaintHeaderSelection(a,d,c,1,1,e,true);this.GetRowHeader(a)!=null&&this.PaintHeaderSelection(a,d,c,1,1,e,false)};this.LineIntersection=function(c,e,d,f){var a,b;a=Math.max(c,d);b=Math.min(c+e,d+f);return a<b?{s:a,c:b-a}:null};this.RangeIntersection=function(i,g,e,c,j,h,f,d){var b=this.LineIntersection(i,e,j,f),a=this.LineIntersection(g,c,h,d);return b&&a?{row:b.s,col:a.s,rowCount:b.c,colCount:a.c}:null};this.paintSelection2=function(a,c,b,f,e,d){c<0&&b<0&&this.PaintCornerSelection(a,d);if(c<0){c=0;f=this.GetRowCountInternal(a)}if(b<0){b=0;e=this.GetColCount(a)}this.PaintViewportSelection(a,c,b,f,e,d);this.GetColHeader(a)!=null&&this.GetOperationMode(a)=="Normal"&&this.PaintHeaderSelection(a,c,b,f,e,d,true);this.GetRowHeader(a)!=null&&this.PaintHeaderSelection(a,c,b,f,e,d,false);this.PaintAnchorCell(a)};this.PaintSelection=function(a,c,b,e,d,f){c<0&&b<0&&this.PaintCornerSelection(a,f);var n=false,o=false;if(c<0){c=0;e=this.GetRowCountInternal(a)}if(b<0){b=0;d=this.GetColCount(a)}this.PaintViewportSelection(a,c,b,e,d,f);for(var p=this.GetSelection(a),h,l,k,j,i,m,g,q=p.childNodes.length-1;q>=0;q--){h=p.childNodes[q];if(h){l=parseInt(h.getAttribute("rowIndex"));k=parseInt(h.getAttribute("colIndex"));j=parseInt(h.getAttribute("rowcount"));i=parseInt(h.getAttribute("colcount"));if(l<0||j<0){l=0;j=this.GetRowCountInternal(a)}if(k<0||i<0){k=0;i=this.GetColCount(a)}if(q>=p.childNodes.length-1){if(c<=l&&e>=j)if(this.GetColHeader(a)!=null&&this.GetOperationMode(a)=="Normal"){this.PaintHeaderSelection(a,c,b,e,d,f,true);n=true}if(b<=k&&d>=i)if(this.GetRowHeader(a)!=null){this.PaintHeaderSelection(a,c,b,e,d,f,false);o=true}if(!n&&!o){if(this.GetColHeader(a)!=null&&this.GetOperationMode(a)=="Normal"){this.PaintHeaderSelection(a,c,b,e,d,f,true);n=true}if(this.GetRowHeader(a)!=null){this.PaintHeaderSelection(a,c,b,e,d,f,false);o=true}}}else if(!f&&this.GetOperationMode(a)=="Normal"){m=this.RangeIntersection(c,b,e,d,l,k,j,i);m&&this.PaintViewportSelection(a,m.row,m.col,m.rowCount,m.colCount,true);if(n){g=this.LineIntersection(b,d,k,i);g&&this.PaintHeaderSelection(a,c,g.s,e,g.c,true,true)}if(o){g=this.LineIntersection(c,e,l,j);g&&this.PaintHeaderSelection(a,g.s,b,g.c,d,true,false)}}}}if(p.childNodes.length<=0){this.GetColHeader(a)!=null&&this.GetOperationMode(a)=="Normal"&&this.PaintHeaderSelection(a,c,b,e,d,f,true);this.GetRowHeader(a)!=null&&this.PaintHeaderSelection(a,c,b,e,d,f,false)}this.PaintAnchorCell(a)};this.PaintFocusRect=function(b){if(!b.initialized)return;var c=document.getElementById(b.id+"_focusRectT");if(c==null)return;var a=this.GetSelectedRange(b);if(b.anchorCell==null&&(a==null||a.rowCount==0&&a.colCount==0)){c.style.left="-1000px";c.style.width="0px";var p=b.id;c=document.getElementById(p+"_focusRectB");c.style.left="-1000px";c.style.width="0px";c=document.getElementById(p+"_focusRectL");c.style.left="-1000px";c.style.width="0px";c=document.getElementById(p+"_focusRectR");c.style.left="-1000px";c.style.width="0px";return}var m=this.GetOperationMode(b);if(m=="RowMode"||m=="SingleSelect"||m=="MultiSelect"||m=="ExtendedSelect"){var j=b.GetActiveRow();a=new this.Range;this.SetRange(a,"Row",j,-1,1,-1)}else if(a==null||a.rowCount==0&&a.colCount==0){var j=b.GetActiveRow(),e=b.GetActiveCol();a=new this.Range;this.SetRange(a,"Cell",j,e,b.anchorCell.rowSpan,b.anchorCell.colSpan)}if(a.row<0){a.row=0;a.rowCount=this.GetRowCountInternal(b)}if(a.col<0){a.col=0;a.colCount=this.GetColCount(b)}var d=this.GetCellFromRowCol(b,a.row,a.col);if(d==null)return;if(a.rowCount==1&&a.colCount==1){a.rowCount=d.rowSpan;a.colCount=d.colSpan;if(d.colSpan>1&&!d.getAttribute("group")){var n=parseInt(d.getAttribute("col"));if(n!=a.col&&!isNaN(n))a.col=n}}var i=this.GetOffsetTop(b,d),f=this.GetOffsetLeft(b,d);if(d.rowSpan>1){a.row=d.parentNode.rowIndex;var k=this.GetCellFromRowCol(b,a.row,a.col+a.colCount-1);if(k!=null&&k.parentNode.rowIndex>d.parentNode.rowIndex)i=this.GetOffsetTop(b,k)}if(d.colSpan>1){var k=this.GetCellFromRowCol(b,a.row+a.rowCount-1,a.col),s=this.GetOffsetLeft(b,k);if(s>f){f=s;d=k}}for(var g=0,r=this.GetViewport(b).rows,j=a.row;j<a.row+a.rowCount&&j<r.length;j++){g+=r[j].offsetHeight;if(j>a.row)g+=parseInt(this.GetViewport(b).cellSpacing)}var h=0,l=this.GetColGroup(this.GetViewport(b));if(l.childNodes==null||l.childNodes.length==0)return;for(var e=a.col;e<a.col+a.colCount&&e<l.childNodes.length;e++){h+=parseInt(l.childNodes[e].width);if(e>a.col)h+=parseInt(this.GetViewport(b).cellSpacing)}if(a.col>d.cellIndex&&a.type=="Column"){var o=parseInt(d.getAttribute("col"));if(d.getAttribute("group"))o=d.cellIndex;for(var e=o;e<a.col;e++){f+=parseInt(l.childNodes[e].width);if(e>o)f+=parseInt(this.GetViewport(b).cellSpacing)}}if(a.row>0)i-=2;else g-=2;if(a.col>0)f-=2;else h-=2;if(parseInt(this.GetViewport(b).cellSpacing)>0){i+=1;f+=1}else{h+=1;g+=1}if(b.virtualPaging=="true"){var q=document.getElementById(b.id+"_VirtualPaging_Top");if(q)i+=q.offsetHeight}if(h<0)h=0;if(g<0)g=0;c.style.left=""+f+"px";c.style.top=""+i+"px";c.style.width=""+h+"px";c=document.getElementById(b.id+"_focusRectB");c.style.left=""+f+"px";c.style.top=""+(i+g)+"px";c.style.width=""+h+"px";c=document.getElementById(b.id+"_focusRectL");c.style.left=""+f+"px";c.style.top=""+i+"px";c.style.height=""+g+"px";c=document.getElementById(b.id+"_focusRectR");c.style.left=""+(f+h)+"px";c.style.top=""+i+"px";c.style.height=""+g+"px"};this.PaintCornerSelection=function(d,f){var e=true;if(d.getAttribute("ShowHeaderSelection")=="false")e=false;if(!e)return;var a=this.GetCorner(d);if(a!=null&&a.rows.length>0)for(var b=0;b<a.rows.length;b++)for(var c=0;c<a.rows[0].cells.length;c++)a.rows[b].cells[c]!=null&&this.PaintSelectedCell(d,a.rows[b].cells[c],f)};this.PaintHeaderSelection=function(a,f,e,m,l,n,d){var g=true;if(a.getAttribute("ShowHeaderSelection")=="false")g=false;if(!g)return;var k=this.GetRowCountInternal(a),j=this.GetColCount(a);if(d){if(this.GetColHeader(a)==null)return;f=0;m=k=this.GetColHeader(a).rows.length}else{if(this.GetRowHeader(a)==null)return;e=0;var h=this.GetColGroup(this.GetRowHeader(a));if(h==null)return;l=j=h.childNodes.length}for(var o=d?a.colSpanCells:a.rowSpanCells,b=f;b<f+m&&b<k;b++){if(!d&&this.IsChildSpreadRow(a,this.GetViewport(a),b))continue;for(var c=e;c<e+l&&c<j;c++){if(this.IsCovered(a,b,c,o))continue;var i=this.GetHeaderCellFromRowCol(a,b,c,d);i!=null&&this.PaintSelectedCell(a,i,n)}}};this.PaintViewportSelection=function(a,f,e,k,j,g){for(var i=this.GetRowCountInternal(a),h=this.GetColCount(a),b=f;b<f+k&&b<i;b++){if(this.IsChildSpreadRow(a,this.GetViewport(a),b))continue;for(var d=null,c=e;c<e+j&&c<h;c++){if(this.IsCovered(a,b,c,a.spanCells))continue;d=this.GetCellFromRowCol(a,b,c,d);this.PaintSelectedCell(a,d,g)}}};this.Copy=function(a){var i=this.GetPageActiveSpread();if(i!=null&&i!=a&&this.GetTopSpread(i)==a){this.Copy(i);return}if(this.GetEnableRowEditTemplate(a)=="true"&&this.GetOperationMode(a)=="RowMode")return;var o=this.GetSelection(a),g=o.lastChild;if(g!=null){var k=this.GetRowByKey(a,g.getAttribute("row")),f=this.GetColByKey(a,g.getAttribute("col")),n=parseInt(g.getAttribute("rowcount")),h=parseInt(g.getAttribute("colcount")),l=false;if(k<0){k=0;n=this.GetRowCountInternal(a);var j=this.CreateEvent("CopyData");j.spread=a;j.includeColHeader=false;this.FireEvent(a,j);l=j.includeColHeader}if(f<0){f=0;h=this.GetColCount(a)}var b="";if(l)for(var e=0;e<this.GetColHeader(a).rows.length;e++){for(var c=null,d=f;d<f+h;d++){if(this.IsCovered(a,e,d,a.colSpanCells))b+="";else{c=this.GetHeaderCellFromRowCol(a,e,d,true);var m=this.GetCellType(c);if(m=="TextCellType"&&c.getAttribute("password")!=null)b+="";else b+=this.GetCellValueFromView(a,c)}if(d+1<f+h)b+="\t"}b+="\r\n"}for(var e=k;e<k+n;e++){if(this.IsChildSpreadRow(a,this.GetViewport(a),e))continue;for(var c=null,d=f;d<f+h;d++){if(this.IsCovered(a,e,d,a.spanCells))b+="";else{c=this.GetCellFromRowCol(a,e,d,c);if(c!=null&&c.parentNode.getAttribute("previewrow")=="true")continue;var m=this.GetCellType(c);if(m=="TextCellType"&&c.getAttribute("password")!=null)b+="";else b+=this.GetCellValueFromView(a,c)}if(d+1<f+h)b+="\t"}b+="\r\n"}this.clipboardData=b}else if(a.anchorCell!=null){var b=this.GetCellValueFromView(a,a.anchorCell);this.clipboardData=b}};this.GetCellValueFromView=function(d,b){var a=null;if(b!=null){var c=this.GetRender(b);a=this.GetValueFromRender(d,c);if(a==null||a==" ")a=""}return a};this.SetCellValueFromView=function(b,e,c){if(b!=null){var a=this.GetRender(b),d=this.GetCellType(b);if((d!="readonly"||c)&&a!=null&&a.getAttribute("FpEditor")!="Button"){this.SetValueToRender(a,e);return true}}return false};this.Paste=function(a){var l=this.GetPageActiveSpread();if(l!=null&&l!=a&&this.GetTopSpread(l)==a){this.Paste(l);return}if(this.GetEnableRowEditTemplate(a)=="true"&&this.GetOperationMode(a)=="RowMode")return;if(a.anchorCell==null)return;var x=this.clipboardData;if(x==null)return;var D=this.GetViewportFromCell(a,a.anchorCell),k=this.GetRowFromCell(a,a.anchorCell),j=this.GetColFromCell(a,a.anchorCell),y=this.GetColCount(a),r=this.GetRowCountInternal(a),t=this.GetSelection(a);if(t!=null){var q=t.lastChild;if(q!=null){k=parseInt(q.getAttribute("rowIndex"));if(k==-1)k=0;j=parseInt(q.getAttribute("colIndex"));if(j==-1)j=0}}var f=k,e=j,h=new String(x);if(h.length==0)return;var s=h.lastIndexOf("\r\n");if(s>=0&&s==h.length-2)h=h.substring(0,s);for(var p=0,d=h.split("\r\n"),c=0;c<d.length&&f<r;c++){if(typeof d[c]=="string"){d[c]=d[c].split("\t");if(d[c].length>p)p=d[c].length}f++}f=this.GetSheetIndex(a,k);for(var c=0;c<d.length&&f<r;c++){var i=d[c];if(i!=null){e=j;for(var b=null,w=null,n="",z=false,o=this.GetDisplayIndex(a,f),g=0;g<i.length&&e<y;g++){if(!this.IsCovered(a,o,e,a.spanCells)){b=this.GetCellFromRowCol(a,o,e,b);if(b==null)continue;w=this.GetEditor(b);n=this.GetCellType(b);var z=w!=null&&(n=="text"||n=="TextCellType");if(b.parentNode.getAttribute("previewrow")=="true")continue;var m=i[g];if(!z&&!this.ValidateCell(a,b,m)){if(a.getAttribute("lcidMsg")!=null)alert(a.getAttribute("lcidMsg"));else alert("Can't set the data into the cell. The data type is not correct for the cell.");return}}e++}}f++}if(d.length==0)return;f=this.GetSheetIndex(a,k);for(var c=0;c<d.length&&f<r;c++){e=j;for(var i=d[c],b=null,o=this.GetDisplayIndex(a,f),g=0;g<p&&e<y;g++){if(!this.IsCovered(a,o,e,a.spanCells)){b=this.GetCellFromRowCol(a,o,e,b);if(b==null)continue;if(b.parentNode.getAttribute("previewrow")=="true")continue;var n=this.GetCellType(b),u=this.GetRender(b);if(n!="readonly"&&u.getAttribute("FpEditor")!="Button"){var m=null;if(i!=null&&g<i.length)m=i[g];var B=this.SetCellValueFromView(b,m);if(B)if(m!=null)this.SetCellValue(a,b,""+this.GetValueFromRender(a,u));else this.SetCellValue(a,b,"")}}e++}f++}var A=a.getAttribute("autoCalc");A!="false"&&this.UpdateValues(a);var C=this.GetTopSpread(a),v=document.getElementById(C.id+"_textBox");v!=null&&v.blur();this.Focus(a)};this.UpdateValues=function(a){if(a.dataBuff==null&&this.GetParentSpread(a)==null&&a.getAttribute("rowFilter")!="true"&&a.getAttribute("hierView")!="true"&&a.getAttribute("IsNewRow")!="true"){this.SaveData(a);this.StorePostData(a);this.SyncData(a.getAttribute("name"),"UpdateValues",a)}};this.ValidateCell=function(f,a,c){if(a==null||c==null||c=="")return true;var b=null,d=this.GetCellType(a);if(d!=null){var e=this.GetFunction(d+"_isValid");if(e!=null)b=e(a,c)}return b==null||b==""};this.UpdateSelectionsBackColor=function(a,n,m){for(var i=this.GetSelection(a),c=i.firstChild,h,e,l,k,b,j=0;j<i.childNodes.length;j++){c=i.childNodes[j];h=a.getAttribute("LayoutMode")?parseInt(c.getAttribute("rowIndex")):this.GetRowByKey(a,c.getAttribute("row"));e=a.getAttribute("LayoutMode")?parseInt(c.getAttribute("colIndex")):this.GetColByKey(a,c.getAttribute("col"));l=parseInt(c.getAttribute("rowcount"));k=parseInt(c.getAttribute("colcount"));if(h!=-1&&e!=-1)for(var f=0;f<l;f++)for(var g=0;g<k;g++){if(n==h+f&&m==e+g)continue;b=this.GetCellFromRowCol(a,h+f,e+g);var d=b.style.backgroundColor;if(b!=null&&b.getAttribute("paintSelected")==null){if(a.getAttribute("semiTransparentSelectedBackColor")==null||d==null||d.length==0||d=="transparent"||d=="rgb(0, 0, 0)"||d=="rgba(0, 0, 0, 0)")b.style.backgroundColor=a.getAttribute("selectedBackColor");else b.style.backgroundColor=this.darker(d,a.getAttribute("selectedBackColor"));b.setAttribute("paintSelected",true)}}}};this.DoclearSelection=function(b){var c=this.GetSelection(b),a=c.lastChild;while(a!=null){var g=this.GetRowByKey(b,a.getAttribute("row")),f=this.GetColByKey(b,a.getAttribute("col")),e=parseInt(a.getAttribute("rowcount")),d=parseInt(a.getAttribute("colcount"));this.PaintSelection(b,g,f,e,d,false);c.removeChild(a);a=c.lastChild}};this.Clear=function(ss){var activeSpread=this.GetPageActiveSpread();if(activeSpread!=null&&activeSpread!=ss&&this.GetTopSpread(activeSpread)==ss){this.Clear(activeSpread);return}if(this.GetEnableRowEditTemplate(ss)=="true"&&this.GetOperationMode(ss)=="RowMode")return;var cellType=this.GetCellType(ss.anchorCell);if(cellType=="readonly")return;var selection=this.GetSelection(ss),node=selection.lastChild;if(this.AnyReadOnlyCell(ss,node))return;this.Copy(ss);if(node!=null){var r=this.GetRowByKey(ss,node.getAttribute("row")),c=this.GetColByKey(ss,node.getAttribute("col")),rc=parseInt(node.getAttribute("rowcount")),cc=parseInt(node.getAttribute("colcount"));if(r<0){r=0;rc=this.GetRowCountInternal(ss)}if(c<0){c=0;cc=this.GetColCount(ss)}for(var i=r;i<r+rc;i++){if(this.IsChildSpreadRow(ss,this.GetViewport(ss),i))continue;for(var cell=null,j=c;j<c+cc;j++)if(!this.IsCovered(ss,i,j,ss.spanCells)){cell=this.GetCellFromRowCol(ss,i,j,cell);if(cell==null)continue;if(cell.parentNode.getAttribute("previewrow")=="true")continue;var cellType=this.GetCellType(cell);if(cellType!="readonly"){var edit=this.GetEditor(cell);if(edit!=null&&edit.getAttribute("FpEditor")=="Button")continue;if(edit!=null&&edit.getAttribute("FpEditor")=="MultiColumnComboBoxCellType"){var mccbId=getMccbID(cell,ss);if(mccbId!=null){FarPoint.System.WebControl.MultiColumnComboBoxCellType.CheckInit(mccbId);var editorObj=eval(mccbId+"_Obj");editorObj!=null&&editorObj.SetText(null)}}else{cell.removeAttribute("FpFormula");this.SetCellValueFromView(cell,null)}this.SetCellValue(ss,cell,"")}}}var autoCalc=ss.getAttribute("autoCalc");autoCalc!="false"&&this.UpdateValues(ss)}};this.AnyReadOnlyCell=function(a,b){if(b!=null){var f=this.GetRowByKey(a,b.getAttribute("row")),d=this.GetColByKey(a,b.getAttribute("col")),i=parseInt(b.getAttribute("rowcount")),h=parseInt(b.getAttribute("colcount"));if(f<0){f=0;i=this.GetRowCountInternal(a)}if(d<0){d=0;h=this.GetColCount(a)}for(var c=f;c<f+i;c++){if(this.IsChildSpreadRow(a,this.GetViewport(a),c))continue;for(var g=null,e=d;e<d+h;e++)if(!this.IsCovered(a,c,e,a.spanCells)){g=this.GetCellFromRowCol(a,c,e,g);var j=this.GetCellType(g);if(j=="readonly")return true}}}return false};this.MoveSliderBar=function(a,e){var c=this.GetElementById(this.activePager,a.id+"_slideBar"),b=e.clientX-this.GetOffsetLeft(a,a,document.body)+window.scrollX-8;if(b<a.slideLeft)b=a.slideLeft;if(b>a.slideRight)b=a.slideRight;var d=parseInt(this.activePager.getAttribute("totalPage"))-1,f=parseInt((b-a.slideLeft)/(a.slideRight-a.slideLeft)*d)+1;if(a.style.position!="absolute"&&a.style.position!="relative")b+=this.GetOffsetLeft(a,a,document.body);c.style.left=b+"px";return f};this.GetOffsetParent=function(b){var a=b;while(a!=document.body&&a.style.position!="absolute"&&a.style.position!="relative"&&a.style.position!="fixed")a=a.offsetParent;if(a==null)a=document.body;return a};this.MouseMove=function(b){if(window.fpPostOn!=null)return;b=this.GetEvent(b);var g=this.GetTarget(b);if(g!=null&&g.tagName=="scrollbar")return;var a=this.GetSpread(g,true);if(a!=null&&this.dragSlideBar){if(this.activePager!=null){var M=this.MoveSliderBar(a,b),o=this.GetElementById(this.activePager,a.id+"_posIndicator");o.innerHTML=this.activePager.getAttribute("pageText")+M}return}if(this.working)a=this.GetSpread(this.activeElement);if(a==null||!this.working&&this.HitCommandBar(g))return;if(a.getAttribute("OperationMode")=="ReadOnly")return;var H=this.IsXHTML(a);if(this.working){if(this.dragCol!=null&&this.dragCol>=0){var l=this.GetMovingCol(a),i=b.clientX;if(l!=null){if(l.style.display=="none")l.style.display="";var r=document.defaultView.getComputedStyle(a,null);if(r.position!="absolute"&&r.position!="relative"){var p=this.GetOffsetParent(a);l.style.top=""+(b.clientY+window.scrollY-this.GetOffsetTop(a,p,document.body))+"px";l.style.left=""+(b.clientX+window.scrollX+5-this.GetOffsetLeft(a,p,document.body))+"px";i-=this.GetOffsetLeft(p,a,document.body)}else{l.style.top=""+(b.clientY-this.GetOffsetTop(a,a,document.body)+window.scrollY)+"px";l.style.left=""+(b.clientX-this.GetOffsetLeft(a,a,document.body)+window.scrollX+5)+"px"}}var v=this.GetViewport(a),N=document.body,k=this.GetGroupBar(a),e=-1,n=0,d=0,r=document.defaultView.getComputedStyle(a,null);if(r.position!="absolute"&&r.position!="relative"){var p=this.GetOffsetParent(a);n=this.GetOffsetTop(a,a,p)-v.parentNode.scrollTop+a.virtualTop;d=this.GetOffsetLeft(a,a,p)-v.parentNode.scrollLeft;i+=Math.max(document.body.scrollLeft,document.documentElement.scrollLeft)}else i-=this.GetOffsetLeft(a,a,document.body)-Math.max(document.body.scrollLeft,document.documentElement.scrollLeft);var w=false,H=this.IsXHTML(a),x=H?document.body.parentNode.scrollTop:document.body.scrollTop,s=document.getElementById(a.id+"_titleBar");if(s)x-=s.parentNode.parentNode.offsetHeight;if(this.GetPager1(a)!=null)x-=this.GetPager1(a).offsetHeight;if(k!=null&&b.clientY<this.GetOffsetTop(a,a,document.body)-v.parentNode.scrollTop+k.offsetHeight-x){if(a.style.position!="absolute"&&a.style.position!="relative")d=this.GetOffsetLeft(a,a,document.body);n+=10;w=true;var A=k.getElementsByTagName("TABLE")[0];if(A!=null)for(var j=0;j<A.rows[0].cells[0].childNodes.length;j++){var m=A.rows[0].cells[0].childNodes[j].offsetWidth;if(m==null)continue;if(d<=i&&i<d+m){e=j;break}d+=m}if(e==-1&&i>=d)e=-2;a.targetCol=e}else{if(a.style.position=="absolute"||a.style.position=="relative")d=-v.parentNode.scrollLeft;if(this.GetRowHeader(a)!=null)d+=this.GetRowHeader(a).offsetWidth;if(k!=null)n+=k.offsetHeight;if(i<d)e=0;else{var u=this.GetColGroup(this.GetColHeader(a));if(u!=null)for(var j=0;j<u.childNodes.length;j++){var m=parseInt(u.childNodes[j].width);if(m==null)continue;if(d<=i&&i<d+m){e=j;break}d+=m}}if(e>=0&&e!=this.dragViewCol)if(this.dragViewCol<e){e++;if(e<u.childNodes.length)d+=m}d-=5;var y=parseInt(this.GetSheetColIndex(a,e));if(y<0)y=e;a.targetCol=y}if(s)n+=s.parentNode.parentNode.offsetHeight;if(this.GetPager1(a)!=null)n+=this.GetPager1(a).offsetHeight;var o=this.GetPosIndicator(a);o.style.left=""+d+"px";o.style.top=""+n+"px";if(k!=null&&w&&k.getElementsByTagName("TABLE").length==0)o.style.display="none";else if(w||a.allowColMove)o.style.display="";else o.style.display="none";return}if(this.sizeColumn==null&&this.sizeRow==null){if(a.anchorCell!=null){var c=this.GetParent(this.GetViewport(a));if(c!=null){var L=a.offsetTop+c.offsetTop+c.offsetHeight-10;if(b.clientY>L){c.scrollTop=c.scrollTop+10;this.ScrollView(a)}else if(b.clientY<a.offsetTop+c.offsetTop+5){if(c.scrollTop-10>=a.virtualTop)c.scrollTop=c.scrollTop-10;else c.scrollTop=a.virtualTop;this.ScrollView(a)}var K=a.offsetLeft+c.offsetLeft+c.offsetWidth-20;if(b.clientX>K){c.scrollLeft=c.scrollLeft+10;this.ScrollView(a)}else if(b.clientX<a.offsetLeft+c.offsetLeft+5){if(c.scrollTop-10>=a.virtualTop)c.scrollLeft=c.scrollLeft-10;else c.scrollLeft=a.virtualTop;this.ScrollView(a)}}var h=this.GetCell(g,null,b);if(h!=null&&h!=a.leadingCell){var t=this.GetOperationMode(a);if(t!="MultiSelect"){if(t=="SingleSelect"||t=="RowMode"){var q=this.GetRowFromCell(a,h),f;if(this.InRowHeader(a,h)){if(a.anchorCell!=null)if(this.InRowHeader(a,a.anchorCell))f=-1;else f=this.GetColFromCell(a,a.anchorCell);else f=-1;if(f==-1){var I=fpSpreadJS.getNextColumn(q,0,false,true,true);if(I==-1)f=this.GetColFromCell(a,h)}}else f=this.GetColFromCell(a,h);var F=this.FireActiveCellChangingEvent(a,q,f);if(F)return;this.ClearSelection(a);this.UpdateAnchorCell(a,q,f,false);this.SelectRow(a,q,1,true,true);if(this.GetCellFromRowCol(a,a.selectStartRow,f)==a.anchorCell)a.leadingCellRow=a.selectStartRow;this.FireActiveCellChangedEvent(a,q,f)}else if(!(t=="Normal"&&this.GetSelectionPolicy(a)=="Single")){this.Select(a,a.anchorCell,h);this.SyncColSelection(a)}a.leadingCell=h}}}}else if(this.sizeColumn!=null){var C=b.clientX-this.activeX,B=parseInt(this.sizeColumn.width)+C,E=0,D=B>E;if(D){this.sizeColumn.width=B;var J=parseInt(this.sizeColumn.getAttribute("index"));this.SetWidthFix(this.GetColHeader(a),J,B);this.activeX=b.clientX}}else if(this.sizeRow!=null){var C=b.clientY-this.activeY,G=parseInt(this.sizeRow.style.height)+C,E=0,D=E<G;if(D){var z=this.sizeRow.cells[0].style.posHeight+C;this.sizeRow.style.posHeight=z;this.sizeRow.cells[0].style.posHeight=z;if(this.sizeRow.cells[1]!=null&&this.sizeRow.cells[1].style!=null)this.sizeRow.cells[1].style.posHeight=z;this.activeY=b.clientY}}}else{this.activeElement=g;if(this.activeElement==null||this.GetSpread(this.activeElement)!=a)return;var g=this.GetSizeColumn(a,this.activeElement,b);if(g!=null){this.sizeColumn=g;this.activeElement.style.cursor=this.GetResizeCursor(false)}else{var g=this.GetSizeRow(a,this.activeElement,b);if(g!=null){this.sizeRow=g;if(this.activeElement!=null&&this.activeElement.style!=null)this.activeElement.style.cursor=this.GetResizeCursor(true)}else if(this.activeElement!=null&&this.activeElement.style!=null){var h=this.GetCell(this.activeElement);if(h!=null&&this.IsHeaderCell(a,h))this.activeElement.style.cursor="default";if(this.activeElement!=null&&(this.activeElement.getAttribute("FpSpread")=="rowpadding"||this.activeElement.getAttribute("ControlType")=="chgrayarea"))this.activeElement.style.cursor=this.GetgrayAreaCursor(a)}}}};this.MouseWheel=function(b){var a=this.GetSpread(b.target,false);if(a!=null){a.EndEdit();if(a.getAttribute("ClientAutoSize")!="True"){var c=this.GetParent(this.GetViewport(a));if(c.style.overflow=="hidden"){c.scrollTop+=10*b.detail;this.ScrollView(a)}}}};this.GetgrayAreaCursor=function(a){if(a.tableView!=null&&a.tableView.style.cursor!=null){if(a.tableView.style.cursor=="auto")a.tableView.style.cursor="default";return a.tableView.style.cursor}else return"default"};this.GetResizeCursor=function(a){return a?"n-resize":"w-resize"};this.HitCommandBar=function(c){var a=c,b=this.GetTopSpread(this.GetSpread(a,true));if(b==null)return false;var d=this.GetCommandBar(b);while(a!=null&&a!=b){if(a==d)return true;a=a.parentNode}return false};this.OpenWaitMsg=function(a){var d=document.getElementById(a.id+"_waitmsgcontainer");if(d==null){var b=document.getElementById(a.id+"_waitmsg");b.style.display="block";var h=a.offsetWidth,g=a.offsetHeight,c=this.CreateTestBox(a);c.style.fontFamily=b.style.fontFamily;c.style.fontSize=b.style.fontSize;c.style.fontWeight=b.style.fontWeight;c.style.fontStyle=b.style.fontStyle;c.innerHTML=b.innerHTML;b.style.width=""+(c.offsetWidth+2)+"px";var e=Math.max(10,(h-parseInt(b.offsetWidth))/2),f=Math.max(10,(g-parseInt(b.offsetHeight))/2);if(a.style.position!="absolute"&&a.style.position!="relative"){e+=this.GetOffsetLeft(a,a,document.body);f+=this.GetOffsetTop(a,a,document.body)}b.style.top=""+f+"px";b.style.left=""+e+"px"}else{d.style.display="block";var f=Math.max(10,(a.offsetHeight-parseInt(d.offsetHeight))/2),e=a.clientLeft+8;if(a.style.position!="absolute"&&a.style.position!="relative"){e+=this.GetOffsetLeft(a,a,document.body);f+=this.GetOffsetTop(a,a,document.body)}d.style.top=""+f+"px";d.style.left=""+e+"px";d.style.width=""+(a.offsetWidth-a.offsetLeft-8)+"px"}};this.CloseWaitMsg=function(a){var b=document.getElementById(a.id+"_waitmsgcontainer");if(b==null){var c=document.getElementById(a.id+"_waitmsg");if(c!=null)c.style.display="none"}else b.style.display="none";this.Focus(a)};this.MouseDown=function(d){if(window.fpPostOn!=null)return;d=this.GetEvent(d);var b=this.GetTarget(d),a=this.GetSpread(b,true);a.isactive=true;a.preventPopUp=false;a.mouseY=d.clientY;var r=this.GetPageActiveSpread();if(this.GetViewport(a)==null)return;if(a!=null&&b.parentNode!=null&&b.parentNode.getAttribute("name")==a.id+"_slideBar"){if(this.IsChild(b,this.GetPager1(a)))this.activePager=this.GetPager1(a);else if(this.IsChild(b,this.GetPager2(a)))this.activePager=this.GetPager2(a);if(this.activePager!=null){var p=true;if(this.editing)p=this.EndEdit(a);if(p){this.UpdatePostbackData(a);this.dragSlideBar=true}}return this.CancelDefault(d)}if(this.GetOperationMode(a)=="ReadOnly")return;var y=false;if(a!=null)y=this.IsXHTML(a);if(this.editing&&a.getAttribute("mcctCellType")!="true"){var A=this.GetCell(b);if(A!=a.anchorCell){var p=this.EndEdit();if(!p)return}else return}if(this.HitCommandBar(b)||b==this.GetParent(this.GetViewport(a)))return;var B=r==a;this.SetActiveSpread(d);r=this.GetPageActiveSpread();if(this.HitCommandBar(b))return;if(d.button==2)return;if(this.IsChild(b,this.GetGroupBar(a))){var q=parseInt(b.id.replace(a.id+"_group",""));if(!isNaN(q)){this.dragCol=q;this.dragViewCol=this.GetColByKey(a,q);var m=this.GetMovingCol(a);m.innerHTML=b.innerHTML;m.style.width=""+Math.max(this.GetPreferredCellWidth(a,b),80)+"px";if(a.getAttribute("DragColumnCssClass")==null)m.style.backgroundColor=b.style.backgroundColor;m.style.top="-50px";m.style.left="-100px";this.working=true;a.dragFromGroupbar=true;this.CancelDefault(d);return}}this.sizeColumn=this.GetSizeColumn(a,b,d);if(this.sizeColumn!=null){this.working=true;this.activeX=this.activeY=d.clientX;if(this.sizeColumn.style!=null)this.sizeColumn.style.cursor=this.GetResizeCursor(false);this.activeElement=b}else{this.sizeRow=this.GetSizeRow(a,b,d);if(this.sizeRow!=null){this.working=true;this.activeX=this.activeY=d.clientY;this.sizeRow.style.cursor=this.GetResizeCursor(true);this.activeElement=b}else{var c=this.GetCell(b,null,d);if(c==null){var s=this.GetCorner(a);if(s!=null&&this.IsChild(b,s))if(this.GetOperationMode(a)=="Normal"){if(a.anchorCell!=null)this.saveAnchorCell(a,a.anchorCell);else{this.SetActiveRow(a,-1);this.SetActiveCol(a,-1)}a.oldAnchorCell=a.anchorCell;this.SelectTable(a,true);if(a.anchorCell){a.leadingCellRow=this.GetRowFromCell(a,a.anchorCell);a.leadingCellCol=this.GetColFromCell(a,a.anchorCell)}}return}var t=this.GetColFromCell(a,c);if(c.parentNode.getAttribute("FpSpread")=="ch"&&this.GetColFromCell(a,c)>=this.GetColCount(a))return;if(c.parentNode.getAttribute("FpSpread")=="rh"&&this.IsChildSpreadRow(a,this.GetViewport(a),c.parentNode.rowIndex))return;var w=c.getAttribute("canFocus")=="false";if(w)return;if(c.parentNode.getAttribute("FpSpread")=="ch"&&(this.GetOperationMode(a)=="RowMode"||this.GetOperationMode(a)=="SingleSelect"||this.GetOperationMode(a)=="ExtendedSelect")){if(!a.allowColMove&&!a.allowGroup)return}else{var x=this.FireActiveCellChangingEvent(a,this.GetRowFromCell(a,c),this.GetColFromCell(a,c),c.parentNode.getAttribute("row"));if(x)return;var e=this.GetOperationMode(a),C=this.GetTopSpread(a);if(!d.ctrlKey||a.getAttribute("multiRange")!="true"){if(e!="MultiSelect"&&!(d.shiftKey&&e=="ExtendedSelect"&&a.getAttribute("LayoutMode")==null))if(!((a.allowColMove||a.allowGroup)&&c.parentNode.getAttribute("FpSpread")=="ch"&&e=="Normal"&&(a.getAttribute("SelectionPolicy")=="Range"||a.getAttribute("SelectionPolicy")=="MultiRange")&&a.selectedCols.length!=0&&this.IsColSelected(a,t))){var o=!this.InRowHeader(a,c)||(a.selectionBlockOptions&SelectionBlockOptions.Rows)!=0;o=o&&(!this.InColHeader(a,c)||(a.selectionBlockOptions&SelectionBlockOptions.Columns)!=0);if(o)this.ClearSelection(a);else{this.CancelDefault(d);return}}}else if(e!="ExtendedSelect"&&e!="MultiSelect")if(a.anchorCell!=null){this.PaintSelectedCell(a,a.anchorCell,true);this.UpdateSelectionsBackColor(a,this.GetRowFromCell(a,c),this.GetColFromCell(a,c))}}var n=a.anchorCell;if(n)a.oldAnchorCell=n;a.anchorCell=c;var g=a.anchorCell,f=this.GetParent(this.GetViewport(a));if(f!=null&&!this.IsControl(b)&&b!=null&&b.tagName!="scrollbar"){if(this.IsChild(g,f)&&g.offsetLeft+g.offsetWidth>f.scrollLeft+f.clientWidth)f.scrollLeft=g.offsetLeft+g.offsetWidth-f.clientWidth;if(this.IsChild(g,f)&&g.offsetTop+g.offsetHeight>f.scrollTop+f.clientHeight&&g.offsetHeight<f.clientHeight)f.scrollTop=g.offsetTop+g.offsetHeight-f.clientHeight;if(this.IsChild(g,this.GetViewport(a))){if(g.offsetTop<f.scrollTop-a.virtualTop)f.scrollTop=g.offsetTop+a.virtualTop;if(g.offsetLeft<f.scrollLeft)f.scrollLeft=g.offsetLeft}this.ScrollView(a)}var e=this.GetOperationMode(a),h=c.parentNode.getAttribute("FpSpread"),v=h=="rh",u=h=="ch";if(h=="r"||h=="ch"||h=="rh"){this.saveAnchorCell(a,c);if(h=="ch")a.leadingCellRow=0;else if(h=="rh")a.leadingCellCol=0}if(a.anchorCell.parentNode.getAttribute("FpSpread")=="r"){if(d.shiftKey&&e=="ExtendedSelect"&&a.getAttribute("LayoutMode")==null){var k=this.GetExtendedSelectRows(a,n,a.leadingCell,a.anchorCell);this.ClearSelection(a);k!=null&&k.length>0&&this.SelectRow(a,k[0],k[1],true,true)}else if(e=="ExtendedSelect"||e=="MultiSelect"){var z=this.IsRowSelected(a,this.GetRowFromCell(a,a.anchorCell));if(z)this.SelectRow(a,this.GetRowFromCell(a,a.anchorCell),1,false,true);else this.SelectRow(a,this.GetRowFromCell(a,a.anchorCell),1,true,true)}else if(e=="RowMode"||e=="SingleSelect")this.SelectRow(a,this.GetRowFromCell(a,a.anchorCell),1,true,true);else this.SelectRange(a,this.GetRowFromCell(a,a.anchorCell),this.GetColFromCell(a,a.anchorCell),1,1,true);a.selectStartRow=this.GetRowFromCell(a,a.anchorCell);a.selectStartCol=this.GetColFromCell(a,a.anchorCell)}else if(a.anchorCell.parentNode.getAttribute("FpSpread")=="ch"){if(b.tagName=="INPUT"||b.tagName=="TEXTAREA"||b.tagName=="SELECT")return;var i=this.GetColFromCell(a,a.anchorCell);if(a.allowColMove||a.allowGroup)if(e=="Normal"&&(a.getAttribute("SelectionPolicy")=="Range"||a.getAttribute("SelectionPolicy")=="MultiRange"))if(this.IsColSelected(a,i)){this.AdjustAnchorCell(a,i);this.PaintAnchorCell(a);this.InitMovingCol(a,i)}else this.SelectColumn(a,i,1,true);else{if(a.getAttribute("LayoutMode"))i=parseInt(a.anchorCell.getAttribute("col"));if(e=="Normal"||e=="ReadOnly")this.SelectColumn(a,i,1,true);else a.selectedCols.push(i);this.InitMovingCol(a,i)}else if(e=="Normal"||e=="ReadOnly"){if(a.getAttribute("LayoutMode"))i=parseInt(a.anchorCell.getAttribute("col"));this.SelectColumn(a,i,1,true)}else return}else if(a.anchorCell.parentNode.getAttribute("FpSpread")=="rh"){if(b.tagName=="INPUT"||b.tagName=="TEXTAREA"||b.tagName=="SELECT")return;if(d.shiftKey&&e=="ExtendedSelect"&&a.getAttribute("LayoutMode")==null){var k=this.GetExtendedSelectRows(a,n,a.leadingCell,a.anchorCell);this.ClearSelection(a);k!=null&&k.length>0&&this.SelectRow(a,k[0],k[1],true,true)}else if(e=="ExtendedSelect"||e=="MultiSelect")if(this.IsRowSelected(a,this.GetRowFromCell(a,a.anchorCell)))this.SelectRow(a,this.GetRowFromCell(a,a.anchorCell),1,false,true);else this.SelectRow(a,this.GetRowFromCell(a,a.anchorCell),1,true,true);else this.SelectRow(a,this.GetRowFromCell(a,a.anchorCell),1,true)}if(a.anchorCell!=null){var l=this.CreateEvent("ActiveCellChanged");l.cmdID=a.id;l.Row=l.row=this.GetSheetIndex(a,this.GetRowFromCell(a,a.anchorCell));l.Col=l.col=this.GetColFromCell(a,a.anchorCell);if(a.getAttribute("LayoutMode"))l.InnerRow=l.innerRow=a.anchorCell.parentNode.getAttribute("row");this.FireEvent(a,l)}a.leadingCell=a.anchorCell;if(a.anchorCell!=null){h=a.anchorCell.parentNode.getAttribute("FpSpread");if(h=="rh"||h=="r")a.leadingCellRow=this.GetRowFromCell(a,a.anchorCell);if(h=="ch"||h=="r")a.leadingCellCol=t;if(v&&this.GetCellFromRowCol(a,a.selectStartRow,a.leadingCellCol)==a.anchorCell)a.leadingCellRow=a.selectStartRow;if(u&&this.GetCellFromRowCol(a,a.leadingCellRow,a.selectStartCol)==a.anchorCell)a.leadingCellCol=a.selectStartCol}this.activeElement=b;this.working=true}}this.EnableButtons(a);if(!this.editing&&this.sizeRow==null&&this.sizeColumn==null)if(a.anchorCell!=null&&this.IsChild(a.anchorCell,a)&&!this.IsHeaderCell(this.GetCell(b))){var j=this.GetEditor(a.anchorCell);if(j!=null){j.type=="submit"&&this.SaveData(a);this.editing=j.type!="button"&&j.type!="submit";this.editor=j;this.renderAsEditor=1;this.editingValue=this.GetEditorValue(j,a);(j.focus||j.getAttribute("fpeditor")=="MultiColumnComboBoxCellType")&&this.SetEditorFocus(j)}}if(!this.IsControl(b)){a!=null&&this.UpdatePostbackData(a);return this.CancelDefault(d)}};this.GetMovingCol=function(b){var a=document.getElementById(b.id+"movingCol");if(a==null){a=document.createElement("DIV");a.style.display="none";a.style.position="absolute";a.style.top="0px";a.style.left="0px";a.id=b.id+"movingCol";a.align="center";b.insertBefore(a,null);if(b.getAttribute("DragColumnCssClass")!=null)a.className=b.getAttribute("DragColumnCssClass");else a.style.border="1px solid black";a.style.MozOpacity=.5}return a};this.IsControl=function(a){return a!=null&&(a.tagName=="INPUT"||a.tagName=="TEXTAREA"||a.tagName=="SELECT"||a.tagName=="OPTION")};this.changeButtonsState=function(c,b){var a=this.GetCmdBtn(c,"Update");a!=null&&a.getAttribute("disabled")!=null&&this.UpdateCmdBtnState(a,!b);a=this.GetCmdBtn(c,"Cancel");a!=null&&a.getAttribute("disabled")!=null&&this.UpdateCmdBtnState(a,!b)};this.EnableButtons=function(b){var h=this.GetCellType(b.anchorCell),g=this.GetSelection(b),c=g.lastChild,f=b.getAttribute("OperationMode"),d=f=="ReadOnly"||f=="SingleSelect"||h=="readonly";if(!d)d=this.AnyReadOnlyCell(b,c);if(d){var a=this.GetCmdBtn(b,"Copy");this.UpdateCmdBtnState(a,c==null);var e=this.clipboardData;a=this.GetCmdBtn(b,"Paste");this.UpdateCmdBtnState(a,c==null||e==null);a=this.GetCmdBtn(b,"Clear");this.UpdateCmdBtnState(a,true)}else{var a=this.GetCmdBtn(b,"Copy");this.UpdateCmdBtnState(a,c==null);var e=this.clipboardData;a=this.GetCmdBtn(b,"Paste");this.UpdateCmdBtnState(a,c==null||e==null);a=this.GetCmdBtn(b,"Clear");this.UpdateCmdBtnState(a,c==null)}};this.CellClicked=function(b){var a=this.GetSpread(b);a!=null&&this.SaveData(a)};this.getCmdButtonState=function(a){return a==null||a.disabled||/true/i.test(a.getAttribute("disabled"))||a.tagName=="IMG"&&new RegExp(a.getAttribute("disabledImg")+"$","i").test(a.src)?false:true};this.UpdateCmdBtnState=function(a,b){if(a==null)return;if(a.tagName=="INPUT"){var e=a.disabled;if(e==b)return;a.disabled=b}else{var e=a.getAttribute("disabled");if(e==b)return;a.setAttribute("disabled",b)}if(a.tagName=="IMG"){var c=a.getAttribute("disabledImg");if(b&&c!=null&&c!=""){if(a.src.indexOf(c)<0)a.src=c}else{var d=a.getAttribute("enabledImg");if(a.src.indexOf(d)<0)a.src=d}}};this.SetImageButtonSrc=function(b,c){if(b==null)return;if(b.tagName!="IMG")return;var a="";switch(c){case 0:case"enable":a=b.getAttribute("enabledimg");break;case 1:case"disable":a=b.getAttribute("disabledImg");break;case 2:case"hover":a=b.getAttribute("hoverImg")}if(a!=null&&a!=""&&b.src.indexOf(a)<0)b.src=a};this.GetExtendedSelectRows=function(e,i,f,h){var a=[],d=f!=null?this.GetRowFromCell(e,f):this.GetRowFromCell(e,i),b=this.GetRowFromCell(e,h),g=this.GetSelection(e);if(g==null){a.push(newRow);a.push(1)}else{var c=this.GetSelectRowNode(g,d);if(c!=null)if(b<c.startRow){a.push(b);if(d==c.startRow)a.push(c.endRow-b+1);else a.push(c.startRow-b+1)}else if(c.startRow<=b&&b<=c.endRow)if(b>=d){a.push(b);a.push(c.endRow-b+1)}else{a.push(c.startRow);a.push(b-c.startRow+1)}else if(d==c.startRow){a.push(c.endRow);a.push(b-c.endRow+1)}else{a.push(c.startRow);a.push(b-c.startRow+1)}else if(d<b){a.push(d+1);a.push(b-d-1)}else{a.push(b);a.push(Math.max(1,d-b))}}return a};this.GetSelectRowNode=function(f,d){var b=null,a=f.firstChild;while(a!=null){var g=parseInt(a.getAttribute("colIndex"));if(g==-1){var c=parseInt(a.getAttribute("rowIndex")),e=parseInt(a.getAttribute("rowcount"));if(c<=d&&d<c+e){b={};b.startRow=c;b.endRow=c+e-1;break}}a=a.nextSibling}return b};this.MouseUp=function(b){if(window.fpPostOn!=null)return;b=this.GetEvent(b);var h=this.GetTarget(b),a=this.GetSpread(h,true);if(a==null&&!this.working&&!this.dragSlideBar)return;if(this.dragSlideBar){this.dragSlideBar=false;if(a==null)a=this.GetSpread(this.activePager,true);if(this.activePager!=null){var U=this.MoveSliderBar(a,b)-1;this.activePager=null;this.GotoPage(a,U)}return}if(this.editing){var u=this.GetCell(b.target),C=this.GetCellType(u);if(u!=null){var z=this.GetEditor(u);if(z!=null&&this.renderAsEditor==1)if(C==$$.CellTypes.CHECKBOX||C==$$.CellTypes.RADIO_BUTTON_LIST){var O=this.GetEditorValue(z,a);this.editingValue=O;this.changeButtonsState(a,true)}}}if(this.working&&(this.sizeColumn!=null||this.sizeRow!=null))if(this.sizeColumn!=null)a=this.GetSpread(this.sizeColumn);else a=this.GetSpread(this.sizeRow);if(a==null)return;if(this.GetViewport(a)==null)return;var S=this.GetOperationMode(a);if(S=="ReadOnly")return;var r=true;if(this.working){this.working=false;if(this.dragCol!=null&&this.dragCol>=0){var q=this.IsChild(h,this.GetGroupBar(a))||h==this.GetGroupBar(a);if(!q&&this.GetGroupBar(a)!=null){var K=b.clientX,L=b.clientY,G=a.offsetLeft,I=a.offsetTop,T=this.GetGroupBar(a).offsetWidth,R=this.GetGroupBar(a).offsetHeight,A=window.scrollX,p=window.scrollY,F=document.getElementById(a.id+"_titleBar");if(F)p-=F.parentNode.parentNode.offsetHeight;if(this.GetPager1(a)!=null)p-=this.GetPager1(a).offsetHeight;q=G<=A+K&&A+K<=G+T&&I<=p+L&&p+L<=I+R}if(a.dragFromGroupbar)if(q)if(a.targetCol>0)this.Regroup(a,this.dragCol,parseInt((a.targetCol+1)/2));else this.Regroup(a,this.dragCol,a.targetCol);else this.Ungroup(a,this.dragCol,a.targetCol);else if(q){if(a.allowGroup)if(a.targetCol>0)this.Group(a,this.dragCol,parseInt((a.targetCol+1)/2));else this.Group(a,this.dragCol,a.targetCol)}else if(a.allowColMove)if(a.targetCol!=null){var d=this.CreateEvent("ColumnDragMove");d.cancel=false;d.col=a.selectedCols;this.FireEvent(a,d);if(!d.cancel){var M=this.GetOperationMode(a)!=$$.OperationModes.NORMAL?a.fpSpreadJS.buildTargetColsMoved(a.selectedCols,this.dragCol,a.targetCol):null;this.MoveCol(a,this.dragCol,a.targetCol);var N=this.GetOperationMode(a)!=$$.OperationModes.NORMAL?M:a.selectedCols,d=this.CreateEvent("ColumnDragMoveCompleted");d.col=N;this.FireEvent(a,d)}}var H=this.GetMovingCol(a);if(H!=null)H.style.display="none";this.dragCol=-1;this.dragViewCol=-1;var J=this.GetPosIndicator(a);if(J!=null)J.style.display="none";a.dragFromGroupbar=false;a.targetCol=null;this.sizeColumn=this.sizeRow=null}if(this.sizeColumn!=null){r=false;var v=b.clientX-this.activeX,f=parseInt(this.sizeColumn.width),i=f;if(isNaN(f))f=0;f+=v;if(f<1)f=1;var n=parseInt(this.sizeColumn.getAttribute("index")),w=this.GetColGroup(this.GetViewport(a));if(w!=null&&w.childNodes.length>0)i=parseInt(w.childNodes[n].width);else i=1;if(this.GetViewport(a).rules!="rows"){if(n==0)i+=1;if(n==parseInt(this.colCount)-1)i-=1}if(f!=i&&b.clientX!=this.activeY){this.SetColWidth(a,n,f);var d=this.CreateEvent("ColWidthChanged");d.col=n;d.width=f;this.FireEvent(a,d)}this.ScrollView(a);this.PaintFocusRect(a)}else if(this.sizeRow!=null){r=false;var v=b.clientY-this.activeY,j=this.sizeRow.offsetHeight+v;if(j<1){j=1;v=1-this.sizeRow.offsetHeight}this.sizeRow.style.height=""+j+"px";this.sizeRow.cells[0].style.posHeight=j;if(this.sizeRow.cells[1]!=null&&this.sizeRow.cells[1].style!=null)this.sizeRow.cells[1].style.posHeight=j;this.sizeRow.style.cursor="auto";var g=null;g=this.GetViewport(a);g.rows[this.sizeRow.rowIndex].style.height=this.sizeRow.style.height;if(typeof g.rows[this.sizeRow.rowIndex]!="undefined"&&typeof g.rows[this.sizeRow.rowIndex].cells[0]!="undefined")g.rows[this.sizeRow.rowIndex].cells[0].style.height=this.sizeRow.cells[0].style.height;var s=this.AddRowInfo(a,this.sizeRow.getAttribute("FpKey"));if(s!=null)if(this.sizeRow.cells[0])this.SetRowHeight(a,s,parseInt(this.sizeRow.cells[0].style.posHeight));else this.SetRowHeight(a,s,parseInt(this.sizeRow.style.height));if(this.activeX!=b.clientY){var d=this.CreateEvent("RowHeightChanged");d.row=this.GetRowFromCell(a,this.sizeRow.cells[0]);d.height=this.sizeRow.offsetHeight;this.FireEvent(a,d)}var E=this.GetParentSpread(a);E!=null&&this.UpdateRowHeight(E,a);var x=this.GetTopSpread(a);this.SizeAll(x);this.Refresh(x);this.ScrollView(a);this.PaintFocusRect(a)}if(this.activeElement!=null)this.activeElement=null}else{var y=this.GetPageActiveSpread();if(y!=null&&this.GetTopSpread(y)==this.GetTopSpread(a))a=this.GetPageActiveSpread()}if(r&&this.HitCommandBar(h))return;var o=false,B=this.GetSelection(a);if(B!=null){var k=B.firstChild,e=new this.Range;if(k!=null){e.row=this.GetRowByKey(a,k.getAttribute("row"));e.col=this.GetColByKey(a,k.getAttribute("col"));e.rowCount=parseInt(k.getAttribute("rowcount"));e.colCount=parseInt(k.getAttribute("colcount"))}switch(a.selectType){case"":for(var l=this.GetViewport(a).rows,c=e.row;c<e.row+e.rowCount&&c<l.length;c++)if(l[c].cells.length>0&&l[c].cells[0].firstChild!=null&&l[c].cells[0].firstChild.nodeName!="#text")if(l[c].cells[0].firstChild.getAttribute("FpSpread")=="Spread"){o=true;break}break;case"c":for(var g=this.GetViewport(a),c=0;c<g.rows.length;c++)if(this.IsChildSpreadRow(a,g,c)){o=true;break}break;case"r":for(var g=this.GetViewport(a),P=e.rowCount,c=e.row;c<e.row+P&&c<g.rows.length;c++)if(this.IsChildSpreadRow(a,g,c)){o=true;break}}}if(o){var m=this.GetCmdBtn(a,"Copy");this.UpdateCmdBtnState(m,true);m=this.GetCmdBtn(a,"Paste");this.UpdateCmdBtnState(m,true);m=this.GetCmdBtn(a,"Clear");this.UpdateCmdBtnState(m,true)}var Q=this.IsXHTML(a);if(Q){var x=this.GetTopSpread(a),t=document.getElementById(x.id+"_textBox");if(t!=null){t.style.top=b.clientY-a.offsetTop;t.style.left=b.clientX-a.offsetLeft}}r&&this.Focus(a,b);this.UpdatePostbackData(a);var D=this.GetEditor(a.anchorCell);D!=null&&this.IsChild(h,D)&&h.type=="button"&&h.focus()};this.UpdateRowHeight=function(a,b){var d=b.parentNode;while(d!=null){if(d.tagName=="TR")break;d=d.parentNode}var g=this.IsXHTML(a);if(d!=null){var e=d.rowIndex;if(this.GetRowHeader(a)!=null){var c=0;if(this.GetColHeader(b)!=null)c=this.GetColHeader(b).offsetHeight;if(this.GetRowHeader(b)!=null)c+=this.GetRowHeader(b).offsetHeight;var f=document.getElementById(b.id+"_titleBar");if(f!=null)c+=f.offsetHeight;if(this.GetPager1(b)!=null)c+=this.GetPager1(b).offsetHeight;if(b.colFooter!=null)c+=b.colFooter.offsetHeight;if(!g)c-=this.GetViewport(a).cellSpacing;if(this.GetViewport(a).cellSpacing==0){this.GetRowHeader(a).rows[e].cells[0].style.posHeight=c;if(this.GetParentSpread(a)!=null)this.GetRowHeader(a).parentNode.style.posHeight=this.GetRowHeader(a).offsetHeight}else this.GetRowHeader(a).rows[e].cells[0].style.posHeight=c+2;this.GetViewport(a).rows[e].cells[0].style.posHeight=c;if(!g)c-=1;b.style.posHeight=c}}var h=this.GetParentSpread(a);h!=null&&this.UpdateRowHeight(h,a)};this.MouseOut=function(){if(!this.working&&this.sizeColumn!=null&&this.sizeColumn.style!=null)this.sizeColumn.style.cursor="auto"};this.doIgnoreVirtualPaging=function(a){if(!a.ignoreVirtualPaging){a.ignoreVirtualPaging=true;var b=Function.CreateCallback(function(){var a=arguments[arguments.length-1];a.ignoreVirtualPaging=false},a);setTimeout(b,300)}};this.KeyDown=function(a,b){if(window.fpPostOn!=null)return;if(!a.ProcessKeyMap(b)){b.keyCode==this.enter&&this.CancelDefault(b);return}this.doIgnoreVirtualPaging(a);if(b.keyCode==this.space&&a.anchorCell!=null){var m=this.GetOperationMode(a);if(m=="MultiSelect"){if(this.IsRowSelected(a,this.GetRowFromCell(a,a.anchorCell)))this.SelectRow(a,this.GetRowFromCell(a,a.anchorCell),1,false,true);else this.SelectRow(a,this.GetRowFromCell(a,a.anchorCell),1,true,true);return}}var c=false,d=null;if(this.editing&&this.editor!=null){d=this.GetEditor(a.anchorCell);c=d!=null}if(b.keyCode!=this.enter&&b.keyCode!=this.tab&&this.editing&&!c&&this.editor.tagName=="SELECT")return;switch(b.keyCode){case this.left:case this.right:if(c){var f=this.editor.getAttribute("FpEditor");if(this.editing&&f=="ExtenderEditor"){var g=FpExtender.Util.getEditor(this.editor);g&&g.type!="text"&&this.EndEdit()}f!="RadioButton"&&f!="ExtenderEditor"&&this.EndEdit()}!this.editing&&a.activeChartObj==null&&this.NextCell(a,b,b.keyCode);break;case this.up:case this.down:case this.enter:if(this.editor!=null&&this.editor.tagName=="TEXTAREA")return;if(c&&this.editing&&this.editor.getAttribute("FpEditor")=="ExtenderEditor"){var e=this.editor.getAttribute("Extenders");if(e&&(e.indexOf("AutoCompleteExtender")!=-1||e.indexOf("FpComboBox")!=-1))return}b.keyCode==this.enter&&this.CancelDefault(b);if(this.editing){var h=this.EndEdit();if(!h)return}a.activeChartObj==null&&this.NextCell(a,b,b.keyCode);var n=this.GetTopSpread(a),l=document.getElementById(n.id+"_textBox");this.enter==b.keyCode&&l.focus();break;case this.tab:if(this.editing){var h=this.EndEdit();if(!h)return}var i=this.GetProcessTab(a),k=i=="true"||i=="True";k&&this.NextCell(a,b,b.keyCode);break;case this.shift:break;case this.home:case this.end:case this.pup:case this.pdn:this.CancelDefault(b);!this.editing&&this.NextCell(a,b,b.keyCode);break;default:if(b.keyCode==67&&b.ctrlKey)if(!this.editing||c)this.Copy(a);else this.clipboardData=null;else if(b.keyCode==86&&b.ctrlKey&&(!this.editing||c)){var j=d!=null&&d.getAttribute("FpEditor")!=null&&(d.tagName=="INPUT"&&d.type=="text"||d.tagName=="TEXTAREA");!j&&this.Paste(a)}else if(b.keyCode==88&&b.ctrlKey&&(!this.editing||c))this.Clear(a);else if(!this.editing&&a.anchorCell!=null&&!this.IsHeaderCell(a.anchorCell)&&!b.ctrlKey&&!b.altKey)!(a.anchorCell.getAttribute("canFocus")=="false")&&this.StartEdit(a,a.anchorCell)}};this.GetProcessTab=function(a){var b=this.GetTopSpread(a);return b.getAttribute("ProcessTab")};this.ExpandRow=function(a,b){var c=a.getAttribute("name"),d=a.getAttribute("ajax")!="false";if(d)this.SyncData(c,"ExpandView, "+b,a);else __doPostBack(c,"ExpandView, "+b)};this.SortColumn=function(a,b){var c=a.getAttribute("name"),d=a.getAttribute("ajax")!="false";if(d)this.SyncData(c,"SortColumn, "+b,a);else __doPostBack(c,"SortColumn, "+b)};this.Filter=function(l,d){if(!d.IsValid())return;var e=this.GetTarget(l),b=e.value;if(e.tagName=="SELECT"){var k=new RegExp("\\s*"),j=new RegExp("\\S*"),f=e[e.selectedIndex].text,h="",c=0,i=b.length;while(i>0){var a=b.match(k);if(a!=null){h+=a[0];c=a[0].length;i-=c;b=b.substring(c);a=b.match(j);if(a!=null){c=a[0].length;i-=c;b=b.substring(c)}}else break;a=f.match(j);if(a!=null){h+=a[0];c=a[0].length;f=f.substring(c);a=f.match(k);if(a!=null){c=a[0].length;f=f.substring(c)}}else break}b=h}var g=this.CreateEvent("AutoFilteringColumn");g.cancel=false;g.col=d.selectedCols;g.spread=d;g.filterString=b;this.FireEvent(d,g);if(!g.cancel){this.SaveScrollbarState(d,0,0);this.SaveData(d);d.dirty=false;var m=d.getAttribute("ajax")!="false";if(m)this.SyncData(e.name,b,d);else __doPostBack(e.name,b)}};this.MoveCol=function(a,e,c){var f=a.getAttribute("name");if(a.selectedCols&&a.selectedCols.length>0){for(var d=[],b=0;b<a.selectedCols.length;b++)d[b]=this.GetSheetColIndex(a,a.selectedCols[b]);var h=d.join("+");this.MoveMultiCol(a,h,c);return}var g=a.getAttribute("ajax")!="false";if(g)this.SyncData(f,"MoveCol,"+e+","+c,a);else __doPostBack(f,"MoveCol,"+e+","+c)};this.MoveMultiCol=function(a,b,d){var c=a.getAttribute("name"),e=a.getAttribute("ajax")!="false";if(e)this.SyncData(c,"MoveCol,"+b+","+d,a);else __doPostBack(c,"MoveCol,"+b+","+d)};this.Group=function(a,e,c){var f=a.getAttribute("name");if(a.selectedCols&&a.selectedCols.length>0){for(var d=[],b=0;b<a.selectedCols.length;b++)d[b]=this.GetSheetColIndex(a,a.selectedCols[b]);var h=d.join("+");this.GroupMultiCol(a,h,c);a.selectedCols=[];return}var g=a.getAttribute("ajax")!="false";if(g)this.SyncData(f,"Group,"+e+","+c,a);else __doPostBack(f,"Group,"+e+","+c)};this.GroupMultiCol=function(a,c,b){var d=a.getAttribute("name"),e=a.getAttribute("ajax")!="false";if(e)this.SyncData(d,"Group,"+c+","+b,a);else __doPostBack(d,"Group,"+c+","+b)};this.Ungroup=function(a,c,b){var d=a.getAttribute("name"),e=a.getAttribute("ajax")!="false";if(e)this.SyncData(d,"Ungroup,"+c+","+b,a);else __doPostBack(d,"Ungroup,"+c+","+b)};this.Regroup=function(a,b,c){var d=a.getAttribute("name"),e=a.getAttribute("ajax")!="false";if(e)this.SyncData(d,"Regroup,"+b+","+c,a);else __doPostBack(d,"Regroup,"+b+","+c)};this.ProcessData=function(){try{var req=this;req.removeEventListener("load",the_fpSpread.ProcessData,false);var target=window.srcfpspread;target=target.split(":").join("_");var cmd=window.fpcommand,doc=document,buff=doc.getElementById(target+"_buff");if(buff==null){buff=doc.createElement("iframe");buff.id=target+"_buff";buff.style.display="none";doc.body.appendChild(buff)}var ss=doc.getElementById(target);the_fpSpread.CloseWaitMsg(ss);if(buff==null)return;var respText=req.responseText;if(respText.indexOf("<body")>-1){var ep=ss.getAttribute("errorPage");if(ep!=null&&ep.length>0){the_fpSpread.error=true;window.location.href=ep}return}buff.contentWindow.document.body.innerHTML=respText;if(cmd.indexOf("RefreshChart")>=0){var data=eval("("+respText+")");the_fpSpread.updateChartURL(ss,data);var forms=doc.getElementsByTagName("FORM");forms[0].__EVENTTARGET.value="";forms[0].__EVENTARGUMENT.value="";window.fpPostOn=null;return}var pt=buff.contentWindow.document.getElementById(target+"_values");if(pt!=null){var nodes=pt.getElementsByTagName("data")[0],node=nodes.firstChild;the_fpSpread.error=false;ss.SuspendLayout(true);while(node!=null){var r=the_fpSpread.GetRowByKey(ss,node.getAttribute("r"),-1),c=the_fpSpread.GetColByKey(ss,node.getAttribute("c"),-1);if(r>-1&&c>-1){var old=the_fpSpread.GetValue(ss,r,c);if(node.innerHTML!=old){var f=the_fpSpread.GetFormula(ss,r,c),cl=the_fpSpread.GetCellByRowCol(ss,r,c);the_fpSpread.SetCellValueFromView(cl,node.innerHTML,true);cl.setAttribute("FpFormula",f)}}node=node.nextSibling}the_fpSpread.ClearCellData(ss);ss.ResumeLayout(true)}else{ss.FromProcessData=true;ss.preventPopUp=true;the_fpSpread.UpdateSpread(doc,buff,target,respText,cmd);ss.FromProcessData=false;the_fpSpread.FireAutoFilterColumnCompleted(ss,cmd)}var forms=doc.getElementsByTagName("FORM");forms[0].__EVENTTARGET.value="";forms[0].__EVENTARGUMENT.value="";var old=doc.getElementsByName("__VIEWSTATE")[0],t=buff.contentWindow.document.getElementsByName("__VIEWSTATE")[0];if(old!=null&&t!=null)old.value=t.value;old=doc.getElementsByName("__EVENTVALIDATION");t=buff.contentWindow.document.getElementsByName("__EVENTVALIDATION");if(old!=null&&t!=null&&old.length>0&&t.length>0)old[0].value=t[0].value;buff.contentWindow.document.location="about:blank";window.fpPostOn=null;dataBuff=null}catch(e){window.fpPostOn=null;dataBuff=null}the_fpSpread.ss=ss;setTimeout(the_fpSpread.UpdateImages,0);var ss=the_fpSpread.GetTopSpread(doc.getElementById(target)),e=the_fpSpread.CreateEvent("CallBackStopped");e.command=cmd;the_fpSpread.FireEvent(ss,e)};this.UpdateImages=function(){if(the_fpSpread.ss==null)return;var c=document.images;if(c!=null)for(var a=0;a<c.length;a++)c[a].src=c[a].src;var f=the_fpSpread.GetCommandBar(the_fpSpread.ss);if(f!=null)f.style.backgroundImage=f.style.backgroundImage;var b=the_fpSpread.ss.getElementsByTagName("div");if(b!=null)for(var a=0;a<b.length;a++)if(b[a].id.indexOf("_rowHeader")>=0||b[a].id.indexOf("_colHeader")>=0||b[a].id.indexOf("_corner")>=0)for(var e=b[a].getElementsByTagName("table")[0],d=0;d<e.rows.length;d++)for(var g=0;g<e.rows[d].cells.length;g++){var h=e.rows[d].cells[g];if(document.defaultView.getComputedStyle(h,"").getPropertyValue("background-image").length>0)h.style.backgroundImage=document.defaultView.getComputedStyle(h,"").getPropertyValue("background-image")}the_fpSpread.ss=null};this.UpdateSpread=function(doc,buff,target,respText,cmd){var ss=the_fpSpread.GetTopSpread(doc.getElementById(target)),s=buff.contentWindow.document.getElementById(ss.id);if(s!=null){typeof Sys!="undefined"&&typeof $get!="undefined"&&FarPoint.System.ExtenderHelper.saveLoadedExtenderScripts(ss,cmd);the_fpSpread.error=s.getAttribute("error")=="true";ss.LoadState=null;if(cmd=="LoadOnDemand"&&!the_fpSpread.error){var ssData=this.GetElementById(ss,ss.id+"_data"),newData=this.GetElementById(s,ss.id+"_data");ssData!=null&&newData!=null&&ssData.setAttribute("data",newData.getAttribute("data"));this.CopySpreadAttr(s,ss,"AllRowsLoaded");var css=s.getElementsByTagName("style");if(css!=null)for(var i=0;i<css.length;i++)css[i]!=null&&css[i].innerHTML!=null&&css[i].innerHTML.indexOf(ss.id+"msgStyle")<0&&ss.appendChild(css[i].cloneNode(true));var ssLastRow=this.GetElementById(ss,ss.id+"_LoadInfo"),newLastRow=this.GetElementById(s,ss.id+"_LoadInfo");if(ssLastRow!=null&&newLastRow!=null)ssLastRow.value=newLastRow.value;var hasNewRows=false,rhTmp=this.GetElementById(s,ss.id+"_rowHeader");if(rhTmp!=null){rhTmp=rhTmp.firstChild;hasNewRows=rhTmp.rows.length>1;var rh=this.GetRowHeader(ss);this.LoadRows(rh,rhTmp,true)}var vpTmp=this.GetElementById(s,ss.id+"_viewport");if(vpTmp!=null){hasNewRows=vpTmp.rows.length>0;var vp=this.GetViewport(ss);this.LoadRows(vp,vpTmp,false)}ss.preventScrollView=cmd=="LoadOnDemand";the_fpSpread.Init(ss);ss.preventScrollView=false;the_fpSpread.Focus(ss);if(hasNewRows)ss.LoadState=null;else ss.LoadState="complete";typeof Sys!="undefined"&&typeof $get!="undefined"&&FarPoint.System.ExtenderHelper.loadExtenderScripts(ss,buff.contentWindow.document)}else{$$(ss).copyInnerHTML(s);the_fpSpread.CopySpreadAttrs(s,ss);typeof Sys!="undefined"&&typeof $get!="undefined"&&FarPoint.System.ExtenderHelper.loadExtenderScripts(ss,buff.contentWindow.document);var initText=buff.contentWindow.document.getElementById(ss.id+"_initScript");eval(initText.value);for(var i=0;i<buff.contentWindow.document.styleSheets.length;i++)if(buff.contentWindow.document.styleSheets[i].rules!=null)for(var j=0;j<buff.contentWindow.document.styleSheets[i].rules.length;j++){for(var ajaxcssRule=buff.contentWindow.document.styleSheets[i].rules[j],deleteHander={styleSheetIndex:-1,ruleIndex:-1},ii=0;ii<doc.styleSheets.length;ii++)for(var jj=0;jj<doc.styleSheets[ii].rules.length;jj++)if(doc.styleSheets[ii].rules[jj].selectorText==ajaxcssRule.selectorText){deleteHander.styleSheetIndex=ii;deleteHander.ruleIndex=jj}deleteHander.styleSheetIndex>-1&&deleteHander.ruleIndex>-1&&doc.styleSheets[deleteHander.styleSheetIndex].deleteRule(deleteHander.ruleIndex);doc.styleSheets[0].addRule(ajaxcssRule.selectorText,ajaxcssRule.style.cssText)}}}else the_fpSpread.error=true};this.LoadRows=function(d,a,f){if(d==null||a==null)return;var c=d.tBodies[0],h=a.rows.length,e=null;if(f){h--;if(c.rows.length>0)e=c.rows[c.rows.length-1]}for(var b=0;b<h;b++){var g=a.rows[b].cloneNode(false);c.insertBefore(g,e);g.innerHTML=a.rows[b].innerHTML}if(!f)for(var b=0;b<a.parentNode.childNodes.length;b++){var i=a.parentNode.childNodes[b];i!=a&&d.parentNode.insertBefore(i.cloneNode(true),null)}};this.CopySpreadAttr=function(d,b,a){var c=d.getAttribute(a),e=b.getAttribute(a);if(c!=null||e!=null)if(c==null)b.removeAttribute(a);else b.setAttribute(a,c)};this.CopySpreadAttrs=function(a,b){this.CopySpreadAttr(a,b,"RetainSelectionBlock");this.CopySpreadAttr(a,b,"AllRowsLoaded");this.CopySpreadAttr(a,b,"totalRowCount");this.CopySpreadAttr(a,b,"pageCount");this.CopySpreadAttr(a,b,"loadOnDemand");this.CopySpreadAttr(a,b,"allowGroup");this.CopySpreadAttr(a,b,"colMove");this.CopySpreadAttr(a,b,"showFocusRect");this.CopySpreadAttr(a,b,"FocusBorderColor");this.CopySpreadAttr(a,b,"FocusBorderStyle");this.CopySpreadAttr(a,b,"FpDefaultEditorID");this.CopySpreadAttr(a,b,"hierView");this.CopySpreadAttr(a,b,"IsNewRow");this.CopySpreadAttr(a,b,"cmdTop");this.CopySpreadAttr(a,b,"ProcessTab");this.CopySpreadAttr(a,b,"AcceptFormula");this.CopySpreadAttr(a,b,"EditMode");this.CopySpreadAttr(a,b,"AllowInsert");this.CopySpreadAttr(a,b,"AllowDelete");this.CopySpreadAttr(a,b,"error");this.CopySpreadAttr(a,b,"ajax");this.CopySpreadAttr(a,b,"autoCalc");this.CopySpreadAttr(a,b,"multiRange");this.CopySpreadAttr(a,b,"rowFilter");this.CopySpreadAttr(a,b,"OperationMode");this.CopySpreadAttr(a,b,"selectedForeColor");this.CopySpreadAttr(a,b,"selectedBackColor");this.CopySpreadAttr(a,b,"anchorBackColor");this.CopySpreadAttr(a,b,"columnHeaderAutoTextIndex");this.CopySpreadAttr(a,b,"SelectionPolicy");this.CopySpreadAttr(a,b,"isFiltering");this.CopySpreadAttr(a,b,"isFilteringCancel");this.CopySpreadAttr(a,b,"FilteringString");this.CopySpreadAttr(a,b,"FilteringCol");this.CopySpreadAttr(a,b,"ShowHeaderSelection");this.CopySpreadAttr(a,b,"EnableRowEditTemplate");this.CopySpreadAttr(a,b,"scrollContent");this.CopySpreadAttr(a,b,"scrollContentColumns");this.CopySpreadAttr(a,b,"scrollContentTime");this.CopySpreadAttr(a,b,"scrollContentMaxHeight");this.CopySpreadAttr(a,b,"currentPageIndex");this.CopySpreadAttr(a,b,"virtualPaging");b.tabIndex=a.tabIndex;if(b.style!=null&&a.style!=null){if(b.style.width!=a.style.width)b.style.width=a.style.width;if(b.style.height!=a.style.height)b.style.height=a.style.height;if(b.style.border!=a.style.border)b.style.border=a.style.border}if(a.getAttribute("expandedRowKeys")!=null&&a.getAttribute("expandedRowKeys")!="")b.setAttribute("expandedRowKeys",a.getAttribute("expandedRowKeys"));else b.removeAttribute("expandedRowKeys")};this.Clone=function(c){var b=document.createElement(c.tagName);b.id=c.id;var a=c.firstChild;while(a!=null){var d=this.Clone(a);b.appendChild(d);a=a.nextSibling}return b};this.FireEvent=function(a,b){if(a==null||b==null)return;var c=a.getAttribute("mcctcelltype")=="true"?a:this.GetTopSpread(a);if(c!=null){b.spread=a;c.dispatchEvent(b)}};this.SyncData=function(i,a,b,g){if(window.fpPostOn!=null){element.LoadState=null;return}this.editing=false;var c=this.CreateEvent("CallBackStart");c.cancel=false;c.command=a;if(g==null)g=false;c.async=g;if(b==null){var l=i.split(":").join("_");b=document.getElementById(l)}if(b!=null){var n=this.GetTopSpread(b);this.FireEvent(b,c)}if(c.cancel){the_fpSpread.ClearCellData(b);return}if(a!=null&&(a.indexOf("SelectView,")==0||a=="Next"||a=="Prev"||a.indexOf("Group,")==0||a.indexOf("Page,")==0))b.LoadState=null;var k=c.async;k&&this.OpenWaitMsg(b);window.fpPostOn=true;if(this.error)a="update";try{var d=document.getElementsByTagName("FORM");if(d==null&&d.length==0)return;d[0].__EVENTTARGET.value=i;d[0].__EVENTARGUMENT.value=encodeURIComponent(a);var f=d[0].action,j;if(f.indexOf("?")>-1)j="&";else j="?";f=f+j;var h;if(a.indexOf("RefreshChart")>=0)h=this.CollectLightData();else h=this.CollectData();var m="",e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");if(e==null)return;e.open("POST",f,k);e.setRequestHeader("Content-Type","application/x-www-form-urlencoded");if(b!=null)window.srcfpspread=b.id;else window.srcfpspread=i;window.fpcommand=a;this.AttachEvent(e,"load",the_fpSpread.ProcessData,false);e.send(h)}catch(c){window.fpPostOn=false;dataBuff=null}};this.CollectData=function(){for(var h=document.getElementsByTagName("FORM"),a,d="fpcallback=true&",f=0;f<h[0].elements.length;f++){a=h[0].elements[f];var e=a.tagName.toLowerCase();if(e=="input"){var b=a.type;if((b=="hidden"||b=="text"||b=="password"||(b=="checkbox"||b=="radio")&&a.checked)&&a.getAttribute("isInvalid")==null)d+=a.name+"="+encodeURIComponent(a.value)+"&"}else if(e=="select"){if(a.childNodes!=null)for(var g=0;g<a.childNodes.length;g++){var c=a.childNodes[g];if(c!=null&&c.tagName!=null&&c.tagName.toLowerCase()=="option"&&c.selected)d+=a.name+"="+encodeURIComponent(c.value)+"&"}}else if(e=="textarea")d+=a.name+"="+encodeURIComponent(a.value)+"&"}return d};this.CollectLightData=function(){for(var c=document.getElementsByTagName("FORM"),a,d="fpcallback=true&",b=0;b<c[0].elements.length;b++){a=c[0].elements[b];var e=a.tagName.toLowerCase();if(e=="input"){var f=a.type;if(f=="hidden")d+=a.name+"="+encodeURIComponent(a.value)+"&"}}return d};this.ClearCellData=function(d){var j=this.GetData(d),i=j.getElementsByTagName("root")[0],g=i.getElementsByTagName("data")[0];if(g==null)return null;if(d.dataBuff!=null){var c=d.dataBuff.firstChild;while(c!=null){var n=c.getAttribute("key"),e=c.firstChild;while(e!=null){var m=e.getAttribute("key"),a=g.firstChild;while(a!=null){var l=a.getAttribute("key");if(n==l){var f=false,b=a.firstChild;while(b!=null){var k=b.getAttribute("key");if(m==k){a.removeChild(b);f=true;break}b=b.nextSibling}if(f)break}a=a.nextSibling}e=e.nextSibling}c=c.nextSibling}}d.dataBuff=null;var h=this.GetCmdBtn(d,"Cancel");h!=null&&this.UpdateCmdBtnState(h,true)};this.StorePostData=function(b){var c=this.GetData(b),d=c.getElementsByTagName("root")[0],a=d.getElementsByTagName("data")[0];if(a!=null)b.dataBuff=a.cloneNode(true)};this.ShowMessage=function(c,e,b,a,d){var g=c.GetRowCount(),f=c.GetColCount();if(b==null||a==null||b<0||b>=g||a<0||a>=f){b=-1;a=-1}this.ShowMessageInner(c,e,b,a,d)};this.HideMessage=function(a,c,b){var f=a.GetRowCount(),e=a.GetColCount();if(c==null||b==null||c<0||c>=f||b<0||b>=e)a.msgList&&a.msgList.centerMsg&&a.msgList.centerMsg.msgBox.IsVisible&&a.msgList.centerMsg.msgBox.Hide();var d=this.GetMsgObj(a,c,b);d&&d.msgBox.IsVisible&&d.msgBox.Hide()};this.ShowMessageInner=function(b,g,f,e,c){var a=this.GetMsgObj(b,f,e);if(a)a.timer&&a.msgBox.Hide();else a=this.CreateMsgObj(b,f,e);var d=a.msgBox;d.Show(b,this,g);if(c&&c>0)a.timer=setTimeout(function(){d.Hide()},c);this.SetMsgObj(b,a)};this.GetMsgObj=function(e,c,d){var b,a=e.msgList;if(a)if(c==-1&&d==-1)b=a.centerMsg;else if(c==-2)b=a.hScrollMsg;else if(d==-2)b=a.vScrollMsg;else if(a[c])b=a[c][d];return b};this.SetMsgObj=function(c,a){var b=c.msgList;if(a.row==-1&&a.col==-1)b.centerMsg=a;else if(a.row==-2)b.hScrollMsg=a;else if(a.col==-2)b.vScrollMsg=a;else{if(!b[a.row])b[a.row]=[];b[a.row][a.col]=a}};var scStyle=null;this.CreateMsgObj=function(f,e,d){var a=document.createElement("div"),c={row:e,col:d,msgBox:a},b=null;if(e!=-2&&d!=-2){a.style.border="1px solid black";a.style.background="yellow";a.style.color="red"}else{a.style.border="1px solid #55678e";a.style.fontSize="small";a.style.background="#E6E9ED";a.style.color="#4c5b7f";this.GetScrollingContentStyle(f);b=scStyle}if(b!=null){if(b.fontFamily!=null)a.style.fontFamily=b.fontFamily;if(b.fontSize!=null)a.style.fontSize=b.fontSize;if(b.fontStyle!=null)a.style.fontStyle=b.fontStyle;if(b.fontVariant!=null)a.style.fontVariant=b.fontVariant;if(b.fontWeight!=null)a.style.fontWeight=b.fontWeight;if(b.backgroundColor!=null)a.style.backgroundColor=b.backgroundColor;if(b.color!=null)a.style.color=b.color}a.style.position="absolute";a.style.overflow="hidden";a.style.display="block";a.style.marginLeft=0;a.style.marginTop=2;a.style.marginRight=0;a.style.marginBottom=0;a.msgObj=c;a.Show=function(c,d,p){var l=d.GetMsgPos(c,this.msgObj.row,this.msgObj.col),q=d.GetCommandBar(c),s=d.GetGroupBar(c);this.style.visibility="visible";this.style.display="block";if(p){this.style.left=""+0+"px";this.style.top=""+0+"px";this.style.width="auto";this.innerHTML=p}var m=false,o=c.style.position=="relative"||c.style.position=="absolute",e=l.top,g=l.left,b=f.offsetParent;while((b.tagName=="TD"||b.tagName=="TR"||b.tagName=="TBODY"||b.tagName=="TABLE")&&b.style.position!="relative"&&b.style.position!="absolute")b=b.offsetParent;if(this.msgObj.row>=0&&this.msgObj.col>=0){if(!o&&m&&b){var j=d.GetLocation(c),k=d.GetLocation(b);e+=j.y-k.y;g+=j.x-k.x;if(b.tagName!="BODY"){e-=d.GetBorderWidth(b,0);g-=d.GetBorderWidth(b,3)}}var h=d.GetViewPortByRowCol(c,this.msgObj.row,this.msgObj.col);!this.parentNode&&h&&h.parentNode&&h.parentNode.insertBefore(a,null);var n=this.offsetWidth;this.style.left=""+g+"px";if(!m&&h&&h.parentNode&&g+n>h.offsetWidth)this.style.width=""+(l.cellWidth-2)+"px";else if(parseInt(this.style.width)!=n)this.style.width=""+n+"px";if(!m&&h!=null&&e>=h.offsetHeight-2)e-=l.cellHeight+this.offsetHeight+3;this.style.top=""+e+"px"}else{if(!o&&b){var j=d.GetLocation(c),k=d.GetLocation(b);e+=j.y-k.y;g+=j.x-k.x;if(b.tagName!="BODY"){e-=d.GetBorderWidth(b,0);g-=d.GetBorderWidth(b,3)}}var i=20;!this.parentNode&&c.insertBefore(a,null);if(this.offsetWidth+i<c.offsetWidth)g+=(c.offsetWidth-this.offsetWidth-i)/(this.msgObj.row==-2?1:2);else this.style.width=""+(c.offsetWidth-i)+"px";if(this.offsetHeight<c.offsetHeight)e+=(c.offsetHeight-this.offsetHeight)/(this.msgObj.col==-2?1:2);if(this.msgObj.col==-2){var r=d.GetColFooter(c);if(r)e-=r.offsetHeight;var q=d.GetCommandBar(c);if(q)e-=q.offsetHeight;e-=i}this.style.top=""+e+"px";this.style.left=""+g+"px"}this.IsVisible=true};a.Hide=function(){this.style.visibility="hidden";this.style.display="none";this.IsVisible=false;if(this.msgObj.timer){clearTimeout(this.msgObj.timer);this.msgObj.timer=null}this.innerHTML=""};return c};this.GetLocation=function(d){if(d.window&&d.window===d||d.nodeType===9)return{x:0,y:0};for(var e=0,f=0,i=null,g=null,b=null,a=d;a;i=a,g=b,a=a.offsetParent){var c=a.tagName;b=this.GetCurrentStyle2(a);if((a.offsetLeft||a.offsetTop)&&!(c==="BODY"&&(!g||g.position!="absolute"))){e+=a.offsetLeft;f+=a.offsetTop}if(i!=null&&b){if(c!="TABLE"&&c!="TD"&&c!="HTML"){e+=parseInt(b.borderLeftWidth)||0;f+=parseInt(b.borderTopWidth)||0}if(c==="TABLE"&&(b.position==="relative"||b.position==="absolute")){e+=parseInt(b.marginLeft)||0;f+=parseInt(b.marginTop)||0}}}b=this.GetCurrentStyle2(d);var h=b?b.position:null;if(!h||h!="absolute")for(var a=d.parentNode;a;a=a.parentNode){c=a.tagName;if(c!="BODY"&&c!="HTML"&&(a.scrollLeft||a.scrollTop)){e-=a.scrollLeft||0;f-=a.scrollTop||0;b=this.GetCurrentStyle2(a);if(b){e+=parseInt(b.borderLeftWidth)||0;f+=parseInt(b.borderTopWidth)||0}}}return{x:e,y:f}};var _borderWidthNames=["borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth"],_borderStyleNames=["borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle"],_borderThicknesses;this.GetBorderWidth=function(b,a){if(!this.GetBorderVisible(b,a))return 0;var c=this.GetCurrentStyle(b,_borderWidthNames[a]);return this.ParseBorderWidth(c)};this.GetBorderVisible=function(b,a){return this.GetCurrentStyle(b,_borderStyleNames[a])!="none"};this.GetWindow=function(a){var b=a.ownerDocument||a.document||a;return b.defaultView||b.parentWindow};this.GetCurrentStyle2=function(a){if(a.nodeType===3)return null;var b=this.GetWindow(a);if(a.documentElement)a=a.documentElement;var c=b&&a!=b?b.getComputedStyle(a,null):a.style;return c};this.GetCurrentStyle=function(b,c,d){var a=null;if(b){if(b.currentStyle)a=b.currentStyle[c];else if(document.defaultView&&document.defaultView.getComputedStyle){var e=document.defaultView.getComputedStyle(b,null);if(e)a=e[c]}if(!a&&b.style.getPropertyValue)a=b.style.getPropertyValue(c);else if(!a&&b.style.getAttribute)a=b.style.getAttribute(c)}if(!a||a==""||typeof a==="undefined")if(typeof d!="undefined")a=d;else a=null;return a};this.ParseBorderWidth=function(d){if(!_borderThicknesses){var c={},a=document.createElement("div");a.style.visibility="hidden";a.style.position="absolute";a.style.fontSize="1px";document.body.appendChild(a);var b=document.createElement("div");b.style.height="0px";b.style.overflow="hidden";a.appendChild(b);var e=a.offsetHeight;b.style.borderTop="solid black";b.style.borderTopWidth="thin";c.thin=a.offsetHeight-e;b.style.borderTopWidth="medium";c.medium=a.offsetHeight-e;b.style.borderTopWidth="thick";c.thick=a.offsetHeight-e;a.removeChild(b);document.body.removeChild(a);_borderThicknesses=c}if(d){switch(d){case"thin":case"medium":case"thick":return _borderThicknesses[d];case"inherit":return 0}var f=this.ParseUnit(d);if(f.type!="px")throw new Error;return f.size}return 0};this.ParseUnit=function(a){if(!a)throw new Error;a=this.Trim(a).toLowerCase();for(var g=a.length,c=-1,f=0;f<g;f++){var b=a.substr(f,1);if((b<"0"||b>"9")&&b!="-"&&b!="."&&b!=",")break;c=f}if(c==-1)throw new Error;var e,d;if(c<g-1)e=this.Trim(a.substring(c+1));else e="px";d=parseFloat(a.substr(0,c+1));if(e=="px")d=Math.floor(d);return{size:d,type:e}};this.GetViewPortByRowCol=function(f,h,g){var b=null,c=null,d=null,e=this.GetViewport(f),a=this.GetCellByRowCol(f,h,g);return e!=null&&this.IsChild(a,e)?e:d!=null&&this.IsChild(a,d)?d:c!=null&&this.IsChild(a,c)?c:b!=null&&this.IsChild(a,b)?b:void 0};this.GetMsgPos=function(b,l,k){if(l<0||k<0)return{left:0,top:0};else{var f=null,c=null,d=null,g=this.GetViewport(b),i=this.GetGroupBar(b),j=document.getElementById(b.id+"_titleBar"),a=this.GetCellByRowCol(b,l,k),e=a.offsetTop+a.offsetHeight,h=a.offsetLeft;if((f!=null||c!=null)&&(this.IsChild(a,d)||this.IsChild(a,g)))if(f!=null)e+=f.offsetHeight;else e+=c.offsetHeight;if((f!=null||d!=null)&&(this.IsChild(a,c)||this.IsChild(a,g)))if(f!=null)h+=f.offsetWidth;else h+=d.offsetWidth;if(g!=null&&(f||c||d)){if(j)e+=j.offsetHeight;if(i)e+=i.offsetHeight;if(this.GetColHeader(b))e+=this.GetColHeader(b).offsetHeight;if(this.GetRowHeader(b))h+=this.GetRowHeader(b).offsetWidth}if(g!=null&&this.IsChild(a,g)){if(c)e-=g.parentNode.scrollTop;if(d)h-=g.parentNode.scrollLeft}if(d!=null&&this.IsChild(a,d))e-=d.parentNode.scrollTop;if(c!=null&&this.IsChild(a,c))h-=c.parentNode.scrollLeft;var m=a.clientHeight,n=a.clientWidth;return{left:h,top:e,cellHeight:m,cellWidth:n}}};this.SyncMsgs=function(a){if(!a.msgList)return;for(i in a.msgList)if(a.msgList[i].constructor==Array)for(j in a.msgList[i])a.msgList[i][j]&&a.msgList[i][j].msgBox&&a.msgList[i][j].msgBox.IsVisible&&a.msgList[i][j].msgBox.Show(a,this)};this.GetCellInfo=function(g,i,h,f){var c=this.GetData(g);if(c==null)return null;var d=c.getElementsByTagName("root")[0];if(d==null)return null;var e=d.getElementsByTagName("state")[0];if(e==null)return null;var b=e.getElementsByTagName("cellinfo")[0];if(b==null)return null;var a=b.firstChild;while(a!=null){if(a.getAttribute("r")==""+i&&a.getAttribute("c")==""+h&&a.getAttribute("pos")==""+f)return a;a=a.nextSibling}return null};this.AddCellInfo=function(f,i,h,e){var a=this.GetCellInfo(f,i,h,parseInt(e));if(a!=null)return a;var c=this.GetData(f),d=c.getElementsByTagName("root")[0];if(d==null)return null;var g=d.getElementsByTagName("state")[0];if(g==null)return null;var b=g.getElementsByTagName("cellinfo")[0];if(b==null)return null;if(document.all!=null)a=c.createNode("element","c","");else{a=document.createElement("c");a.style.display="none"}a.setAttribute("r",i);a.setAttribute("c",h);a.setAttribute("pos",e);b.appendChild(a);return a};this.setCellAttribute=function(a,b,j,g,k,l){if(b==null)return;var f=this.GetRowKeyFromCell(a,b),h=this.GetColKeyFromCell(a,b);if(typeof f=="undefined")return;var d=-1;if(this.IsChild(b,this.GetCorner(a)))d=0;else if(this.IsChild(b,this.GetRowHeader(a)))d=1;else if(this.IsChild(b,this.GetColHeader(a)))d=2;else if(this.IsChild(b,this.GetViewport(a)))d=3;var i=this.AddCellInfo(a,f,h,d);i.setAttribute(j,g);if(!k){var e=this.CreateEvent("DataChanged");e.cell=b;e.cellValue=g;e.row=f;e.col=h;this.FireEvent(a,e)}var c=this.GetCmdBtn(a,"Update");c!=null&&c.getAttribute("disabled")!=null&&this.UpdateCmdBtnState(c,false);c=this.GetCmdBtn(a,"Cancel");c!=null&&c.getAttribute("disabled")!=null&&this.UpdateCmdBtnState(c,false);a.dirty=true;l&&this.UpdateValues(a)};this.updateCellLocked=function(b,c){if(b==null)return;var d=b.getAttribute("FpCellType")=="readonly";if(d==c)return;var a=b.firstChild;while(a!=null){if(typeof a.disabled!="undefined")a.disabled=c;a=a.nextSibling}};this.Cells=function(b,d,c){var a=this.GetCellByRowCol(b,d,c);if(a){a.GetValue=function(){return the_fpSpread.GetValue(b,d,c)};a.SetValue=function(a){if(typeof a=="undefined")return;if(this.parentNode.getAttribute("previewRow")!=null)return;the_fpSpread.SetValue(b,d,c,a);the_fpSpread.SaveClientEditedDataRealTime()};a.GetBackColor=function(){return this.getAttribute("bgColorBak")!=null?this.getAttribute("bgColorBak"):document.defaultView.getComputedStyle(this,"").getPropertyValue("background-color")};a.SetBackColor=function(a){if(typeof a=="undefined")return;this.bgColor=a;this.setAttribute("bgColorBak",a);this.style.backgroundColor=a;the_fpSpread.setCellAttribute(b,this,"bc",a);the_fpSpread.SaveClientEditedDataRealTime()};a.GetForeColor=function(){return document.defaultView.getComputedStyle(this,"").getPropertyValue("color")};a.SetForeColor=function(a){if(typeof a=="undefined")return;this.style.color=a;the_fpSpread.setCellAttribute(b,this,"fc",a);the_fpSpread.SaveClientEditedDataRealTime()};a.GetTabStop=function(){return this.getAttribute("TabStop")!="false"};a.SetTabStop=function(c){var a=new String(c);if(a.toLocaleLowerCase()=="false"){this.setAttribute("TabStop","false");the_fpSpread.setCellAttribute(b,this,"ts","false");the_fpSpread.SaveClientEditedDataRealTime()}else this.removeAttribute("TabStop")};a.GetCellType=function(){var a=the_fpSpread.GetCellType2(this);if(a=="text"||a=="readonly")a=this.getAttribute("CellType2");if(a==null)a="GeneralCellType";return a};a.GetHAlign=function(){var a=document.defaultView.getComputedStyle(this,"").getPropertyValue("text-Align");if(a==""||a=="undefined"||a==null)a=this.style.textAlign;if(a==""||a=="undefined"||a==null)a=this.getAttribute("align");if(a!=null&&a.indexOf("-webkit")!=-1)a=a.replace("-webkit-","");return a};a.SetHAlign=function(a){if(typeof a=="undefined")return;this.style.textAlign=typeof a=="string"?a:a.Name;the_fpSpread.setCellAttribute(b,this,"ha",typeof a=="string"?a:a.Name);the_fpSpread.SaveClientEditedDataRealTime()};a.GetVAlign=function(){var a=document.defaultView.getComputedStyle(this,"").getPropertyValue("vertical-Align");if(a==""||a=="undefined"||a==null)a=this.style.verticalAlign;if(a==""||a=="undefined"||a==null)a=this.getAttribute("valign");return a};a.SetVAlign=function(a){if(typeof a=="undefined")return;this.style.verticalAlign=typeof a=="string"?a:a.Name;the_fpSpread.setCellAttribute(b,this,"va",typeof a=="string"?a:a.Name);the_fpSpread.SaveClientEditedDataRealTime()};a.GetLocked=function(){return a.GetCellType()=="ButtonCellType"||a.GetCellType()=="TagCloudCellType"||a.GetCellType()=="HyperLinkCellType"?a.getAttribute("Locked")=="1":the_fpSpread.GetCellType(this)=="readonly"};a.GetFont_Name=function(){return document.defaultView.getComputedStyle(this,"").getPropertyValue("font-family")};a.SetFont_Name=function(a){if(typeof a=="undefined")return;this.style.fontFamily=a;the_fpSpread.setCellAttribute(b,this,"fn",a);the_fpSpread.SaveClientEditedDataRealTime()};a.GetFont_Size=function(){return document.defaultView.getComputedStyle(this,"").getPropertyValue("font-size")};a.SetFont_Size=function(a){if(typeof a=="undefined")return;if(typeof a=="number")a+="px";this.style.fontSize=a;the_fpSpread.setCellAttribute(b,this,"fs",a);the_fpSpread.SizeSpread(b);the_fpSpread.SaveClientEditedDataRealTime()};a.GetFont_Bold=function(){return document.defaultView.getComputedStyle(this,"").getPropertyValue("font-weight")=="bold"?true:false};a.SetFont_Bold=function(a){if(typeof a=="undefined")return;this.style.fontWeight=a==true?"bold":"normal";the_fpSpread.setCellAttribute(b,this,"fb",new String(a).toLocaleLowerCase());the_fpSpread.SaveClientEditedDataRealTime()};a.GetFont_Italic=function(){return document.defaultView.getComputedStyle(this,"").getPropertyValue("font-style")=="italic"?true:false};a.SetFont_Italic=function(a){if(typeof a=="undefined")return;this.style.fontStyle=a==true?"italic":"normal";the_fpSpread.setCellAttribute(b,this,"fi",new String(a).toLocaleLowerCase());the_fpSpread.SaveClientEditedDataRealTime()};a.GetFont_Overline=function(){return document.defaultView.getComputedStyle(this,"").getPropertyValue("text-decoration").indexOf("overline")>=0?true:false};a.SetFont_Overline=function(c){if(c){var a=new String("overline");if(document.defaultView.getComputedStyle(this,"").getPropertyValue("text-decoration").indexOf("line-through")>=0)a+=" line-through";if(document.defaultView.getComputedStyle(this,"").getPropertyValue("text-decoration").indexOf("underline")>=0)a+=" underline";this.style.textDecoration=a}else{var a=new String("");if(document.defaultView.getComputedStyle(this,"").getPropertyValue("text-decoration").indexOf("line-through")>=0)a+=" line-through";if(document.defaultView.getComputedStyle(this,"").getPropertyValue("text-decoration").indexOf("underline")>=0)a+=" underline";if(a=="")a="none";this.style.textDecoration=a}the_fpSpread.setCellAttribute(b,this,"fo",new String(c).toLocaleLowerCase());the_fpSpread.SaveClientEditedDataRealTime()};a.GetFont_Strikeout=function(){return document.defaultView.getComputedStyle(this,"").getPropertyValue("text-decoration").indexOf("line-through")>=0?true:false};a.SetFont_Strikeout=function(c){if(c){var a=new String("line-through");if(document.defaultView.getComputedStyle(this,"").getPropertyValue("text-decoration").indexOf("overline")>=0)a+=" overline";if(document.defaultView.getComputedStyle(this,"").getPropertyValue("text-decoration").indexOf("underline")>=0)a+=" underline";this.style.textDecoration=a}else{var a=new String("");if(document.defaultView.getComputedStyle(this,"").getPropertyValue("text-decoration").indexOf("overline")>=0)a+=" overline";if(document.defaultView.getComputedStyle(this,"").getPropertyValue("text-decoration").indexOf("underline")>=0)a+=" underline";if(a=="")a="none";this.style.textDecoration=a}the_fpSpread.setCellAttribute(b,this,"fk",new String(c).toLocaleLowerCase());the_fpSpread.SaveClientEditedDataRealTime()};a.GetFont_Underline=function(){return document.defaultView.getComputedStyle(this,"").getPropertyValue("text-decoration").indexOf("underline")>=0?true:false};a.SetFont_Underline=function(c){if(c){var a=new String("underline");if(document.defaultView.getComputedStyle(this,"").getPropertyValue("text-decoration").indexOf("overline")>=0)a+=" overline";if(document.defaultView.getComputedStyle(this,"").getPropertyValue("text-decoration").indexOf("line-through")>=0)a+=" line-through";this.style.textDecoration=a}else{var a=new String("");if(document.defaultView.getComputedStyle(this,"").getPropertyValue("text-decoration").indexOf("overline")>=0)a+=" overline";if(document.defaultView.getComputedStyle(this,"").getPropertyValue("text-decoration").indexOf("line-through")>=0)a+=" line-through";if(a=="")a="none";this.style.textDecoration=a}the_fpSpread.setCellAttribute(b,this,"fu",new String(c).toLocaleLowerCase());the_fpSpread.SaveClientEditedDataRealTime()};return a}return null};this.getDomRow=function(b,f){var e=this.GetRowCount(b);if(e==0)return null;var a=this.GetCellByRowCol(b,f,0);if(a){var d=a.parentNode.rowIndex;if(d>=0){var c=a.parentNode.parentNode.rows[d];if(this.GetSizable(b,c))return c}return null}};this.setRowInfo_RowAttribute=function(b,c,d,g,f){c=parseInt(c);if(c<0)return;var e=this.AddRowInfo(b,c);e.setAttribute(d,g);var a=this.GetCmdBtn(b,"Update");a!=null&&a.getAttribute("disabled")!=null&&this.UpdateCmdBtnState(a,false);a=this.GetCmdBtn(b,"Cancel");a!=null&&a.getAttribute("disabled")!=null&&this.UpdateCmdBtnState(a,false);b.dirty=true;f&&this.UpdateValues(b)};this.Rows=function(a,b){var c=this.getDomRow(a,b);if(c){c.GetHeight=function(){return the_fpSpread.GetRowHeightInternal(a,b)};c.SetHeight=function(d){if(typeof d=="undefined")return;if(d<1)d=1;b=the_fpSpread.GetDisplayIndex(a,b);var c=null;if(the_fpSpread.GetRowHeader(a)!=null)c=the_fpSpread.GetRowHeader(a).rows[b];if(c!=null)c.cells[0].style.posHeight=d;var g=the_fpSpread.GetViewport(a);if(c==null)c=g.rows[b];if(c!=null)c.cells[0].style.posHeight=d;var e=the_fpSpread.AddRowInfo(a,c.getAttribute("FpKey"));if(e!=null)if(typeof c.cells[0].style.posHeight=="undefined")the_fpSpread.SetRowHeight(a,e,d);else the_fpSpread.SetRowHeight(a,e,c.cells[0].style.posHeight);var f=the_fpSpread.GetParentSpread(a);f!=null&&f.UpdateRowHeight(a);the_fpSpread.SynRowHeight(a,the_fpSpread.GetRowHeader(a),g,b,true,false);var h=the_fpSpread.GetTopSpread(a);the_fpSpread.SizeAll(h);the_fpSpread.Refresh(h);the_fpSpread.SaveClientEditedDataRealTime()};return c}return null};this.setColInfo_ColumnAttribute=function(b,c,e,g,f){c=parseInt(c);if(c<0)return;var d=this.AddColInfo(b,c);d.setAttribute(e,g);var a=this.GetCmdBtn(b,"Update");a!=null&&a.getAttribute("disabled")!=null&&this.UpdateCmdBtnState(a,false);a=this.GetCmdBtn(b,"Cancel");a!=null&&a.getAttribute("disabled")!=null&&this.UpdateCmdBtnState(a,false);b.dirty=true;f&&this.UpdateValues(b)};this.Columns=function(b,c){var a={colindex:this.GetColByKey(b,parseInt(c))};if(a){a.GetWidth=function(){return the_fpSpread.GetColWidthFromCol(b,c)};a.SetWidth=function(a){if(typeof a=="undefined")return;the_fpSpread.SetColWidth(b,c,a);the_fpSpread.SaveClientEditedDataRealTime()};return a}return null};this.GetTitleBar=function(b){try{if(document.getElementById(b.id+"_title")==null)return null;var a=document.getElementById(b.id+"_titleBar");if(a!=null)a=document.getElementById(b.id+"_title");return a}catch(c){return null}};this.GetSubTitleBar=function(b){try{if(document.getElementById(b.id+"_subtitle")==null)return null;var a=document.getElementById(b.id+"_titleBar");if(a!=null)a=document.getElementById(b.id+"_subtitle");return a}catch(c){return null}};this.CheckTitleInfo=function(d){var b=this.GetData(d);if(b==null)return null;var c=b.getElementsByTagName("root")[0];if(c==null)return null;var a=c.getElementsByTagName("titleinfo")[0];return a==null?null:a};this.AddTitleInfo=function(d){var a=this.CheckTitleInfo(d);if(a!=null)return a;var b=this.GetData(d),c=b.getElementsByTagName("root")[0];if(c==null)return null;if(document.all!=null)a=b.createNode("element","titleinfo","");else{a=document.createElement("titleinfo");a.style.display="none"}c.appendChild(a);return a};this.setTitleInfo_Attribute=function(b,c,f,d){var e=this.AddTitleInfo(b);e.setAttribute(c,f);var a=this.GetCmdBtn(b,"Update");a!=null&&a.getAttribute("disabled")!=null&&this.UpdateCmdBtnState(a,false);a=this.GetCmdBtn(b,"Cancel");a!=null&&a.getAttribute("disabled")!=null&&this.UpdateCmdBtnState(a,false);b.dirty=true;d&&this.UpdateValues(b)};this.GetTitleInfo=function(b){var a=this.GetTitleBar(b);if(a){a.GetHeight=function(){return this.style.height};a.SetHeight=function(a){this.style.height=parseInt(a)+"px";the_fpSpread.setTitleInfo_Attribute(b,"ht",a);var c=the_fpSpread.GetTopSpread(b);the_fpSpread.SizeAll(c);the_fpSpread.Refresh(c);the_fpSpread.SaveClientEditedDataRealTime()};a.GetVisible=function(){return document.defaultView.getComputedStyle(this,"").getPropertyValue("display")=="none"?false:true;return document.defaultView.getComputedStyle(this,"").getPropertyValue("visibility")};a.SetVisible=function(a){this.style.display=a?"":"none";this.style.visibility=a?"visible":"hidden";the_fpSpread.setTitleInfo_Attribute(b,"vs",new String(a).toLocaleLowerCase());var c=the_fpSpread.GetTopSpread(b);the_fpSpread.SizeAll(c);the_fpSpread.Refresh(c);the_fpSpread.SaveClientEditedDataRealTime()};a.GetValue=function(){return this.textContent};a.SetValue=function(a){this.textContent=""+a;the_fpSpread.setTitleInfo_Attribute(b,"tx",a);the_fpSpread.SaveClientEditedDataRealTime()};return a}return null};this.SaveClientEditedDataRealTime=function(){var a=this.GetPageActiveSpread();if(a!=null){this.SaveData(a);a.dirty=false}a=this.GetPageActiveSheetView();if(a!=null){this.SaveData(a);a.dirty=false}};var strStyle="";this.ShowScrollingContent=function(c,v){var t="Row",m="Column",b="",d=this.GetTopSpread(c),r=d.getAttribute("scrollContentColumns"),x=d.getAttribute("scrollContentMaxHeight"),J=d.getAttribute("scrollContentTime"),n=this.GetViewport(d),z=this.GetColGroup(n),G=this.GetParent(n),p=0;if(c.getAttribute("lcidRow")!=null)t=c.getAttribute("lcidRow");if(c.getAttribute("lcidColumn")!=null)m=c.getAttribute("lcidColumn");if(v){for(var L=G.scrollLeft,k=this.GetColHeader(d),g=0;g<z.childNodes.length;g++){var j=z.childNodes[g];p+=parseInt(j.width);if(p>L)break}var o=null;if(o)g+=this.GetColGroup(o).childNodes.length;if(k){var f=k.rows.length-1;if(c.getAttribute("LayoutMode")==null)f=parseInt(k.getAttribute("ColTextIndex"))?k.getAttribute("ColTextIndex"):k.rows.length-1;var e=this.GetHeaderCellFromRowCol(d,f,g,true);if(e)if(e.getAttribute("FpCellType")=="ExtenderCellType"&&e.getElementsByTagName("DIV").length>0){var C=this.GetEditor(e),D=this.GetFunction("ExtenderCellType_getEditorValue");if(C!=null&&D!=null)b="&nbsp;"+m+":&nbsp;"+D(C)+"&nbsp;"}else if(e.getElementsByTagName("SELECT").length>0){var A=e.getElementsByTagName("SELECT")[0];b="&nbsp;"+m+":&nbsp;"+A[A.selectedIndex].text+"&nbsp;"}else b="&nbsp;"+m+":&nbsp;"+e.innerHTML+"&nbsp;"}if(b.length<=0)b="&nbsp;"+m+":&nbsp;"+(g+1)+"&nbsp;"}else{for(var M=G.scrollTop-d.virtualTop,l=this.GetRowHeader(d),f=0,h=0,y=2,u=0;u<n.rows.length;u++){var i=n.rows[u];p+=i.offsetHeight;if(p>M){if(i.getAttribute("fpkey")==null&&i.getAttribute("previewrow")!="true")f--;else h=i.offsetHeight;break}if(i.getAttribute("fpkey")!=null||i.getAttribute("previewrow")=="true"){f++;h=i.offsetHeight}}var o=null;if(o)f+=o.rows.length;if(c.getAttribute("LayoutMode")==null&&r!=null&&r.length>0){h=h>x?x:h;for(var B=r.split(","),s=false,w=0;w<B.length;w++){var j=parseInt(B[w]);if(j==null||j>=this.GetColCount(c))continue;var a=d.GetCellByRowCol(f,j);if(!a||a.getAttribute("col")!=null&&a.getAttribute("col")!=j)continue;var q=a.getAttribute("group")==1,F=a.parentNode.getAttribute("previewrow")=="true",E=a.getAttribute("RowEditTemplate")!=null,K=this.IsXHTML(c);if(!K&&strStyle==""){this.GetScrollingContentStyle(c);if(scStyle!=null){if(scStyle.fontFamily!=null&&scStyle.fontFamily!="")strStyle+="fontFamily:"+scStyle.fontFamily+";";if(scStyle.fontSize!=null&&scStyle.fontSize!="")strStyle+="fontSize:"+scStyle.fontSize+";";if(scStyle.fontStyle!=null&&scStyle.fontStyle!="")strStyle+="fontStyle:"+scStyle.fontStyle+";";if(scStyle.fontVariant!=null&&scStyle.fontVariant!="")strStyle+="fontVariant:"+scStyle.fontVariant+";";if(scStyle.fontWeight!=null&&scStyle.fontWeight!="")strStyle+="fontWeight:"+scStyle.fontWeight+";";if(scStyle.backgroundColor!=null&&scStyle.backgroundColor!="")strStyle+="backgroundColor:"+scStyle.backgroundColor+";";if(scStyle.color!=null&&scStyle.color!="")strStyle+="color:"+scStyle.color}}if(!s)b+="<div style='overflow:hidden; height:"+h+"px; ScrollingContentWidth'><table cellPadding='0' cellSpacing='0' style='height:"+h+"px;"+(q?"":"table-layout:auto;")+strStyle+"'><tr>";b+="<td style='width:"+(q?0:a.offsetWidth)+"px;'>";y+=a.offsetWidth;if(q)b+="&nbsp;<i>GroupBar:</i>&nbsp;"+a.textContent+"&nbsp;";else if(F)b+="&nbsp;<i>PreviewRow:</i>&nbsp;"+a.textContent+"&nbsp;";else if(E){var I=this.parseCell(c,a);b+="&nbsp;<i>RowEditTemplate:</i>&nbsp;"+I+"&nbsp;"}else{a.getAttribute("fpcelltype")&&this.UpdateCellTypeDOM(a);if(a.getAttribute("fpcelltype")=="MultiColumnComboBoxCellType"&&a.childNodes[0]&&a.childNodes[0].childNodes.length>0&&a.childNodes[0].getAttribute("MccbId"))b+=d.GetValue(f,j);else if(a.getAttribute("fpcelltype")=="RadioButtonListCellType"||a.getAttribute("fpcelltype")=="ExtenderCellType"||a.getAttribute("fpeditorid")!=null){var H=this.parseCell(c,a);b+=H}else b+=a.innerHTML}b+="</td>";s=true;if(q||F||E)break}if(s){b=b.replace("ScrollingContentWidth"," width:"+y+"px; ");b+="</tr></table></div>"}}if(b.length<=0&&l){var g=this.GetColGroup(l).childNodes.length-1;if(c.getAttribute("LayoutMode")==null)g=l.getAttribute("RowTextIndex")?parseInt(l.getAttribute("RowTextIndex"))+1:this.GetColGroup(l).childNodes.length-1;var e=this.GetHeaderCellFromRowCol(c,f,g,false);if(e)b="&nbsp;"+t+":&nbsp;"+e.textContent+"&nbsp;"}if(b.length<=0)b="&nbsp;"+t+":&nbsp;"+(f+1)+"&nbsp;"}if(d.virtualPaging=="true"&&e!=null&&e.textContent=="")return;this.ShowMessageInner(d,b,v?-1:-2,v?-2:-1,J)};this.parseCell=function(e,d){var a=d.innerHTML,c=this.GetTopSpread(e),b=c.id;if(a.length>0){a=a.replace(new RegExp('="'+b,"g"),'="'+b+"src");a=a.replace(new RegExp("name="+b,"g"),"name="+b+"src")}return a};this.UpdateCellTypeDOM=function(b){for(var a=0;a<b.childNodes.length;a++){b.childNodes[a].tagName&&(b.childNodes[a].tagName=="INPUT"||b.childNodes[a].tagName=="SELECT")&&this.UpdateDOM(b.childNodes[a]);b.childNodes[a].childNodes&&b.childNodes[a].childNodes.length>0&&this.UpdateCellTypeDOM(b.childNodes[a])}};this.UpdateDOM=function(a){if(typeof a=="string")a=document.getElementById(a);if(a.type=="select-one")for(var b=0;b<a.options.length;b++)b==a.selectedIndex&&a.options[a.selectedIndex].setAttribute("selected","selected");else if(a.type=="text")a.setAttribute("value",a.value);else if(a.type=="textarea")a.setAttribute("value",a.value);else if(a.type=="checkbox"||a.type=="radio")if(a.checked)a.setAttribute("checked","checked");else a.removeAttribute("checked")};this.GetScrollingContentStyle=function(e){if(scStyle!=null)return;for(var f=document.styleSheets.length,b=0;b<f;b++){for(var d=document.styleSheets[b],c=0;c<d.cssRules.length;c++){var a=d.cssRules[c];if(a.selectorText=="."+e.id+"scrollContentStyle"||a.selectorText=="."+e.id.toLowerCase()+"scrollcontentstyle"){scStyle=a.style;break}}if(scStyle!=null)break}};this.inactiveAllChart=function(b){var a=b;while(a){if(a.activeChartObj!=null){a.activeChartObj.inactiveChart();a.activeChartObj=null}a=a.GetParentSpread(a)}};this.RefreshChart=function(a){if(this.editing)return;this.SaveData(a);var b=a.getAttribute("ajax")!="false";if(b){var c=a.getAttribute("name");this.SyncData(c,"RefreshChart,"+a.activeChartObj.chartID,a)}};this.GetActiveChartObj=function(a){return a.activeChartObj};this.SetActiveChartObj=function(a,b){a.activeChartObj=b;var c=this.CreateEvent("SelectionChanged");this.FireEvent(a,c)};this.SetActiveChart=function(ss,id){var chartContainerID=getChartByChartId(ss,id);if(chartContainerID==null)return;var chartObj=null;try{chartObj=eval(chartContainerID+"_Obj")}catch(e){}if(chartObj!=null)if(!chartObj.isActived){this.editing&&this.EndEdit(ss);ss.ClearSelection();chartObj.inactiveChart();chartObj.activeChart();var btn=this.GetCmdBtn(ss,"Update");btn!=null&&btn.getAttribute("disabled")!=null&&this.UpdateCmdBtnState(btn,false);btn=this.GetCmdBtn(ss,"Copy");btn!=null&&btn.getAttribute("disabled")!=null&&this.UpdateCmdBtnState(btn,true);btn=this.GetCmdBtn(ss,"Paste");btn!=null&&btn.getAttribute("disabled")!=null&&this.UpdateCmdBtnState(btn,true);btn=this.GetCmdBtn(ss,"Clear");btn!=null&&btn.getAttribute("disabled")!=null&&this.UpdateCmdBtnState(btn,true);ss.dirty=true;this.RemoveSelection(ss,-1,-1,-1,-1)}};function getChartByChartId(d,e){for(var c=d.getElementsByTagName("DIV"),b=0;b<c.length;b++){var a=c[b];if(a.id.indexOf("_chartContainer")>0&&a.getAttribute("serverID")==e)return a.id}return null}this.GetActiveChart=function(a){return a.activeChartObj!=null?a.activeChartObj.container:null};this.updateChartURL=function(a,b){if(a.activeChartObj!=null)a.activeChartObj.getChart().src=b.src+"#"+Math.random()};this.updateChartAllImg=function(spread){for(var items=spread.getElementsByTagName("DIV"),i=0;i<items.length;i++){var item=items[i];if(item.id.indexOf("_chartContainer")>0)if(item.getAttribute("selectChart")!="false"){var chartObj=eval(item.id+"_Obj");chartObj.init();chartObj.updateChartImgitem()}}};this.initChartObj=function(spread){for(var items=spread.getElementsByTagName("DIV"),sufix="_chartContainer",initScripts=[],i=0;i<items.length;i++){var item=items[i];if(item.id.indexOf("_chartContainer")>0){var js=item.id+'_Obj = new FarPoint.Web.Spread.SpreadChart(document.getElementById("'+spread.id+'"),document.getElementById("'+item.id+'"));'+item.id+"_Obj.init();";initScripts.push(js)}}for(var i=0;i<initScripts.length;i++)eval(initScripts[i])};this.chartDispose=function(spread){for(var items=spread.getElementsByTagName("DIV"),i=0;i<items.length;i++){var item=items[i];if(item.id.indexOf("_chartContainer")>0)if(item.getAttribute("selectChart")!="false"){var chartObj=eval(item.id+"_Obj");chartObj.dispose()}}spread.activeChartObj=null};this.GetCurrentPageIndex=function(b){var a=parseInt(b.getAttribute("currentPageIndex"));return a!=NaN?a:0}}function ComboBoxCellType_setValue(b,c,i){var g=the_fpSpread.GetCell(b);if(g==null)return;var e=g.getElementsByTagName("SELECT");if(e!=null&&e.length>0)if(c==null){e[0].selectedIndex=-1;e[0].value=""}else e[0].value=c;var f=the_fpSpread.GetCellEditorID(i,g),a=null;if(f!=null&&typeof f!="undefined"){a=the_fpSpread.GetCellEditor(i,f,true);if(a!=null){a.value=c;if(a.selectedIndex>=0&&a.selectedIndex<a.options.length)c=a.options[a.selectedIndex].innerHTML;var d=null;if(b.children)d=b.children;else d=b.childNodes;if(d.length>0&&d[0].tagName&&d[0].tagName.toUpperCase()=="NOBR"){var h=b;b=d[0];if(h.style.removeAttribute)h.style.removeAttribute("display");else h.style.removeProperty("display")}if(c!=null&&c!="")b.innerHTML=c;else b.innerHTML="&nbsp;"}}}function ComboBoxCellType_getValue(g,h){var b=$$.utils.htmlDecode(g.innerHTML),c=the_fpSpread.GetCell(g);if(c!=null&&b==" "&&c.getAttribute("specialValue")!=null)b="";var f=c.getElementsByTagName("SELECT");if(f!=null&&f.length>0)return f[0].value;try{var e=the_fpSpread.GetCellEditorID(h,c),a=null;if(e!=null&&typeof e!="undefined"){a=the_fpSpread.GetCellEditor(h,e,true);if(a!=null){for(var i=a.options.length,d=0;d<i;d++)if($$.utils.htmlDecode(a.options[d].innerHTML)==b)return a.options[d].value;return null}}}catch(j){return null}return b}function CheckBoxCellType_setFocus(b){var a=b.getElementsByTagName("INPUT");a!=null&&a.length>0&&a[0].type=="checkbox"&&a[0].focus()}function CheckBoxCellType_getCheckBoxEditor(b){var a=b.getElementsByTagName("INPUT");return a!=null&&a.length>0&&a[0].type=="checkbox"?a[0]:null}function CheckBoxCellType_isValid(b,a){if(a==null)return"";a=the_fpSpread.Trim(a);return a==""?"":a.toLowerCase()=="true"||a.toLowerCase()=="false"?"":"invalid value"}function CheckBoxCellType_getValue(a,b){return CheckBoxCellType_getEditorValue(a,b)}function CheckBoxCellType_getEditorValue(c){var b=the_fpSpread.GetCell(c),a=CheckBoxCellType_getCheckBoxEditor(b);return a!=null&&a.checked?"true":"false"}function CheckBoxCellType_setValue(d,b){var c=the_fpSpread.GetCell(d),a=CheckBoxCellType_getCheckBoxEditor(c);if(a!=null){a.checked=b!=null&&b.toLowerCase()=="true";return}}function IntegerCellType_getValue(b){var c=b;while(c.firstChild!=null&&c.firstChild.nodeName!="#text")c=c.firstChild;var a=c.innerHTML,g=the_fpSpread.GetCell(b);if(the_fpSpread.Trim(a)=="&nbsp;")return g.getAttribute("whiteSpace")==null?"":" ";b=g;if(b.getAttribute("FpRef")!=null)b=document.getElementById(b.getAttribute("FpRef"));var e=b.getAttribute("groupchar");if(e==null)e=",";var f=a.length;while(true){a=a.replace(e,"");if(a.length==f)break;f=a.length}if(a.charAt(0)=="("&&a.charAt(a.length-1)==")"){var d=b.getAttribute("negsign");if(d==null)d="-";a=d+a.substring(1,a.length-1)}a=the_fpSpread.ReplaceAll(a,"&nbsp;"," ");return a}function IntegerCellType_isValid(f,a){if(a==null||a.length==0)return"";a=the_fpSpread.Trim(a);if(a.length==0)return"";var c=f,j=f.getAttribute("FpRef");if(j!=null)c=document.getElementById(j);var g=c.getAttribute("negsign"),i=c.getAttribute("possign");if(g!=null)a=a.replace(g,"-");if(i!=null)a=a.replace(i,"+");if(a.charAt(a.length-1)=="-")a="-"+a.substring(0,a.length-1);var k=new RegExp("^\\s*[-\\+]?\\d+\\s*$"),b=a.match(k)!=null;if(b)b=!isNaN(a);if(b){var e=c.getAttribute("MinimumValue"),d=c.getAttribute("MaximumValue"),h=parseInt(a);if(e!=null){e=parseInt(e);b=!isNaN(e)&&h>=e}if(b&&d!=null){d=parseInt(d);b=!isNaN(d)&&h<=d}}return!b?c.getAttribute("error")!=null?c.getAttribute("error"):"Integer":""}function IntegerCellType_setValue(c,b){var a=the_fpSpread.GetCell(c,true);if(a.getAttribute("negativeRed"))if(b<0){if(a.style.color!="red"){a.setAttribute("savedColor",a.style.color);a.style.color="red"}}else if(a.getAttribute("savedColor")!=a.style.color)a.style.color=a.getAttribute("savedColor")==null?"":a.getAttribute("savedColor");var d=c;while(d.firstChild!=null&&d.firstChild.nodeName!="#text")d=d.firstChild;c=d;if(b!=null&&b!=""){b=b.replace(" ","");c.innerHTML=b}else c.innerHTML=""}function DoubleCellType_isValid(e,a){if(a==null||a.length==0)return"";var b=e;if(e.getAttribute("FpRef")!=null)b=document.getElementById(e.getAttribute("FpRef"));var f=b.getAttribute("decimalchar");if(f==null)f=".";var d=b.getAttribute("groupchar");if(d==null)d=",";a=the_fpSpread.Trim(a);var c=true;c=a.length==0||a.charAt(0)!=d;if(c){var g=a.length;while(true){a=a.replace(d,"");if(a.length==g)break;g=a.length}}var c=true;if(a.length==0)c=false;else if(c){var j=b.getAttribute("negsign"),k=b.getAttribute("possign"),i=b.getAttribute("MinimumValue"),h=b.getAttribute("MaximumValue");c=the_fpSpread.IsDouble(a,f,j,k,i,h)}return!c?b.getAttribute("error")!=null?b.getAttribute("error"):"Double":""}function DoubleCellType_getValue(b){var c=b;while(c.firstChild!=null&&c.firstChild.nodeName!="#text")c=c.firstChild;var a=c.innerHTML,g=the_fpSpread.GetCell(b);if(the_fpSpread.Trim(a)=="&nbsp;")return g.getAttribute("whiteSpace")==null?"":" ";b=g;if(b.getAttribute("FpRef")!=null)b=document.getElementById(b.getAttribute("FpRef"));var e=b.getAttribute("groupchar");if(e==null)e=",";var f=a.length;while(true){a=a.replace(e,"");if(a.length==f)break;f=a.length}if(a.charAt(0)=="("&&a.charAt(a.length-1)==")"){var d=b.getAttribute("negsign");if(d==null)d="-";a=d+a.substring(1,a.length-1)}a=the_fpSpread.ReplaceAll(a,"&nbsp;"," ");return a}function DoubleCellType_setValue(c,b){var a=the_fpSpread.GetCell(c,true);if(a.getAttribute("negativeRed"))if(b<0){if(a.style.color!="red"){a.setAttribute("savedColor",a.style.color);a.style.color="red"}}else if(a.getAttribute("savedColor")!=a.style.color)a.style.color=a.getAttribute("savedColor")==null?"":a.getAttribute("savedColor");var d=c;while(d.firstChild!=null&&d.firstChild.nodeName!="#text")d=d.firstChild;c=d;if(b!=null&&b!=""){b=b.replace(" ","");c.innerHTML=b}else c.innerHTML=""}function CurrencyCellType_isValid(g,a){if(a!=null&&a.length>0){var b=g;if(g.getAttribute("FpRef")!=null)b=document.getElementById(g.getAttribute("FpRef"));var d=b.getAttribute("currencychar");if(d==null)d="$";a=a.replace(d,"");var f=b.getAttribute("groupchar");if(f==null)f=",";a=the_fpSpread.Trim(a);var c=true;c=a.length==0||a.charAt(0)!=f;if(c){var h=a.length;while(true){a=a.replace(f,"");if(a.length==h)break;h=a.length}}if(a.length==0)c=false;else if(c){var e=b.getAttribute("decimalchar");if(e==null)e=".";var k=b.getAttribute("negsign"),l=b.getAttribute("possign"),j=b.getAttribute("MinimumValue"),i=b.getAttribute("MaximumValue");c=the_fpSpread.IsDouble(a,e,k,l,j,i)}if(!c)return b.getAttribute("error")!=null?b.getAttribute("error"):"Currency ("+d+"100"+e+"10) "}return""}function CurrencyCellType_getValue(b){var d=b;while(d.firstChild!=null&&d.firstChild.nodeName!="#text")d=d.firstChild;var a=d.innerHTML,i=the_fpSpread.GetCell(b);if(the_fpSpread.Trim(a)=="&nbsp;")return i.getAttribute("whiteSpace")==null?"":" ";b=i;if(b.getAttribute("FpRef")!=null)b=document.getElementById(b.getAttribute("FpRef"));var c=b.getAttribute("currencychar");if(c!=null){var g=document.createElement("SPAN");g.innerHTML=c;c=g.innerHTML}if(c==null)c="$";var f=b.getAttribute("groupchar");if(f==null)f=",";a=a.replace(c,"");var h=a.length;while(true){a=a.replace(f,"");if(a.length==h)break;h=a.length}var e=b.getAttribute("negsign");if(e==null)e="-";if(a.charAt(0)=="("&&a.charAt(a.length-1)==")")a=e+a.substring(1,a.length-1);a=the_fpSpread.ReplaceAll(a,"&nbsp;"," ");return a}function CurrencyCellType_setValue(c,b){var a=the_fpSpread.GetCell(c,true);if(a.getAttribute("negativeRed"))if(b<0){if(a.style.color!="red"){a.setAttribute("savedColor",a.style.color);a.style.color="red"}}else if(a.getAttribute("savedColor")!=a.style.color)a.style.color=a.getAttribute("savedColor")==null?"":a.getAttribute("savedColor");var d=c;while(d.firstChild!=null&&d.firstChild.nodeName!="#text")d=d.firstChild;c=d;if(b!=null&&b!=""){b=b.replace(" ","");c.innerHTML=b}else c.innerHTML=""}function RegExpCellType_isValid(c,b){if(b==null||b=="")return"";var a=c;if(c.getAttribute("FpRef")!=null)a=document.getElementById(c.getAttribute("FpRef"));var e=new RegExp(a.getAttribute("fpexpression")),d=b.match(e),f=d!=null&&d.length>0&&b==d[0];return!f?a.getAttribute("error")!=null?a.getAttribute("error"):"invalid":""}function PercentCellType_getValue(f){var a=f;while(a.firstChild!=null&&a.firstChild.nodeName!="#text")a=a.firstChild;if(a.innerHTML=="&nbsp;")return"";a=a.innerHTML;var c=the_fpSpread.GetCell(f),b=c;if(c.getAttribute("FpRef")!=null)b=document.getElementById(c.getAttribute("FpRef"));var e=b.getAttribute("percentchar");if(e==null)e="%";a=a.replace(e,"");var d=b.getAttribute("groupchar");if(d==null)d=",";var g=a.length;while(true){a=a.replace(d,"");if(a.length==g)break;g=a.length}var h=b.getAttribute("negsign"),i=b.getAttribute("possign");a=the_fpSpread.ReplaceAll(a,"&nbsp;"," ");var k=a;if(h!=null)a=a.replace(h,"-");if(i!=null)a=a.replace(i,"+");var j=b.getAttribute("decimalchar");if(j!=null)a=a.replace(j,".");return!isNaN(a)?k:f.innerHTML}function PercentCellType_setValue(c,b){var a=the_fpSpread.GetCell(c,true);if(a.getAttribute("negativeRed"))if(b<0){if(a.style.color!="red"){a.setAttribute("savedColor",a.style.color);a.style.color="red"}}else if(a.getAttribute("savedColor")!=a.style.color)a.style.color=a.getAttribute("savedColor")==null?"":a.getAttribute("savedColor");var d=c;while(d.firstChild!=null&&d.firstChild.nodeName!="#text")d=d.firstChild;c=d;if(b!=null&&b!=""){var e=the_fpSpread.GetCell(c);if(e.getAttribute("FpRef")!=null)e=document.getElementById(e.getAttribute("FpRef"));var f=e.getAttribute("percentchar");if(f==null)f="%";b=b.replace(" ","");b=b.replace(f,"");c.innerHTML=b+f}else c.innerHTML=""}function PercentCellType_isValid(o,a){if(a!=null){var b=the_fpSpread.GetCell(o);if(b.getAttribute("FpRef")!=null)b=document.getElementById(b.getAttribute("FpRef"));var e=b.getAttribute("percentchar");if(e==null)e="%";a=a.replace(e,"");var h=b.getAttribute("groupchar");if(h==null)h=",";var k=a.length;while(true){a=a.replace(h,"");if(a.length==k)break;k=a.length}var n=a,f=b.getAttribute("negsign"),g=b.getAttribute("possign");if(f!=null)a=a.replace(f,"-");if(g!=null)a=a.replace(g,"+");var d=b.getAttribute("decimalchar");if(d!=null)a=a.replace(d,".");var c=!isNaN(a);if(c){var j=b.getAttribute("MinimumValue"),i=b.getAttribute("MaximumValue");if(j!=null||i!=null){var m=parseFloat(j),l=parseFloat(i);c=!isNaN(m)&&!isNaN(l);if(c){if(d==null)d=".";c=the_fpSpread.IsDouble(n,d,f,g,m*100,l*100)}}}if(!c)return b.getAttribute("error")!=null?b.getAttribute("error"):"Percent:(ex, 10"+e+")"}return""}function ListBoxCellType_getValue(g){var e=g.getElementsByTagName("TABLE");if(e.length>0)for(var d=e[0].rows,c=0;c<d.length;c++){var b=d[c].cells[0];if(b.selected=="true"){if(b.attributes.value)return b.attributes.value.value;var a=b;while(a.firstChild!=null)a=a.firstChild;var f=a.nodeValue;return f}}return""}function ListBoxCellType_setValue(g,h){var b=g.getElementsByTagName("TABLE");if(b.length>0){b[0].style.width=g.clientWidth-6+"px";for(var f=b[0].rows,e=0;e<f.length;e++){var a=f[e].cells[0],c=a.attributes.value;if(!c){var d=a;while(d.firstChild!=null)d=d.firstChild;c=d.nodeValue}else c=c.value;if(c==h){a.selected="true";if(b[0].parentNode.getAttribute("selectedBackColor")!="undefined")a.style.backgroundColor=b[0].parentNode.getAttribute("selectedBackColor");if(b[0].parentNode.getAttribute("selectedForeColor")!="undefined")a.style.color=b[0].parentNode.getAttribute("selectedForeColor")}else{a.style.backgroundColor="";a.style.color="";a.selected="";a.bgColor=""}}}}function TextCellType_getValue(c){var b=the_fpSpread.GetCell(c,true);if(b!=null&&b.getAttribute("password")!=null)return b!=null&&b.getAttribute("value")!=null?b.getAttribute("value"):"";else{var a=c,d=the_fpSpread.FindContentTag(a);if(d!=null)a=d;if(a.firstChild==null&&a.value)return a.value;if(c.nodeName!="INPUT")while(a.firstChild!=null&&a.firstChild.nodeName!="#text"&&a.firstChild.nodeName!="BR")a=a.firstChild;if(b==null)b=the_fpSpread.GetCell(c);if(the_fpSpread.Trim(a.innerHTML)=="&nbsp;")return b!=null&&b.getAttribute("whiteSpace")==null?"":" ";var a=$$.utils.htmlDecode(a.innerHTML);if(a.length>1)a=a.replace(/\n\n$/g,"\n");return a}}function TextCellType_setValue(a,b){var e=the_fpSpread.GetCell(a,true);if(e==null)return;if(a.nodeName!="INPUT"){var d=a;while(d.firstChild!=null&&d.firstChild.nodeName!="#text")d=d.firstChild;a=d}var g=the_fpSpread.FindContentTag(a);if(g!=null)a=g;var c=null;if(a.children)c=a.children;else c=a.childNodes;if(c.length>0&&c[0].tagName&&c[0].tagName.toUpperCase()=="NOBR"){var f=a;a=c[0];if(f.style.removeAttribute)f.style.removeAttribute("display");else f.style.removeProperty("display")}if(e.getAttribute("password")!=null)if(b!=null&&b!=""){b=b.replace(" ","");a.innerHTML="";for(var h=0;h<b.length;h++)a.innerHTML+="*";e.setAttribute("value",b)}else{a.innerHTML="";e.setAttribute("value","")}else if(a.tagName=="INPUT"||a.tagName=="TEXTAREA"){if(b==null)b="";if(typeof a.maxLength!="undefined"&&a.maxLength>0)b=b.substring(0,a.maxLength);a.value=b}else{b=$$.utils.htmlEncode(b);if(b!=null&&b.length>3)b=b.replace(/<br>$/g,"<br><br>");a.innerHTML=b}}function TextCellType_isValid(d,e){var a=the_fpSpread.GetSpread(d),f=the_fpSpread.GetCellEditorID(a,d);if(f==null)return;var c=document.getElementById(f),b=-1;if(c!=null&&typeof c.maxLength!="undefined")b=parseInt(c.maxLength);return b>0&&e!=null&&e.length>b?a.getAttribute("lcidError")!=null?a.getAttribute("lcidError"):"error":""}function RadioButtonListCellType_getValue(d){var c=the_fpSpread.GetCell(d,true);if(c==null)return;for(var b=c.getElementsByTagName("INPUT"),a=0;a<b.length;a++)if(b[a].tagName=="INPUT"&&b[a].checked)return b[a].value;return""}function GeneralCellType_getValue(d){var c=the_fpSpread.GetCell(d);if(c==null)return"";var a=d;while(a.firstChild!=null&&a.firstChild.nodeName!="#text")a=a.firstChild;if(a.innerHTML.trim()=="&nbsp;")return c.getAttribute("whiteSpace")==null?"":" ";var b=a.value;if(typeof b=="undefined")if(the_fpSpread.IsHeaderCell(null,c))b=a.textContent.trim();else b=$$.utils.htmlDecode(a.innerHTML);return b}function GeneralCellType_setValue(b,d){var a=the_fpSpread.GetCell(b,true);if(a.getAttribute("negativeRed"))if(d<0){if(a.style.color!="red"){a.setAttribute("savedColor",a.style.color);a.style.color="red"}}else if(a.getAttribute("savedColor")!=a.style.color)a.style.color=a.getAttribute("savedColor")==null?"":a.getAttribute("savedColor");var c=null;if(b.children)c=b.children;else c=b.childNodes;if(c.length>0&&c[0].tagName&&c[0].tagName.toUpperCase()=="NOBR"){var e=b;b=c[0];if(e.style.removeAttribute)e.style.removeAttribute("display");else e.style.removeProperty("display")}if(d!=null)d=$$.utils.htmlEncode(d);b.innerHTML=d}function EmptyCellType_getValue(a){return GeneralCellType_getValue(a)}function TagCloudCellType_getValue(b){var a=b.textContent;if(typeof a!="undefined"&&a!=null&&a.length>0){a=$$.utils.htmlDecode(a);a=the_fpSpread.Trim(a)}else a="";return a}function HyperLinkCellType_getValue(b){var a=b.textContent;if(typeof a!="undefined"&&a!=null&&a.length>0){a=the_fpSpread.ReplaceAll(a,"\n","");a=the_fpSpread.Trim(a)}else a="";return a}function ButtonCellType_getValue(b){var a=b.textContent;if(typeof a!="undefined"&&a!=null&&a.length>0){a=$$.utils.replaceAll(a,"\n","");a=the_fpSpread.Trim(a)}else a="";return a}function RadioButtonListCellType_getEditorValue(a){return RadioButtonListCellType_getValue(a)}function RadioButtonListCellType_setValue(e,c){var d=the_fpSpread.GetCell(e,true);if(d==null)return;if(c!=null)c=the_fpSpread.Trim(c);for(var b=d.getElementsByTagName("INPUT"),a=0;a<b.length;a++)if(b[a].tagName=="INPUT"&&c==the_fpSpread.Trim(b[a].value)){b[a].checked=true;break}else if(b[a].checked)b[a].checked=false}function RadioButtonListCellType_setFocus(d){var c=the_fpSpread.GetCell(d,true);if(c==null)return;var a=c.getElementsByTagName("INPUT");if(a==null)return;for(var b=0;b<a.length;b++)if(a[b].type=="radio"&&a[b].checked){a[b].focus();return}}function MultiColumnComboBoxCellType_setValue(rd,val,ss){var cell=the_fpSpread.GetCell(rd,true);if(cell==null)return;if(ss==null)ss=the_fpSpread.GetSpread(cell);var mccbId=getMccbID(cell,ss);if(mccbId!=null){FarPoint.System.WebControl.MultiColumnComboBoxCellType.CheckInit(mccbId);var editorObj=eval(mccbId+"_Obj");if(editorObj!=null){if(editorObj.GetUseValue()==1)editorObj.SetValueToDataColumn(val);else editorObj.SetValueToTextColumn(val);if(editorObj.GetShowButton()!=1){var text=val;if(val!=null)text=editorObj.GetCurrentText(cell);if(text!=null&&text!="")rd.textContent=text;else rd.innerHTML="&nbsp;"}}}}function getMccbID(d,e){var b=the_fpSpread.GetCellEditorID(e,d);if(b!=null&&typeof b!="undefined"){var c=the_fpSpread.GetCellEditor(e,b,true);if(c!=null&&c.getAttribute("MccbId")!=null)return c.getAttribute("MccbId")}var a=d.getElementsByTagName("DIV");if(a!=null&&a.length>0)if(a[0].getAttribute("MccbId")!=null)return a[0].getAttribute("MccbId");return null}function MultiColumnComboBoxCellType_getValue(rd,ss){var cl=the_fpSpread.GetCell(rd,true);if(cl==null)return null;var mccbId=getMccbID(cl,ss);if(mccbId!=null){FarPoint.System.WebControl.MultiColumnComboBoxCellType.CheckInit(mccbId);var editorObj=eval(mccbId+"_Obj");if(editorObj!=null){editorObj.Value=null;return editorObj.GetCurrentValue(cl)}}return null}function MultiColumnComboBoxCellType_getEditorValue(d){var c=the_fpSpread.GetCell(d,true);if(c==null)return;var a=c.getElementsByTagName("INPUT");if(a!=null&&a.length>0){var b=a[0];return b.getAttribute("UseValue")==1?b.getAttribute("DataValue"):b.value}return null}function MultiColumnComboBoxCellType_setFocus(rd){var cell=the_fpSpread.GetCell(rd),ss=the_fpSpread.GetSpread(cell);if(cell==null)return;var divs=cell.getElementsByTagName("DIV");if(divs!=null&&divs.length>0){var mccbId=divs[0].getAttribute("MccbId");if(mccbId){FarPoint.System.WebControl.MultiColumnComboBoxCellType.CheckInit(mccbId);var editorObj=eval(mccbId+"_Obj");editorObj!=null&&typeof editorObj.FocusForEdit!="undefined"&&editorObj.FocusForEdit()}}}function MultiColumnComboBoxCellType_setEditorValue(rd,editorValue,ss){var cell=the_fpSpread.GetCell(rd,true);if(cell==null)return;var editorID=the_fpSpread.GetCellEditorID(ss,cell),editor=null;if(editorID!=null&&typeof editorID!="undefined"){editor=the_fpSpread.GetCellEditor(ss,editorID,true);if(editor!=null){var mccbId=editor.getAttribute("MccbId");if(mccbId){FarPoint.System.WebControl.MultiColumnComboBoxCellType.CheckInit(mccbId);var editorObj=eval(mccbId+"_Obj");if(editorObj!=null&&editorObj.SetValueToDataColumn!=null)if(editorObj.GetUseValue()==1)editorObj.SetValueToDataColumn(editorValue);else editorObj.SetValueToTextColumn(editorValue)}}}}function TagCloudCellType_getValue(b){var a=b.textContent;if(typeof a!="undefined"&&a!=null&&a.length>0)a=$$.utils.htmlDecode(a);else a="";return a}typeof Sys!="undefined"&&typeof Sys.Application!="undefined"&&Sys.Application.notifyScriptLoaded();function getViewPortSize(b,e){if(!e)e=false;var d=the_fpSpread.GetViewport(b),f=document.getElementById(b.id+"_view"),a={top:b.virtualTop,left:0,right:d.offsetWidth,bottom:b.virtualTop+d.offsetHeight};if(hasChart(b)&&d!=null&&f!=null){var c=FpChartUtil.getUnionChartsBounds(b);if(c){a.right=Math.max(c.right+5,a.right);a.bottom=Math.max(c.bottom+5,a.bottom)}a.width=a.right-a.left;a.height=a.bottom-a.top}else{a.width=a.right-a.left;a.height=a.bottom-a.top}return a}function hasChart(a){return typeof FpChartUtil!=="undefined"&&FpChartUtil.getChartsIdCollection(a).length>0}