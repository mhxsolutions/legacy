//
//	  Copyright (C) 2003-2010 GrapeCity Inc.	All rights reserved.
//

if(!Function.prototype.CreateDelegate)Function.prototype.CreateDelegate=function(a,b){return function(){return b.apply(a,arguments)}};if(!Function.prototype.CreateCallback)Function.prototype.CreateCallback=function(b,a){return function(){var e=arguments.length;if(e>0){for(var d=[],c=0;c<e;c++)d[c]=arguments[c];d[e]=a;return b.apply(this,d)}return b.call(this,a)}};if(!String.prototype.trim)String.prototype.trim=function(){var a=this.match(new RegExp("^\\s*(\\S+(\\s+\\S+)*)\\s*$"));return a==null?"":a[1]};if(!String.prototype.trimEnd)String.prototype.trimEnd=function(){return this.replace(new RegExp("\\s+$"),"")};if(!String.prototype.trimStart)String.prototype.trimStart=function(){return this.replace(new RegExp("^\\s+"),"")};if(typeof FarPoint=="undefined")FarPoint={};FarPoint.System={};FarPoint.System.CheckBrowserByName=function(d){var c=window.navigator.userAgent,b=false,a=(""+d).toLowerCase();if(a.indexOf("ms")>=0||a.indexOf("msie")>=0||a.indexOf("ie")>=0)b=c.indexOf("MSIE")>=1;else if(a.indexOf("safari")>=0||a.indexOf("apple")>=0)b=c.indexOf("Safari")>=1;else if(a.indexOf("ff")>=0||a.indexOf("firefox")>=0)b=c.indexOf("Firefox")>=1;return b};FarPoint.System.IsChild=function(b,c){if(c==null||b==null)return false;var a=c.parentNode;while(a!=null){if(a==b)return true;a=a.parentNode}return false};FarPoint.System.FindElementById=function(b,d,c){if(b==null)return null;var a=b.getAttribute(c);return a==null?null:document.getElementById(a+d)};FarPoint.System.GetEvent=function(a){return a!=null?a:window.event};FarPoint.System.GetTarget=function(a){a=FarPoint.System.GetEvent(a);return a.target==document&&a.currentTarget!=null?a.currentTarget:a.target!=null?a.target:a.srcElement};FarPoint.System.CancelDefault=function(a){if(a.preventDefault!=null){a.preventDefault();a.stopPropagation()}else{a.cancelBubble=true;a.returnValue=false}return false};FarPoint.System.GetMouseCoords=function(a){return a.pageX||a.pageY?{x:a.pageX,y:a.pageY}:{x:a.clientX+document.body.scrollLeft-document.body.clientLeft,y:a.clientY+document.body.scrollTop-document.body.clientTop}};FarPoint.System.GetOffsetTop=function(a){var c=0,b=a;while(a){if(a.tagName!="HTML"&&typeof a.tagName!="undefined")c+=typeof a.offsetTop!="undefined"?a.offsetTop:0;if(typeof a.clientTop=="number")c+=a.clientTop;a=a.offsetParent}while(b){if(b.tagName!="HTML"&&typeof b.tagName!="undefined")c-=typeof b.scrollTop!="undefined"?b.scrollTop:0;b=b.parentNode}return parseInt(c)};FarPoint.System.GetOffsetLeft=function(a){var b=0;while(a){if(a.tagName!="HTML"&&typeof a.tagName!="undefined")b+=typeof a.offsetLeft!="undefined"?a.offsetLeft:0-typeof a.scrollLeft!="undefined"?a.scrollLeft:0;if(typeof a.clientLeft=="number")b+=a.clientLeft;a=a.offsetParent}return parseInt(b)};FarPoint.System.AttachEvent=function(a,c,b,d){if(a==null||c==null||b==null)return;if(a.addEventListener!=null)a.addEventListener(c,b,d);else a.attachEvent!=null&&a.attachEvent("on"+c,b)};FarPoint.System.DetachEvent=function(a,c,b,d){if(a==null||c==null||b==null)return;if(a.removeEventListener!=null)a.removeEventListener(c,b,d);else a.detachEvent!=null&&a.detachEvent("on"+c,b)};FarPoint.System.LinkedNode=function(a){this.index=a;this.value=null;this.prev=null;this.next=null;this.child=null;this.order=-1};FarPoint.System.LinkedNode.prototype={"get":function(d,e){var b=null,a=this;if(d<a.index){while(a.prev!=null&&a.prev.index>=d)a=a.prev;if(!e&&d!=a.index){b=new FarPoint.System.LinkedNode(d);b.next=a;b.prev=a.prev;b.order=a.order;a.prev=b;a.order=b.order+1;var c=a;while(c.next!=null){c.next.order=c.order+1;c=c.next}a=b}}else if(d>a.index){while(a.next!=null&&a.next.index<=d)a=a.next;if(!e&&d!=a.index){b=new FarPoint.System.LinkedNode(d);b.prev=a;b.next=a.next;b.order=a.order+1;a.next=b;var c=b;while(c.next!=null){c.next.order=c.order+1;c=c.next}a=b}}return a.index==d?a:null},childs:function(b){var a=this.child;if(a==null){a=new FarPoint.System.LinkedNode(Number.NEGATIVE_INFINITY);a.value="";this.child=a}return a.get(b)},root:function(){var a=this;while(a.prev!=null)a=a.prev;return a},count:function(){var b=0,a=this.root();while(a.next!=null){b++;a=a.next}return b},toString:function(){var b=this.root(),a,d,c="";while(b.next!=null){b=b.next;if(b.child!=null){a=b.child.next;d=a.value!=null?a.value:"";c+=d;while(a.next!=null){a=a.next;d=a.value!=null?a.value:"";c+="\t"+d}}if(b.next!=null)c+="\r\n"}return c}};FarPoint.System.LinkedNode.load=function(k,j,e){for(var i=k.split("\r\n"),b=new FarPoint.System.LinkedNode(-1),a,g,f,c=0;c<i.length;c++){g=c+j;b=b.get(g);var h=i[c].split("\t");a=b.childs(e);for(var d=0;d<h.length;d++){f=d+e;a=a.get(f);a.value=h[d]}}return b.root()};FarPoint.System.Track=function(c){if(!FarPoint.System.Config.Consts.$FLAG_ISDEBUG)return;if(document.getElementById("txtOutput")==null){var a=document.createElement("textarea");a.id="txtOutput";a.style.width="100%";a.style.height="100px";if(a.style.bottom!=null&&a.style.right!=null){a.style.bottom="0px";a.style.right="0px"}a.style.color="#00ff00";a.style.position="absolute";a.style.backgroundColor="black";if(FarPoint.System.CheckBrowserByName("IE"))window.onload=function(){document.all&&document.body.readyState=="complete"&&document.body.appendChild(a)};else document.body.appendChild(a)}var b=document.getElementById("txtOutput");if(b!=null)b.value="&nbsp;&nbsp;"+c+"\r\n"+b.value};FarPoint.System.Config={};FarPoint.System.Config.Consts={};var fpSCConsts=FarPoint.System.Config.Consts;fpSCConsts.$FLAG_ISDEBUG=false;fpSCConsts.$LEFT=37;fpSCConsts.$RIGHT=39;fpSCConsts.$UP=38;fpSCConsts.$DOWN=40;fpSCConsts.$ENTER=13;fpSCConsts.$CANCEL=27;fpSCConsts.$PageUp=33;fpSCConsts.$PageDown=34;fpSCConsts.$Home=36;fpSCConsts.$End=35;fpSCConsts.$Tab=9;FarPoint.System.WebControl={};FarPoint.System.WebControl.MultiColumnComboBoxCellTypeUtilitis={};var fpSWMccbctUtilitis=FarPoint.System.WebControl.MultiColumnComboBoxCellTypeUtilitis,fpSWMccbctUConsts=fpSWMccbctUtilitis.Consts={$ATTRI_MULTICOMBO_PART_TYPE:"MccbPartType",$ATTRI_LIST_ALIGNMENT:"MccbListAlignment",$ATTRI_LIST_OFFSET:"MccbListOffset",$ATTRI_LIST_WIDTH:"MccbListWidth",$ATTRI_LIST_HEIGHT:"MccbListHEIGHT",$ATTRI_COLUMN_EDIT:"MccbColumnEdit",$ATTRI_COLUMN_DATA:"MccbColumnData",$ATTRI_ID:"MccbId",$ATTRI_LIST_MIN_HEIGHT:"MccbListMinHeight",$ATTRI_LIST_MIN_WIDTH:"MccbListMinWidth",$TYPE_DROPDOWNBUTTON:"DropDownButton",$ID_BUTTON_OUTSIDE:"_DropDownButtonOutside",$ID_BUTTON_INSIDE:"_DropDownButtonInside",$ID_INPUT:"_Input",$ID_CONTAINER:"_Container",$ID_CONTAINER_DIV:"_ContainerDiv",$ID_SPREAD:"_FpSpread",$ID_STATUS_RESIZE:"_ResizeButton",$OBJECT_SUFFIX:"_Obj"};fpSWMccbctUtilitis.CloseAll=function(){var a=document.body.lastChild;if(a!=null&&a.tagName!=null&&a.tagName=="DIV")a.id!=null&&a.close&&a.id.match(new RegExp(fpSWMccbctUConsts.$ID_CONTAINER_DIV+"$"))&&a.close()};FarPoint.System.WebControl.MultiColumnComboBoxCellType=function(m){this.mcID=m;this.mc=document.getElementById(m);if(this.mc==null)return null;var f=true,a=null,l=false,k=false,c=-1,h=0,g=false,i=0,j=0,e=50,d=200,n=false,b=this;this.getLoadState=function(){var a=this.getFpSpread(),b=!f&&a!=null&&typeof a.isInitialized!="undefined";return b};this.Init=function(){if(f){this.InitSpread();this.setController();(!$$.browser.ie||$$.browser.version<9)&&this.AttachEvents();this.Value=null;this.Text=null;var a=this.getControl(),b=FarPoint.System.FindElementById(a,fpSWMccbctUConsts.$ID_BUTTON_INSIDE,fpSWMccbctUConsts.$ATTRI_ID);if(a!=null&&b!=null)if(a.offsetHeight-5>0)b.style.height=a.offsetHeight-5;this.setListWidth(parseInt(this.getControl().getAttribute(fpSWMccbctUConsts.$ATTRI_LIST_WIDTH)));this.setListHeight(parseInt(this.getControl().getAttribute(fpSWMccbctUConsts.$ATTRI_LIST_HEIGHT)));a.Init=true;f=false}};this.DetachEvents=function(){if(a!=null){var b=0;while(b<12){this.SetHandler(a,b,1);b++}}};this.AttachEvents=function(){var b=0;while(b<12){if(b==0||b==1||b==3){b++;continue}if(a[b]!=null&&a[b].event=="SelectionChanged")if($$.browser.ie){if($$.browser.version<9)this.getFpSpread().onSelectionChanged=a[b].handler;else $$.utils.attachEvent(this.getFpSpread(),"SelectionChanged",a[b].handler);b++;continue}this.SetHandler(a,b,0);b++}};this.Dispose=function(){var d=this.getController();if(!d)return;var b=0;while(a[b]!=null){if(a[b].event=="SelectionChanged"){var c=$$.browser;if(c.ie){this.getFpSpread().onSelectionChanged=null;c.version>=9&&$$.utils.detachEvent(this.getFpSpread(),"SelectionChanged",a[b].handler);b++;continue}}this.SetHandler(a,b,1);b++}};this.getDragOffsetX=function(){return i};this.setDragOffsetX=function(a){i=a};this.getDragOffsetY=function(){return j};this.setDragOffsetY=function(a){j=a};this.getStatusBarHeight=function(){return 13};this.getIsDrag=function(){return g};this.setIsDrag=function(c){var b=12;g=c;if(g)this.SetHandler(a,b,0);else this.SetHandler(a,b,1)};this.getHostSpread=function(){var b=this.getFpSpread();if(b==null)return null;var a=null;if($$.browser.ie&&$$.browser.version<=8)a=b.hostspread;else a=b.getAttribute("hostspread");return document.getElementById(a)};this.getControl=function(){if(this.mc==null||this.mc.parentNode==null||this.mc.offsetParent==null||typeof this.mc.parentNode.tagName=="undefined"||$$.browser.ie&&$$.browser.quirksMode)this.mc=document.getElementById(this.mcID);return this.mc};this.getFpSpread=function(){var a=this.getContainer();return a==null?null:a.getElementsByTagName("div")[0]};this.getContainer=function(){var a=this.getControl();return a==null?null:FarPoint.System.FindElementById(a,fpSWMccbctUConsts.$ID_CONTAINER,fpSWMccbctUConsts.$ATTRI_ID)};this.getContainerDiv=function(){var a=this.getControl();return a==null?null:FarPoint.System.FindElementById(a,fpSWMccbctUConsts.$ID_CONTAINER_DIV,fpSWMccbctUConsts.$ATTRI_ID)};this.getInputControl=function(){var a=this.getControl();return a==null?null:FarPoint.System.FindElementById(a,fpSWMccbctUConsts.$ID_INPUT,fpSWMccbctUConsts.$ATTRI_ID)};this.getResizeButton=function(){var a=this.getControl();return a==null?null:FarPoint.System.FindElementById(a,fpSWMccbctUConsts.$ID_STATUS_RESIZE,fpSWMccbctUConsts.$ATTRI_ID)};this.getController=function(){return a};this.setController=function(){if(a==null){a={1:{target:document,event:"mousedown",handler:function(a){b.MouseDownOutside(a)},useCapture:false},3:{target:document,event:"mouseup",handler:function(a){b.MouseUpOutside(a)},useCapture:false},12:{target:document,event:"mousemove",handler:function(a){b.MouseMove(a)},useCapture:false},4:{target:this.getControl(),event:"mousedown",handler:function(a){b.MouseDown(a)},useCapture:false},7:{target:this.getInputControl(),event:"keydown",handler:function(a){b.OnInputKeyDown(a)},useCapture:FarPoint.System.CheckBrowserByName("IE")?false:true},6:{target:this.getContainer(),event:"mousedown",handler:function(a){b.CancelEvent(a)},useCapture:false},9:{target:this.getFpSpread(),event:"SelectionChanged",handler:function(a){b.OnSpreadSelectionChanged(a)},useCapture:false},8:{target:this.getResizeButton(),event:"mousedown",handler:function(a){b.ResizeButtonMouseDown(a)},useCapture:false}};var c=$$.browser;if(c.ie&&$$.browser.version<9?typeof this.getFpSpread().EnableClientScript=="undefined":this.getFpSpread().getAttribute("EnableClientScript")==null){var d=c.ie&&c.version>=9?"Scroll":"scroll";a[13]={target:FarPoint.System.CheckBrowserByName("IE")?this.getHostSpread():the_fpSpread.GetViewport(this.getHostSpread()).parentNode,event:d,handler:function(a){b.MccbctScroll(a)},useCapture:false}}}};this.getIsDrop=function(){return l};this.setIsDrop=function(a){l=a};this.getIsDroping=function(){return k};this.setIsDroping=function(a){k=a};this.getListAlignment=function(){try{var a=this.getControl().getAttribute(fpSWMccbctUConsts.$ATTRI_LIST_ALIGNMENT);return parseInt(a)}catch(b){return 0}};this.getListOffset=function(){try{var a=this.getControl().getAttribute(fpSWMccbctUConsts.$ATTRI_LIST_OFFSET);return parseInt(a)}catch(b){return 0}};this.getListWidth=function(){return e};this.setListWidth=function(a){if(a<this.getListMinWidth()&&a!=-1)e=this.getListMinWidth();else{if(!FarPoint.System.CheckBrowserByName("IE"))if(a>2e3)a=2e3;e=a}};this.getListHeight=function(){return d};this.setListHeight=function(a){if(a<this.getListMinHeight())d=this.getListMinHeight();else d=a};this.getListMinWidth=function(){try{var a=this.getControl().getAttribute(fpSWMccbctUConsts.$ATTRI_LIST_MIN_WIDTH);return Math.min(Math.abs(parseInt(a)),32767)}catch(b){return 50}};this.getListMinHeight=function(){try{var a=this.getControl().getAttribute(fpSWMccbctUConsts.$ATTRI_LIST_MIN_HEIGHT);return Math.min(Math.abs(parseInt(a)),32767)}catch(b){return 50}};this.getEditColumnIndex=function(){try{var a=this.getControl().getAttribute(fpSWMccbctUConsts.$ATTRI_COLUMN_EDIT);return parseInt(a)}catch(b){return 0}};this.setSelectedIndex=function(a){c=a};this.getSelectedIndex=function(){if(c!=-1){var a=this.getFpSpread(),b=FarPoint.System.CheckBrowserByName("IE")?parseInt(a.ActiveRow):parseInt(a.GetActiveRow());if(a)b>=0&&this.setSelectedIndex(b)}return c};this.setActiveColumnIndex=function(a){h=a};this.getActiveColumnIndex=function(){return h};this.getDataColumnIndex=function(){try{var a=this.getControl().getAttribute(fpSWMccbctUConsts.$ATTRI_COLUMN_DATA);return parseInt(a)}catch(b){return 0}};this.getWorkEnvironment=function(){try{var a=this.getControl().getAttribute("environment");if(a==null)a=-1;return parseInt(a)}catch(b){return-1}};this.FocusForEdit=function(){var b=this.getControl();if(b==null)return;if(b.parentNode==null||typeof b.parentNode.tagName=="undefined")return;if(b.parentNode.tagName!="TD")return;if(b.parentNode.getAttribute("FpCellType")!="MultiColumnComboBoxCellType")return;var c=this.getInputControl();if(c!=null){try{c.focus();c.select()}catch(d){}this.SetHandler(a,7,1);this.SetHandler(a,7,0)}};this.LockFocus=function(){if(this.mc==null)return;var a=this.getInputControl();if(a!=null&&typeof a.focus!="undefined")if(a!=null)try{a.focus();a.select()}catch(b){}};this.MouseDown=function(a){if(this.getControl().getAttribute("disabled")=="disabled")return FarPoint.System.CancelDefault(a);var b=$$.browser;if(!this.getIsDrop()&&a.button!=(b.ie?1:0)&&!(b.ie&&b.version>=9&&a.button<=1))return;var c=FarPoint.System.GetTarget(a);if(c==null||c.getAttribute(fpSWMccbctUConsts.$ATTRI_MULTICOMBO_PART_TYPE)!=fpSWMccbctUConsts.$TYPE_DROPDOWNBUTTON)return false;this.setIsDroping(true);var d=this;setTimeout(function(){d.DropDown()},0)};this.DropDown=function(){this.ShowHideContainer(!this.getIsDrop())};this.OnInputKeyDown=function(a){if(a.altKey&&a.keyCode==fpSCConsts.$DOWN){this.ShowHideContainer(!this.getIsDrop());FarPoint.System.CancelDefault(a);return false}$$.browser.ie&&$$.browser.version<8&&!this.getIsDrop()&&(a.keyCode==fpSCConsts.$PageUp||a.keyCode==fpSCConsts.$PageDown||a.keyCode==fpSCConsts.$Home||a.keyCode==fpSCConsts.$End)&&FarPoint.System.CancelDefault(a);switch(a.keyCode){case fpSCConsts.$UP:if(this.getIsDrop()){this.ChangeSelectedIndex(-1);var b=this.getFpSpread();if(!FarPoint.System.CheckBrowserByName("IE"))the_fpSpread.ScrollTo(b,b.GetActiveRow(),this.getActiveColumnIndex());else b.ScrollTo(b.ActiveRow,this.getActiveColumnIndex());FarPoint.System.CheckBrowserByName("IE")&&FarPoint.System.CancelDefault(a)}!FarPoint.System.CheckBrowserByName("IE")&&FarPoint.System.CancelDefault(a);break;case fpSCConsts.$LEFT:if(this.getIsDrop()){this.ChangedActiveColumnIndex(true);FarPoint.System.CancelDefault(a)}break;case fpSCConsts.$DOWN:if(this.getIsDrop()){this.ChangeSelectedIndex(1);var b=this.getFpSpread();if(!FarPoint.System.CheckBrowserByName("IE"))the_fpSpread.ScrollTo(b,b.GetActiveRow(),this.getActiveColumnIndex());else b.ScrollTo(b.ActiveRow,this.getActiveColumnIndex());FarPoint.System.CheckBrowserByName("IE")&&FarPoint.System.CancelDefault(a)}!FarPoint.System.CheckBrowserByName("IE")&&FarPoint.System.CancelDefault(a);break;case fpSCConsts.$RIGHT:if(this.getIsDrop()){this.ChangedActiveColumnIndex(false);FarPoint.System.CancelDefault(a)}break;case fpSCConsts.$ENTER:if(this.getIsDrop()){this.ShowHideContainer(false);FarPoint.System.CancelDefault(a)}if(!FarPoint.System.CheckBrowserByName("safari")&&this.getFpSpread().getAttribute("EnableClientScript")=="0")return FarPoint.System.CancelDefault(a);break;case fpSCConsts.$CANCEL:this.getIsDrop()&&this.ShowHideContainer(false);FarPoint.System.CancelDefault(a);break;case fpSCConsts.$PageUp:if(this.getIsDrop()){this.ChangeSelectedIndex(null,1);var b=this.getFpSpread();if(!FarPoint.System.CheckBrowserByName("IE"))the_fpSpread.ScrollTo(b,b.GetActiveRow(),this.getActiveColumnIndex());else b.ScrollTo(b.ActiveRow,this.getActiveColumnIndex());FarPoint.System.CheckBrowserByName("IE")&&FarPoint.System.CancelDefault(a)}!FarPoint.System.CheckBrowserByName("IE")&&FarPoint.System.CancelDefault(a);break;case fpSCConsts.$PageDown:if(this.getIsDrop()){this.ChangeSelectedIndex(null,2);var b=this.getFpSpread();if(!FarPoint.System.CheckBrowserByName("IE"))the_fpSpread.ScrollTo(b,b.GetActiveRow(),this.getActiveColumnIndex());else b.ScrollTo(b.ActiveRow,this.getActiveColumnIndex());FarPoint.System.CheckBrowserByName("IE")&&FarPoint.System.CancelDefault(a)}!FarPoint.System.CheckBrowserByName("IE")&&FarPoint.System.CancelDefault(a);break;case fpSCConsts.$Home:if(this.getIsDrop()){this.ChangeSelectedIndex(null,3);var b=this.getFpSpread();if(!FarPoint.System.CheckBrowserByName("IE"))the_fpSpread.ScrollTo(b,b.GetActiveRow(),this.getActiveColumnIndex());else b.ScrollTo(b.ActiveRow,this.getActiveColumnIndex());FarPoint.System.CheckBrowserByName("IE")&&FarPoint.System.CancelDefault(a)}!FarPoint.System.CheckBrowserByName("IE")&&FarPoint.System.CancelDefault(a);break;case fpSCConsts.$End:if(this.getIsDrop()){this.ChangeSelectedIndex(null,4);var b=this.getFpSpread();if(!FarPoint.System.CheckBrowserByName("IE"))the_fpSpread.ScrollTo(b,b.GetActiveRow(),this.getActiveColumnIndex());else b.ScrollTo(b.ActiveRow,this.getActiveColumnIndex());FarPoint.System.CheckBrowserByName("IE")&&FarPoint.System.CancelDefault(a)}!FarPoint.System.CheckBrowserByName("IE")&&FarPoint.System.CancelDefault(a);break;case fpSCConsts.$Tab:if(this.getIsDrop()){this.ShowHideContainer(false);if(!FarPoint.System.CheckBrowserByName("IE")){FarPoint.System.CancelDefault(a);if(FarPoint.System.CheckBrowserByName("FF")){var c=this.getControl().getElementsByTagName("input")[1];if(c!=null){var d=document.createEvent("KeyboardEvent");d.initKeyEvent("keydown",true,true,null,null,null,null,null,9,null);setTimeout(function(){c.dispatchEvent(d)},0)}}}}}};this.OnSpreadSelectionChanged=function(e){if(this.getWorkEnvironment()==0)return;var b=this.getFpSpread();if(b==null)return;if(!FarPoint.System.CheckBrowserByName("IE"))this.setSelectedIndex(b.GetActiveRow());else this.setSelectedIndex(b.ActiveRow);var a=this.getInputControl();if(a==null)return;if(this.getSelectedIndex()>=0&&this.getEditColumnIndex()>=0&&this.getDataColumnIndex()>=0){a.value=b.GetValue(this.getSelectedIndex(),this.getEditColumnIndex());this.Text=a.value;if(this.GetUseValue()==1)this.Value=b.GetValue(this.getSelectedIndex(),this.getDataColumnIndex());else this.Value=a.value;a.setAttribute("DataValue",b.GetValue(this.getSelectedIndex(),this.getDataColumnIndex()));var c=this.getControl(),d=false;if(c!=null&&c.parentNode!=null&&c.parentNode.getAttribute("FpCellType")=="MultiColumnComboBoxCellType")d=true;e!=null&&d&&a.select()}FarPoint.System.GetEvent(e).cancelBubble=true};this.CancelEvent=function(a){if(this.getIsDrop()){this.LockFocus(a);var b=this;setTimeout(function(){b.LockFocus(a)},0)}return FarPoint.System.CancelDefault(a)};this.MouseDownOutside=function(d){this.getIsDrag()&&this.setIsDrag(false);var e=this.getContainerDiv(),a=this.getControl(),b=this.getFpSpread();if(a==null||b==null)return;var g=document.getElementById(b.id+"_viewport"),c=FarPoint.System.GetTarget(d);if(!FarPoint.System.IsChild(e,c)&&!FarPoint.System.IsChild(a,c)){this.setIsDroping(false);this.getIsDrop()&&this.ShowHideContainer(false)}var f=this;setTimeout(function(){f.LockFocus(d)},0)};this.MouseUpOutside=function(d){var a=FarPoint.System.GetTarget(d),b=this.getControl(),c=this.getFpSpread();if(b==null||c==null)return;if(this.getIsDroping()&&FarPoint.System.IsChild(b,a)){this.setIsDroping(false);return}if(this.getIsDrop()==false)return;if(this.getIsDrag()){this.setIsDrag(false);return}var e=this.getContainerDiv(),g=document.getElementById(c.id+"_viewport");(FarPoint.System.IsChild(g,a)||!FarPoint.System.IsChild(e,a))&&this.ShowHideContainer(false);var f=this;setTimeout(function(){f.LockFocus(d)},0)};this.ResizeButtonMouseDown=function(a){this.LockFocus(a);if(a.button!=(FarPoint.System.CheckBrowserByName("IE")?1:0)&&!($$.browser.ie&&$$.browser.version>=9&&a.button<=1))return;var b=this.getContainer();if(b==null)return;var c=FarPoint.System.GetMouseCoords(a);this.setDragOffsetX(parseInt(b.offsetLeft+b.offsetWidth)-c.x);this.setDragOffsetY(parseInt(b.offsetTop+b.offsetHeight)-c.y);this.setIsDrag(true);a.preventDefault&&a.preventDefault();a.returnValue=false;a.cancelBubble=true;return false};this.MouseMove=function(g){if(!this.getIsDrag())return;var a=this.getContainer();if(a==null)return;var d=this.getContainerDiv();if(d==null)return;var f=FarPoint.System.GetMouseCoords(g),c=f.x-parseInt(a.offsetLeft)+this.getDragOffsetX(),b=f.y-parseInt(a.offsetTop)+this.getDragOffsetY()-5;if(c>this.getListMinWidth()&&Math.abs(c-a.offsetWidth)>5){d.style.width=c+"px";a.style.width=c+"px";this.setListWidth(c+5)}if(b>this.getListMinHeight()&&Math.abs(b-a.offsetHeight)>20){var e=this.getFpSpread();if(e!=null)e.style.height=""+(b-this.getStatusBarHeight())+"px";d.style.height=b+5+"px";a.style.height=b+"px";this.setListHeight(b)}if(!FarPoint.System.CheckBrowserByName("IE")){var h=this.getFpSpread();the_fpSpread.SizeSpread(h);the_fpSpread.Refresh(h)}g.cancelBubble=true;return false};this.MccbctScroll=function(c){var a=this.getControl();if(a==null)return;var g=this.getContainer();if(g==null)return;var b=this.getContainerDiv();if(b==null)return;var f=c.srcElement?c.srcElement:c.target;if(f&&!FarPoint.System.IsChild(b,c.srcElement)){this.ShowHideContainer(false);return}if(FarPoint.System.CheckBrowserByName("safari")&&a.offsetHeight==0)b.style.top=FarPoint.System.GetOffsetTop(a)+25-this.GetSpreadClientData(this.getHostSpread(),1)+"px";else{var d=null;if(FarPoint.System.CheckBrowserByName("IE")?typeof this.getFpSpread().EnableClientScript=="undefined":this.getFpSpread().getAttribute("EnableClientScript")==null)d=FarPoint.System.CheckBrowserByName("IE")?document.getElementById(this.getHostSpread().id+"_view"):document.getElementById(this.getHostSpread().id+"_viewport").parentNode;var e=FarPoint.System.IsChild(d,a)?this.GetSpreadClientData(this.getHostSpread(),1):0;b.style.top=FarPoint.System.GetOffsetTop(a)+a.offsetHeight+2-e+"px"}};this.GetAdjustorForScroll=function(){var h=0,i=0,n=new String(this.getControl().getAttribute(fpSWMccbctUConsts.$ATTRI_ID)),b=n.split(new RegExp("_"))[3],a=this.getHostSpread(),e=FarPoint.System.CheckBrowserByName("IE"),m=FarPoint.System.CheckBrowserByName("safari"),c={left:0,top:0};if(this.getFpSpread().getAttribute("EnableClientScript")=="0")return c;h=a.GetActiveRow();i=a.GetActiveCol();if(m){if(b!="sc"&&b!="rh")c.left=this.GetSpreadClientData(a,0);if(b!="ch"&&b!="cf"&&b!="sc")c.top=this.GetSpreadClientData(a,1);return c}var o=e?a.getViewport():the_fpSpread.GetViewport(a),j=e?a.getViewport0():the_fpSpread.GetViewport0(a),k=e?a.getViewport1():the_fpSpread.GetViewport1(a),l=e?a.getViewport2():the_fpSpread.GetViewport2(a),g=0,d=0;g=e?k!=null?k.rows.length:0:a.frzRows;if(e){if(j!=null){var f=j.getElementsByTagName("COLGROUP");if(f!=null&&f.length>0)d=f[0].childNodes.length}else if(l!=null){var f=l.getElementsByTagName("COLGROUP");if(f!=null&&f.length>0)d=f[0].childNodes.length}}else d=a.frzCols;if(b!="ch"&&b!="cf"&&b!="sc"&&(g>0&&h+1>g||g==0))c.top=this.GetSpreadClientData(a,1);if(b!="sc"&&b!="rh"&&(d>0&&i+1>d||d==0))c.left=this.GetSpreadClientData(a,0);return c};this.InitSpread=function(){if(!FarPoint.System.CheckBrowserByName("IE")&&typeof the_fpSpread!="undefined"){var a=this.getFpSpread();the_fpSpread.Init(a);the_fpSpread.SizeAll(a);a.dispose=function(){the_fpSpread.Dispose(a)}}};this.IsContained=function(a){return FarPoint.System.IsChild(this.getControl(),a)||FarPoint.System.IsChild(this.getContainer(),a)};this.GetActivePositonInDomTree=function(a){if(a==null)return false;while(a!=null&&a!=document.body){if(a.tagName=="TR"&&a.getAttribute("FpSpread")!=null)return a.getAttribute("FpSpread");a=a.parentNode}return""};this.GetSpreadClientData=function(c,f){if(this.getFpSpread().getAttribute("EnableClientScript")=="0")return 0;var b="",a=0,d=null,g=null;if(FarPoint.System.CheckBrowserByName("ie")){if(c.GetParentSpread()!=null)return;if(typeof c.getXmlDataObject=="function")g=c.getXmlDataObject();else d=document.getElementById(c.id+"_XMLDATA");switch(f){case 0:b="/root/scrollLeft";break;case 1:b="/root/scrollTop"}var a=d!=null?d.documentElement.selectSingleNode(b):g.selectSingleNode(b,true);if(a!=null&&a.text!="")a=parseInt(a.text)}else{if(the_fpSpread.GetParentSpread(c)!=null)return;d=the_fpSpread.GetData(c);var h=d.getElementsByTagName("root")[0];switch(f){case 0:b="scrollLeft";break;case 1:b="scrollTop"}var e=h.getElementsByTagName(b)[0];if(e!=null&&e.innerHTML!="")a=parseInt(e.innerHTML)}if(isNaN(a))a=0;return a};this.SetHandler=function(b,a,c){if(isNaN(a)||a<0)return;if(typeof b[a]=="undefined"||b[a]==null)return;switch(c){case 0:FarPoint.System.DetachEvent(b[a].target,b[a].event,b[a].handler,b[a].useCapture);FarPoint.System.AttachEvent(b[a].target,b[a].event,b[a].handler,b[a].useCapture);break;case 1:FarPoint.System.DetachEvent(b[a].target,b[a].event,b[a].handler,b[a].useCapture)}};this.ChangeSelectedIndex=function(g,f){var e=0;if(typeof f!="undefined")e=f;var d=this.getFpSpread();if(!d)return;var b=d.GetRowCount();if(b<=0)return;var a=this.getSelectedIndex(),c=this.getActiveColumnIndex();if(c<0)c=0;switch(e){case 0:a+=g;if(a<0||a>=b)return;break;case 1:a-=5;a=Math.max(a,0);break;case 2:a+=5;a=Math.min(a,b-1);break;case 3:a=0;break;case 4:a=b-1}this.setSelectedIndex(a);d.SetActiveCell(a,c)};this.ChangedActiveColumnIndex=function(e){var b=this.getFpSpread();if(!b)return;var c=b.GetColCount();if(c<=0)return;var d=FarPoint.System.CheckBrowserByName("IE")?b.ActiveRow:b.GetActiveRow(),a=this.getActiveColumnIndex();if(isNaN(a))a=0;a=e?a-1:a+1;if(a<0||a>=c){a=Math.max(a,0);a=Math.min(a,c-1);this.setActiveColumnIndex(a);return}if(FarPoint.System.CheckBrowserByName("IE"))b.ScrollTo(d,a);else the_fpSpread.ScrollTo(b,d,a);this.setActiveColumnIndex(a)};this.ShowHideContainer=function(e){var d=this.getControl();if(d==null)return;var g=this.getContainer();if(g==null)return;var c=this.getContainerDiv();if(c==null)return;if(!FarPoint.System.CheckBrowserByName("IE")){c.style.display=e?"block":"none";c.style.visibility=e?"visible":"hidden"}if(e){if(window.fpPostOn){this.ShowHideContainer(false);return}c.style.zIndex=9999999;g.style.height=this.getListHeight()+"px";c.style.height=this.getListHeight()+5+"px";var j=this.GetAdjustorForScroll(),w=this.getHostSpread(),m=w.offsetParent;j.top+=m.scrollTop;j.left+=m.scrollLeft;if(FarPoint.System.CheckBrowserByName("safari")){var s=d.offsetHeight==0?25:d.offsetHeight;c.style.top=FarPoint.System.GetOffsetTop(d)+s+m.scrollTop+"px"}else c.style.top=FarPoint.System.GetOffsetTop(d)+d.offsetHeight+"px";var p=$$.browser,k=p.ie&&p.version>=9?$$(d).offset().left:FarPoint.System.GetOffsetLeft(d);if(this.getListAlignment()==0)k+=this.getListOffset();else{var n=0;if(this.getListWidth()!=-1)n=this.getListWidth()-d.parentNode.offsetWidth;k-=this.getListOffset()+n}if(!isNaN(j.left))c.style.left=k-j.left+"px";else c.style.left=k+"px";var l=this.getListWidth();if(l<0)l=Math.max(this.getListMinWidth(),d.parentNode.offsetWidth);g.style.width=l+5+"px";c.style.width=l+5+"px";var o=this.findContainer(),r=this.getWorkEnvironment();if(o!=null&&r==0)o.appendChild(c);else document.body.appendChild(c);var v=this;c.close=function(){v.ShowHideContainer(false)};this.SetHandler(a,1,0);this.SetHandler(a,3,0);this.SetHandler(a,13,0)}else{c.style.zIndex=0;c.close=null;d.appendChild(c);c.style.top=-1e4;c.style.left=-1e4;this.SetHandler(a,1,1);this.SetHandler(a,3,1);this.SetHandler(a,13,1)}var b=this.getFpSpread();if(e&&b!=null){if(document.documentMode){b.style.backgroundColor="white";b.style.position="relative"}b.style.height=parseInt(g.style.height)-this.getStatusBarHeight()+"px"}this.setIsDrop(e);if(!FarPoint.System.CheckBrowserByName("IE")){if(b!=null){var i=the_fpSpread.GetColHeader(b);if(i!=null&&FarPoint.System.CheckBrowserByName("Firefox"))i.parentNode.style.height=""+(i.offsetHeight-parseInt(i.cellSpacing))+"px";the_fpSpread.SizeAll(b);the_fpSpread.SizeAll(b);if(e){if(this.getFpSpread().getAttribute("EnableClientScript")!="0"){the_fpSpread.SetPageActiveSpread(b);the_fpSpread.SetActiveSpreadID(b,b.id,b.id,false)}var q=this.getSelectedIndex();b.SetActiveCell(q,0);this.setActiveColumnIndex(0);b.GetActiveRow()>-1&&the_fpSpread.ScrollTo(b,b.GetActiveRow(),0)}else{var h=this.getHostSpread();if(this.getFpSpread().getAttribute("EnableClientScript")!="0"){the_fpSpread.SetPageActiveSpread(h);the_fpSpread.SetActiveSpreadID(h,h.id,h.id,false)}}}}else if(e){var q=this.getSelectedIndex();b.SetActiveCell(q,0);this.setActiveColumnIndex(0);b.ActiveRow>-1&&b.ScrollTo(b.ActiveRow,0)}if(e){var u=this;setTimeout(function(){u.AnimShow(g)},30)}var f=this.getInputControl();if(f!=null)try{f.focus();f.select();f.value.length>0&&this.getSelectedIndex()==-1&&this.SetText(f.value)}catch(x){}if(FarPoint.System.CheckBrowserByName("IE")){c.style.display=e?"block":"none";c.style.visibility=e?"visible":"hidden";document.documentMode&&b.sizeSpread()}if(c.style.display!="none"){var t=this;setTimeout(function(){t.LockFocus()},100)}};this.findContainer=function(){var c=this.getFpSpread(),a=c,b;if(c!=null)while(a!=null&&a.tagName!="FORM"&&typeof a.tagName!="undefined"){b=a;a=a.parentElement}return b};this.AnimShow=function(a){var b=a.offsetTop;if(b>=0)return;var d=b<-5?b*.25:0;a.style.top=d+"px";var c=this;setTimeout(function(){c.AnimShow(a)},30)};this.SetText=function(c,e){var a=this.getFpSpread();if(a==null)return;var g=this.getEditColumnIndex();if(e!=null&&e==0)g=this.getDataColumnIndex();var d=this.getInputControl();if(c==null){if(d!=null){d.value="";d.setAttribute("DataValue","");this.Text=null;this.setSelectedIndex(-1)}a.SetActiveCell(-1,-1);return}var i=c.match(new RegExp("^\\s*(\\S+(\\s+\\S+)*)\\s*$"));c=i==null?"":i[1];if(c.length==1&&c.charCodeAt(0)==160||c==""||c.length<=0){if(d!=null){d.value="";d.setAttribute("DataValue","");this.Text=null;this.setSelectedIndex(-1)}a.SetActiveCell(-1,-1);return}if(!FarPoint.System.CheckBrowserByName("IE")&&typeof a.GetRowCount=="undefined"){var f=0,b=-1;while(f<the_fpSpread.spreads.length&&b==-1){if(the_fpSpread.spreads[f].id==a.id)b=f;f++}the_fpSpread.spreads.splice(b,1);the_fpSpread.Init(document.getElementById(a.id));document.getElementById(a.id).dispose=function(){the_fpSpread.Dispose(document.getElementById(a.id))}}if(!FarPoint.System.CheckBrowserByName("IE"))c=c.replace(new RegExp(" ","g"),String.fromCharCode(32));for(var l=a.GetRowCount(),b=0;b<l;b++)try{var h=a.GetValue(b,g);if(c==h.trim()){var k=this.getEditColumnIndex(),j=this.getDataColumnIndex();this.Text=e==0?a.GetValue(b,k):h;this.Value=e==0?h:a.GetValue(b,j);this.setSelectedIndex(b);if(d!=null)d.value=this.Text;a.SetActiveCell(b,g);break}}catch(m){return}};this.GetUseValue=function(){try{var a=this.getControl().getAttribute("UseValue");if(a==null)a=0;return parseInt(a)}catch(b){return 0}};this.GetShowButton=function(){try{var a=this.getControl().getAttribute("ShowButton");if(a==null)a=0;return parseInt(a)}catch(b){return 0}};this.SetValueToDataColumn=function(a){this.SetText(a,0)};this.SetValueToTextColumn=function(a){this.SetText(a,1)};this.getValue=function(g,c){var a=this.getFpSpread();if(a==null)return;var e=this.getDataColumnIndex(),f=this.getEditColumnIndex(),h=g==0?e:f,k=a.GetRowCount(),d=null;if(c==null){var i=this.getSelectedIndex();d=i>=0&&h>=0?a.GetValue(i,h):null}else for(var b=0;b<k;b++){var j=a.GetValue(b,f);if(j==(FarPoint.System.CheckBrowserByName("IE")?c:the_fpSpread.Trim(c))){d=g==0?a.GetValue(b,e):j;break}}return d};this.GetCurrentValue=function(a){if(this.Value==null){this.updateTextToCell(a);this.Value=this.GetUseValue()==1?this.getValue(0):this.getValue(1)}return this.Value};this.updateTextToCell=function(b){var c=null,a=b.getElementsByTagName("INPUT");if(a!=null&&a.length>0)c=a[0].value;else c=FarPoint.System.CheckBrowserByName("IE")?b.innerText:b.textContent;this.SetValueToTextColumn(c)};this.GetCurrentText=function(a){if(this.Text==null){this.updateTextToCell(a);this.Text=this.getValue(1)}return this.Text};this.GetValueFromDataColumn=function(a){return this.getValue(0,a)};this.GetValueFromTextColumn=function(a){return this.getValue(1,a)};this.GetValueByText=function(b){this.SetValueToTextColumn(b);var a=this.getValue(0);return a};this.GetTextByValue=function(a){this.SetValueToDataColumn(a);var b=this.getValue(1);return b};this.TestProps=function(){!fpSCConsts.$FLAG_ISDEBUG};this.Init()};FarPoint.System.WebControl.MultiColumnComboBoxCellType.CheckInit=function(id){var ctl=document.getElementById(id);if(ctl==null){ctl=document.getElementById(id+"Editor");id+="Editor"}if(ctl&&ctl.Init)return;try{var obj=eval(id+fpSWMccbctUConsts.$OBJECT_SUFFIX);if(obj){obj.Dispose();delete obj}}catch(exception){}var js=id+fpSWMccbctUConsts.$OBJECT_SUFFIX+" = new FarPoint.System.WebControl.MultiColumnComboBoxCellType('"+id+"');";eval(js)};FarPoint.System.WebControl.MultiColumnComboBoxCellType.GetMcctId=function(d){var c="",b=document.getElementById(d);if(b!=null){var a=b.parentNode;while(a!=null&&a.tagName!="BODY"){if(a.getAttribute("FpEditor")!=null){c=a.id;break}a=a.parentNode}}return c};FarPoint.System.WebControl.MultiColumnComboBoxCellType.GetMcctObject=function(c){var a=FarPoint.System.WebControl.MultiColumnComboBoxCellType.GetMcctId(c),b=null;if(a.length>0){FarPoint.System.WebControl.MultiColumnComboBoxCellType.CheckInit(a);b=window[a+fpSWMccbctUConsts.$OBJECT_SUFFIX]}return b};FarPoint.System._ExtenderHelper=function(){this.ScriptHolderID="__PAGESCRIPT";this.ScriptBlockID="__SCRIPTBLOCK";this.StartupScriptID="__STARTUPSCRIPT";this.ExpandosID="__EXPANDOSCRIPT";this.ArrayDeclares="__ARRAYDECLARES";this.CssLinksID="__CSSLINKS"};FarPoint.System._ExtenderHelper.prototype={getExtenderScripts:function(){for(var extenderScripts={},inputs=document.getElementsByTagName("input"),i=0;i<inputs.length;i++){var match=inputs[i].id.match(new RegExp("^(.+)_extender$"));if(match&&match.length==2){var spreadID=match[1],ownerSpread=$get(spreadID);if(ownerSpread&&(ownerSpread.FpSpread=="Spread"||ownerSpread.getAttribute("FpSpread")=="Spread")){var json=inputs[i].json||inputs[i].getAttribute("json"),tmp=eval("("+json+")");this.mergeExtenderScripts(extenderScripts,tmp.extenderScripts)}}}return extenderScripts},mergeExtenderScripts:function(b,e){for(var a in e){var c=e[a];if(!b[a])b[a]=c;else for(var d=0;d<c.length;d++){var f=c[d];!Array.contains(b[a],f)&&b[a].push(f)}}},getNeededExtenderScripts:function(f,e,d){var h=[],g=[];for(var i in f)Array.addRange(h,f[i]);for(var i in d)Array.addRange(g,d[i]);for(var b=[],c=0;c<e.length;c++){var a=e[c];if(!Array.contains(g,a)&&Array.contains(h,a))b.push(a);else!this.checkInclude(a)&&(a.indexOf("_TSM_CombinedScripts_")>=0||a.indexOf("_TSM_HiddenField_")>=0)&&b.push(a)}return b},checkInclude:function(b){for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var a=d[c].getAttribute("src");if(b==a)return true;else if(a&&a.indexOf("_TSM_CombinedScripts_")>=0&&a.indexOf("_TSM_HiddenField_")>=0&&b.indexOf("_TSM_CombinedScripts_")>=0&&b.indexOf("_TSM_HiddenField_")>=0)return true}return false},get_scriptHolder:function(){var a=$get(this.ScriptHolderID);if(!a){a=document.createElement("div");a.id=this.ScriptHolderID;a.style.display="none";document.body.appendChild(a)}return a},saveLoadedExtenderScripts:function(d,e){var b=this.get_scriptHolder();b.innerHTML="";var c=this.getExtenderScripts(),a=b.loaded;if(!a)a={};this.mergeExtenderScripts(a,c);b.loaded=a;typeof FpExtender!="undefined"&&e!="LoadOnDemand"&&FpExtender.Util.disposeExtenders(d)},processCss:function(buff){var head=document.getElementsByTagName("head");if(!head){head=document.createElement("head");document.documentElement.insertBefore(head,document.body)}else head=head[0];var curCssLinks=[],links=head.getElementsByTagName("link");if(links)for(var i=0;i<links.length;i++){var link=links[i];link.getAttribute("type")=="text/css"&&curCssLinks.push(link.getAttribute("href"))}var cssLinks=$get(this.CssLinksID,buff);if(cssLinks){cssLinks=eval("("+cssLinks.value+")");cssLinks=cssLinks.cssLinks;for(var i=0;i<cssLinks.length;i++){var cssLink=cssLinks[i];if(!Array.contains(curCssLinks,cssLink)){var link=document.createElement("link");link.type="text/css";link.rel="stylesheet";link.href=cssLink;head.appendChild(link)}}}},loadExtenderScripts:function(spread,buff){Sys.Browser.agent!=Sys.Browser.InternetExplorer&&this.processCss(buff);var scriptInfo=[],realExtenderScripts=[],scriptBlock=$get(this.ScriptBlockID,buff);if(scriptBlock){var pattern=new RegExp('<script src="(.+)" type="text\\/javascript"><\\/script>',"gm"),result;while((result=pattern.exec(scriptBlock.value))!=null)realExtenderScripts.push(result[1])}for(var newExtenderScripts=this.getExtenderScripts(),holder=this.get_scriptHolder(),needed=this.getNeededExtenderScripts(newExtenderScripts,realExtenderScripts,holder.loaded),i=0;i<needed.length;i++)scriptInfo.push({src:needed[i]});for(var startupScript=$get(this.StartupScriptID,buff),expandoScript=$get(this.ExpandosID,buff),ArrayDeclareScript=$get(this.ArrayDeclares,buff),scriptLoader=Sys._ScriptLoader.getInstance(),i=0;i<scriptInfo.length;i++){var src=scriptInfo[i].src;src&&scriptLoader.queueScriptReference(src)}scriptLoader.loadScripts(0,function(){if(ArrayDeclareScript&&typeof FpExtender!=="undefined"){var oldValidators=[],hasPageValidators=typeof Page_Validators!="undefined"&&Page_Validators!=null;if(hasPageValidators)for(var i=0;i<Page_Validators.length;i++){var validator=Page_Validators[i];if(validator!=null&&validator.id!="")validator=document.getElementById(validator.id);validator!=null&&oldValidators.push(validator)}try{eval(ArrayDeclareScript.value)}catch(e){}if(hasPageValidators){for(var i=0;i<Page_Validators.length;i++){var validator=Page_Validators[i];if(validator==null)continue;for(var f=false,j=0;j<oldValidators.length;j++)if(oldValidators[j]==validator){f=true;break}!f&&oldValidators.push(validator)}Page_Validators=oldValidators}}if(expandoScript&&typeof FpExtender!=="undefined")try{eval(expandoScript.value)}catch(e){}if(startupScript&&typeof FpExtender!=="undefined"){for(var inited=false,initScripts=FpExtender.Util.getExtenderInitScripts(spread,startupScript.value),i=0;i<initScripts.length;i++){try{eval(initScripts[i])}catch(e){}if(initScripts[i].indexOf("Sys.Application.initialize")!=-1)inited=true}if(!inited){var comps=Sys.Application.getComponents();for(var i in comps)comps[i].get_id().indexOf(spread.id)==0&&FpExtender.ContainerBehavior.isInstanceOfType(comps[i])&&comps[i]._load()}}},function(){},null)}};FarPoint.System.ExtenderHelper=new FarPoint.System._ExtenderHelper;function FpSpread(a){var b=null;if(typeof a=="string")return document.getElementById(a);else if(typeof a.getAttribute!="undefined")b=a.getAttribute("FpSpread");if(b==null)b=a.FpSpread;return b=="Spread"?a:null}typeof Sys!="undefined"&&typeof Sys.Application!="undefined"&&Sys.Application.notifyScriptLoaded();(function(b){var c=b.document,n=l();function l(){var a=navigator.userAgent,g=false,l=false,o=false,n=false,d,k=false,h=-1,i=-1;if(a.indexOf(" MSIE ")>-1){g=true;d=c.documentMode||parseFloat(a.match(new RegExp("MSIE (\\d+\\.\\d+)"))[1])}else if(a.indexOf(" Firefox/")>-1){l=true;d=parseFloat(a.match(new RegExp(" Firefox\\/(\\d+\\.\\d+)"))[1])}else if(a.indexOf(" AppleWebKit/")>-1){n=true;d=parseFloat(a.match(new RegExp(" AppleWebKit\\/(\\d+(\\.\\d+)?)"))[1])}else if(a.indexOf("Opera/")>-1)o=true;var e=false;if(c.documentMode&&c.documentMode==5)e=true;else if(c.compatMode&&c.compatMode=="BackCompat")e=true;else{var p=c.createElement("div",{style:"position:absolute;width:0;height:0;width:1"});if(p.style.width=="1px")e=true}var f;if(g)if(c.documentMode){var m=a.match(/trident\/(\d+)/i),j=m!=null?m[1]:null;if(j!=null)f=parseInt(j)>=5?9:8;else f=8}else f=d;if(a.indexOf("(Windows;")>-1){k=true;var b=a.match(/\sWindows\sNT\s([\d.]+);/gi);if(b.length>0){b=b[0].trim().split(" ");if(b.length>2){b=b[2].split(".");h=parseInt(b[0]);i=parseInt(b[1])}}}return{ie:g,mozilla:l,opera:o,webkit:n,version:d,ieversion:f,quirksMode:e,windowOS:k,OSMajorVersion:h,OSMinorVersion:i}}var f=function(a){if(a!=null)if(typeof a=="object")return a;else if(typeof a=="string")return a.length==0?null:c.getElementById(a);else try{return c.getElementById(a)}catch(b){return null}else return null},e=function(a,e){var d;if(a.currentStyle)d=a.currentStyle[e];else if(b.getComputedStyle)d=c.defaultView.getComputedStyle(a,null).getPropertyValue(e);else if(a.style)d=a.style[e];return d},j=function(a){var b=$$.constants.style;return(parseFloat(e(a,b.borderTopWidth))||0)+(parseFloat(e(a,b.borderBottomWidth))||0)},g=function(a){var b=$$.constants.style;return(parseFloat(e(a,b.borderLeftWidth))||0)+(parseFloat(e(a,b.borderRightWidth))||0)},m=function(a){var b=$$.constants.style,c={top:parseFloat(e(a,b.borderTopWidth))||0,bottom:parseFloat(e(a,b.borderBottomWidth))||0,left:parseFloat(e(a,b.borderLeftWidth))||0,right:parseFloat(e(a,b.borderRightWidth))||0};return c},h=function(b,h,g,d,f){var a=0,c=$$.constants.style;if(h)a+=parseFloat(e(b,c.paddingTop))||0;if(d)a+=parseFloat(e(b,c.paddingBottom))||0;if(g)a+=parseFloat(e(b,c.paddingLeft))||0;if(f)a+=parseFloat(e(b,c.paddingRight))||0;return a};function d(a){this.element=f(a);return this}d.prototype.border=function(a,b){var f=a.length;if(f>1){if(a=="all")return m(this.element);var d=$$.browser;if(arguments.length<1||!b)if(d.ie)a=a.substr(0,1).toUpperCase()+a.substr(1).toLowerCase();else a=a.toLowerCase();var c=$$.browser.ie?"border"+a+"Width":"border-"+a+"-width";return parseFloat(e(this.element,c))||0}return 0};function k(c,a){if(a!=null)for(var b in a)if(c.getAttribute(b)!=a[b])return false;return true}d.prototype.getParent=function(i,h,f){var b=0;if(arguments.length>0)b=arguments[0];var a=this.element.parentNode;if(typeof b=="string"){b=b.toLowerCase();var c=0;if(arguments.length>1)c=arguments[1];var d=0;while(a!=null){if(!a.tagName)return null;if(a.tagName.toLowerCase()==b)if(k(a,f))d++;if(d>c)break;a=a.parentNode}}else for(var g=b,e=g;e>0;e--){a=a.parentNode;if(a==null)break}return a};d.prototype.offset=function(b){var e,d;b=b||this.element;var f=b.ownerDocument,a=f.body;if(b==a){e=a.offsetTop;d=a.offsetLeft}else{var h=b.getBoundingClientRect(),c=f.documentElement,j=c.clientTop||a.clientTop||0,i=c.clientLeft||a.clientLeft||0,g=$$.browser.quirksMode;e=h.top+(self.pageYOffset||g&&c.scrollTop||a.scrollTop)-j;d=h.left+(self.pageXOffset||g&&c.scrollLeft||a.scrollLeft)-i}return{top:e,left:d}};d.prototype.outerHeight=function(){var b=this.element;if(arguments.length==0)return b.offsetHeight;else{var c=this.getAppliedHeight(arguments[0]);b.style.height=c>=0?c+"px":"";var e=0;if(arguments.length>=3)e=arguments[2];var a="";if(arguments.length>=4){a=arguments[3];if(a!=null&&a.length>0){a=a.toString().toLowerCase();a=","+a+","}}if(arguments.length>=2)for(var f=arguments[1],d=0;d<f;d++){b=b.parentNode;if(d<e)continue;if(b!=null&&a.indexOf(b.tagName.toLowerCase())==-1){if(c<0)c=0;b.style.height=c+"px"}else return}}};d.prototype.outerWidth=function(){var a=this.element,b=$$.browser;if(arguments.length==0)return b.ie&&b.version==8?a.clientWidth+g(a):a.offsetWidth;else{var f=h(a,false,true,false,true),i=g(a),e=f+i,c=arguments[0],d=a.tagName.toLowerCase();if(!b.quirksMode&&d!="tr"&&!(d=="textarea"&&b.ie&&b.version<8))c-=e;if(c<0)c=0;a.style.width=c+"px"}};d.prototype.getBorderHeight=function(){return j(this.element)};d.prototype.innerHeight=function(){var a=this.element;if(arguments.length==0)return $$.browser.ie&&$$.browser.version==8?a.clientHeight:a.clientHeight;else{var b=arguments[0];if(!$$.browser.quirksMode&&a.tagName.toLowerCase()!="tr"&&a.tagName.toLowerCase()!="td"){var c=this.outerHeight(),e=b!=c;if(e&&!$$.browser.mozilla)b+=c-this.innerHeight();else{var f=h(a,true,false,true,false),g=j(a),d=f+g;b+=d}}this.outerHeight(b)}};d.prototype.innerWidth=function(){var a=this.element;if(arguments.length==0)return $$.browser.ie&&$$.browser.version==8?a.clientWidth:a.clientWidth;else{var d=h(a,false,true,false,true),e=g(a),c=d+e,b=arguments[0];if(!$$.browser.quirksMode&&a.tagName.toLowerCase()!="tr"&&a.tagName.toLowerCase()!="td")b+=c;a.style.width=b+"px"}};d.prototype.clientLocation=function(){var a=this.element,d=$$.browser,b,c;if(d.mozilla&&d.version<3){b=a.offsetLeft+$$(a).border("left");c=a.offsetTop+$$(a).border("top")}else{b=this.element.clientLeft;c=this.element.clientTop}return{x:b,y:c}};d.prototype.isClass=function(b,a){a=a||this.element;return Object.prototype.toString.call(a).slice(8,-1)==b};d.prototype.copyInnerHTML=function(a){if(a==null)return;this.element.innerHTML=a.innerHTML;$$.utils.cloneChildrenProperties(a,this.element)};d.prototype.style=function(a){return e(this.element,a)};b.$$=function(a){return new d(a)};b.$$.get=function(a){if(b.$$._instance==null)b.$$._instance=new d(a);else b.$$._instance.element=f(a);return b.$$._instance};b.$$.browser=n;b.$$.constants={};b.$$.constants.style={borderTopWidth:$$.browser.ie?"borderTopWidth":"border-top-width",borderBottomWidth:$$.browser.ie?"borderBottomWidth":"border-bottom-width",borderLeftWidth:$$.browser.ie?"borderLeftWidth":"border-left-width",borderRightWidth:$$.browser.ie?"borderRightWidth":"border-right-width",paddingTop:$$.browser.ie?"paddingTop":"padding-top",paddingBottom:$$.browser.ie?"paddingBottom":"padding-bottom",paddingLeft:$$.browser.ie?"paddingLeft":"padding-left",paddingRight:$$.browser.ie?"paddingRight":"padding-right"};b.$$.OperationModes={NORMAL:"Normal",ROW_MODE:"RowMode",READ_ONLY:"ReadOnly",SINGLE_SELECT:"SingleSelect",MULTI_SELECT:"MultiSelect",EXTENDED_SELECT:"ExtendedSelect"};b.$$.CellTypes={EXTENDER:"ExtenderCellType",GENERAL:"GeneralCellType",MCCBCT:"MultiColumnComboBoxCellType",RADIO_BUTTON_LIST:"RadioButtonListCellType",CHECKBOX:"CheckBoxCellType"};function a(a){this.element=f(a);return this}a.prototype.convertXPathToSelector=function(){};if(!b.XMLDOMWrapper_ClearBlankRegEx)b.XMLDOMWrapper_ClearBlankRegEx=/\s+/g;a.prototype.convertSelectorToXPath=function(a){a=a.replace(b.XMLDOMWrapper_ClearBlankRegEx," ");a=(this.nodeContext==null||this.nodeContext==this.element.xmlDoc?"//":"./")+a;a=a.replace(/ /g,"/");var c=a.indexOf("[");while(c>=0){c++;a=a.substr(0,c)+"@"+a.substr(c);c=a.indexOf("[",c)}return a};a.prototype._getPreferredQueryObject=function(a,d){var b=this.getXMLDoc(),c=(this.element==null||!this.isNativeNode||b!=this.element.xmlDoc&&!$$.utils.contains(this.element.xmlDoc,b))&&this.isXML(b);if(d){if((this.isBuiltInXml||c)&&typeof b.selectSingleNode!="undefined")return{queryMethod:0,selector:a};if(b.querySelector){a=this.convertXPathToSelector(a);return{queryMethod:1,selector:a}}}else{if(b.querySelector&&!c)return{queryMethod:1,selector:a};if((this.isBuiltInXml||c)&&typeof b.selectSingleNode!="undefined"){a=this.convertSelectorToXPath(a);return{queryMethod:0,selector:a}}}if(d)a=this.convertXPathToSelector(a);return{queryMethod:-1,selector:a}};a.prototype.selectSingleNode=function(d,e){var c=this.getXMLDoc(),a=this._getPreferredQueryObject(d,e);switch(a.queryMethod){case-1:return $$.querySelector(c,a.selector);break;case 0:return c.selectSingleNode(a.selector);break;case 1:var b=c.querySelector(a.selector);if(typeof b=="Array")b=b[0];return b}return null};a.prototype.selectNodes=function(d,e){var c=this.getXMLDoc(),b=this._getPreferredQueryObject(d,e);switch(b.queryMethod){case-1:return $$.querySelector(c,b.selector);break;case 0:return c.selectNodes(b.selector);break;case 1:var a=c.querySelector(b.selector);if(a!=null&&typeof a!="Array")a=[a];return a}return null};a.prototype.textContent=function(a,b){if(arguments.length<2)return typeof a.textContent!="undefined"?a.textContent:typeof a.text!="undefined"?a.text:a.innerText;else if(typeof a.textContent!="undefined")a.textContent=b;else if(typeof a.text!="undefined")a.text=b;else a.innerText=b};a.prototype.lastChild=function(a){if(typeof a.lastChild!="undefined")return a.lastChild;else if(typeof a.lastElementChild!="undefined")return a.lastElementChild;else{var c=a.childNodes,b=c.length;return b>0?c[b-1]:null}};a.prototype.firstChild=function(a){if(typeof a.firstChild!="undefined")return a.firstChild;else if(typeof a.firstElementChild!="undefined")return a.firstElementChild;else{var b=a.childNodes;return b.length==0?null:b[0]}};a.prototype.firstElementChild=function(a,d){if(typeof a.firstElementChild!="undefined")return a.firstElementChild;else if(typeof a.firstChild!="undefined"){var a=a.firstChild;while(a!=null&&!(a.nodeType==1||d&&a.nodeType==9))a=a.nextSibling;return a}else{for(var c=a.childNodes,b=0,e=c.length;b<e;b++){var a=c[b];if(a.nodeType==1)return a}return null}};a.prototype.nextSibling=function(a){if(typeof a.nextSibling!="undefined")return a.nextSibling;else if(typeof a.nextElementSibling!="undefined")return a.nextElementSibling;else{var c=a.parentNode;if(c!=null){var b=c.childNodes,d=b.indexOf(a);if(d<b.length-1)return b[d+1]}}return null};a.prototype.nextElementSibling=function(a,e){if(typeof a.nextElementSibling!="undefined")return a.nextElementSibling;else if(typeof a.nextSibling!="undefined"){var a=a.nextSibling;while(a!=null&&!(a.nodeType==1||e&&a.nodeType==9))a=a.nextSibling;return a}else{var d=a.parentNode;if(d!=null)for(var b=d.childNodes,g=b.indexOf(a),c=g+1,f=b.length;c<f;c++){var a=b[c];if(a.nodeType==1)return a}}return null};a.prototype.createElement=function(b){var a=this.getXMLDoc();return a.createElement(b)};a.prototype.belongToElement=function(a){return a!=null&&this.element==a};a.prototype.switchNodeContext=function(a){this.nodeContext=a};a.prototype.resetNodeContext=function(){this.nodeContext=null};a.prototype.isXML=function(a){var b=(a?a.documentElement?a:a.ownerDocument:0).documentElement;return b?b.nodeName!=="HTML":false};a.prototype.getXMLDoc=function(){return this.nodeContext!=null?this.nodeContext:this.element.xmlDoc};a.prototype.loadXML=function(d){this.isNativeNode=false;this.isBuiltInXml=false;if(b.DOMParser){var e=new DOMParser,f=e.parseFromString(d,"text/xml");this.element.xmlDoc=f;this.isNativeNode=true}else if(typeof ActiveXObject!="undefined"){var a=null;try{a=new ActiveXObject("Msxml2.DOMDocument.6.0")}catch(g){}if(a==null){try{a=new ActiveXObject("Msxml2.DOMDocument.5.0")}catch(g){}if(a==null){try{a=new ActiveXObject("Msxml2.DOMDocument.4.0")}catch(g){}if(a==null){try{a=new ActiveXObject("Msxml2.DOMDocument.3.0")}catch(g){}if(a==null)try{a=new ActiveXObject("Microsoft.XMLDOM")}catch(g){}}}}if(a!=null){a.setProperty("SelectionLanguage","XPath");a.async="false";a.loadXML(d)}this.element.xmlDoc=a;this.isBuiltInXml=true}else if(c.implementation){var a=c.implementation.createDocument("","",null);a.loadXML(d);this.element.xmlDoc=a;this.isBuiltInXml=true}};a.prototype.serializeXML=function(){var c=this.getXMLDoc();return b.XMLSerializer?(new XMLSerializer).serializeToString(c):typeof c.xml!="undefined"?c.xml:a.exportToString(c)};a.importFromString=function(k,j,g){for(var h=0;h<j.childNodes.length;h++){var b=j.childNodes[h],d=null;if(b.nodeType==1||b.nodeType==3){if(b.nodeType==1){d=c.createElement(b.tagName);for(var e=0;e<b.attributes.length;e++){var f=b.attributes[e];d.getAttribute(f.nodeName)!=f.nodeValue&&d.setAttribute(f.nodeName,f.nodeValue)}a.importFromString(d,b,g)}else d=c.createTextNode(b.nodeValue);k.appendChild(d);if(g==null||g==true)if(b.nodeType==1&&b.attributes.length>0){for(var i=[],e=0;e<b.attributes.length;e++)i.push(b.attributes[e].nodeName);d._fpAttrNames=i}}}};a.exportToString=function(b){if(b.nodeType==3)return b.nodeValue;var d="<"+b.nodeName;if(b._fpAttrNames==null||b._fpAttrNames.length==0)for(var c=0;c<b.attributes.length;c++){var e=b.attributes[c];if(!e.specified)continue;d+=" "+e.nodeName+'="'+e.nodeValue+'"'}else for(var c=0;c<b._fpAttrNames.length;c++){var f=b._fpAttrNames[c],g=b.getAttribute(f);if(g==null)continue;d+=" "+f+'="'+g+'"'}d+=">";for(var c=0;c<b.childNodes.length;c++)d+=a.exportToString(b.childNodes[c]);d+="</"+b.nodeName+">";return d};b.$$.fn={createXMLDOMWrapper:function(d){var c=f(d);if(c.__xmlDOMWrapper!=null)return c.__xmlDOMWrapper;var b=new a(d);b.element.__xmlDOMWrapper=b;return b}};b.$$.support=new function(){var a=$$.browser,b=a.ie&&a.version>=9};b.$$.querySelector=function(o,k,v){if(k==null||k=="")return null;o=o||c;var w=$$.browser;k+=" ";for(var x=k.length,l={next:null,attributes:[]},a=l,i=null,e=null,d=[],u=false,g=false,n=false,q=0;q<x;q++){e=k.charAt(q);u=e==" "||e=="\n"||e=="\r";if(e=="["||e=="]"||e=="="||u){if(g&&e=="["||!g&&(e=="="||e=="]"))throw"invalid selector";if(d.length>0){if(!g){a.next={tag:d.join(""),next:null,attributes:[]};a=a.next}else{if(i==null)throw"invalid selector";if(!n){i.name=d.join("");n=e=="="}else{if(d[0]=="'"&&d[d.length-1]=="'"||d[0]=='"'&&d[d.length-1]=='"'){d.pop();d.shift()}i.value=d.join("");n=false}}d=[]}if(!g&&e=="[")g=true;else if(g&&e=="]")g=false;if(g&&i==null){i={name:null,value:null};a.attributes.push(i)}else if(!g&&i!=null)i=null;continue}d.push(e)}if(l.next==null&&l.attributes.length==0)throw"invalid selector";a=l;var f=[o],b=null;do{b=f;f=[];if(a.tag!=null)while(b.length>0)for(var p=b.shift(),m=p.getElementsByTagName(a.tag),h=0;h<m.length;h++)f.push(m[h]);else if(a==l&&a.attributes.length>0)for(var h=0,z=b.length;h<z;h++)for(var p=b[h],m=w.ie?p.all:p.getElementsByTagName("*"),j=0,y=m.length;j<y;j++)f.push(m[j]);else f=b;if(f.length>0&&a.attributes.length>0){b=[];for(var h=0;h<f.length;h++){for(var t=f[h],r=true,j=0;j<a.attributes.length;j++){var s=a.attributes[j];if(t.getAttribute(s.name)!=s.value){r=false;break}}r&&b.push(t)}f=b}else b=f;a=a.next}while(a!=null);return b==null||b.length==0?null:v||b.length>1?b:b[0]};b.$$.utils={binarySearch:function(e,a,l){var d=l||{};if(d.start==null)d.start=0;if(d.end==null)d.end=Math.min(a,e.length-1);var h=d.end;if(a<0||h<0)return-1;var i=d.nearestPossible,g=d.getValueHandler||$$.utils._defaultGetValueHandler,j=d.start,k=d.end,c=g(e,0);if(a==c)return 0;else if(a<c)return i?0:-1;c=g(e,h);if(a==c)return h;else if(a>c)return i?h:-1;var b=j+k>>1,f=g(e,b);while(f!=a&&j<k){if(a<f){if(i){c=g(e,b-1);if(a>c)return a-c>f-a?b:b-1}k=b-1}else{if(i){c=g(e,b+1);if(a<c)return a-f<c-a?b:b+1}j=b+1}b=j+k>>1;f=g(e,b)}return f==a?b:-1},_defaultGetValueHandler:function(a,b){return a[b]},replaceAll:function(a,d,c){if(a==null)return a;var b=a.length;while(true){a=a.replace(d,c);if(a.length==b)break;b=a.length}return a},countChar:function(a,c){if(a==null||a.length==0||c==null)return-1;for(var d=0,b=0;b<a.length;b++)if(a.charAt(b)==c)d++;return d},htmlEncode:function(c,f){if(c==null||c=="")return c;var a=new String(c);a=a.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");a=a.replace(/\"/g,"&quot;");if(f)return a;a=a.replace(/\r\n/g,"\n");for(var b=a.split("\n"),d=0;d<b.length;d++){var a=b[d],e=a.length;if(a.charAt(0)==" ")a="&nbsp;"+a.substr(1);if(e>=2&&a.charAt(a.length-1)==" ")a=a.substr(0,a.length-1)+"&nbsp;";b[d]=e>=4?a.replace(/\u0020\u0020/g," &nbsp;"):a}return b.join("<br>")},htmlDecode:function(b){if(b==null||b=="")return b;var a=b;a=a.replace(/<br\/?>/gi,"\n");a=a.replace(/&nbsp;/g," ");a=a.replace(/&lt;/g,"<");a=a.replace(/&gt;/g,">");a=a.replace(/&quot;/g,'"');a=a.replace(/&amp;/g,"&");return a},getPlainHtmlText:function(a){if(a==null||a=="")return a;for(var b=a.split(/<\s*br\s*\/?\s*>/gi),c=0;c<b.length;c++)b[c]=b[c].replace(/<\s*[^>]*>/g,"");return b.join("<br>")},getTopLevelElements:function(a){var d=[],c=0;while(a.length>c){for(var g=a[c],f=true,b=0;b<a.length;b++){if(b==c)continue;var h=a[b],e=this.comparePosition(g,h);if((e&8)==8){a.splice(c,1);f=false;break}else if((e&16)==16){a.splice(b,1);b--;continue}}if(f){d.push(g);c++}}return d},getElementsByTagName:function(f,a){a=a||c;for(var d=a.getElementsByTagName(f),e=[],b=0,g=d.length;b<g;b++)e.push(d[b]);return e},comparePosition:function(a,b){return a.compareDocumentPosition?a.compareDocumentPosition(b):a.contains?(a!=b&&a.contains(b)&&16)+(a!=b&&b.contains(a)&&8)+(a.sourceIndex>=0&&b.sourceIndex>=0?(a.sourceIndex<b.sourceIndex&&4)+(a.sourceIndex>b.sourceIndex&&2):1)+0:0},contains:function(a,b){return a.contains?a!=b&&a.contains(b):!!(a.compareDocumentPosition(b)&16)},cleanArray:function(){if(arguments.length>0)for(var c=0;c<arguments.length;c++){var a=arguments[c];if(a!=null&&typeof a=="object")for(var b=a.length-1;b>=0;b--)a[b]==null&&a.splice(b,1)}},stringEquals:function(a,b){if(a==b)return true;if(a==null||b==null||a.length!=b.length)return false;for(var c=0;c<a.length;c++){var d=a.charCodeAt(c),e=b.charCodeAt(c);if(d!=e){if((d==32||d==160)&&(e==32||e==160))continue;return false}}return true},createEvent:function(g,e,f,d){var b=c.createEvent("Events"),a=arguments.length;b.initEvent(g,a<2?true:e,a<3?true:f);if(a>3)for(i in d)b[i]=d[i];return b},fireEvent:function(a,b){a.dispatchEvent(b)},attachEvent:function(c,d,b,e){if(arguments.length<3){var a=c["on"+d];if(typeof a=="function")b=a}FarPoint.System.AttachEvent(c,d,b,e)},detachEvent:function(c,d,b,e){if(arguments.length<3){var a=c["on"+d];if(typeof a=="function")b=a}FarPoint.System.DetachEvent(c,d,b,e)},cancelBubble:function(a){if(a==null)return;if(typeof a.stopPropagation!="undefined")a.stopPropagation();else a.cancelBubble=true},cloneNode:function(b){for(var d=c.createElement(b.tagName),f=0;f<b.attributes.length;f++){var e=b.attributes[f];e.specified&&d.setAttribute(e.nodeName,e.nodeValue)}a.importFromString(d,b,false);this.cloneChildrenProperties(b,d);return d},cloneChildrenProperties:function(d,c){for(var f=d.getElementsByTagName("select"),i=c.getElementsByTagName("select"),a=0;a<f.length;a++)i[a].selectedIndex=f[a].selectedIndex;for(var b=d.getElementsByTagName("INPUT"),g=c.getElementsByTagName("INPUT"),a=0;a<b.length;a++)if(b[a].type=="checkbox"){if($$.browser.ie&&$$.browser.version>=9)g[a].value=b[a].value;g[a].checked=b[a].checked}for(var e=d.getElementsByTagName("TEXTAREA"),h=c.getElementsByTagName("TEXTAREA"),a=0;a<e.length;a++)h[a].value=e[a].value},getColumnCount:function(b){var a=b.getElementsByTagName("COLGROUP");return a!=null&&a.length>0?a[0].children.length:0},getMinColumnsWidth:function(q,t){var p=q.length;if(p==0)return null;for(var d=[],f=Number.MAX_VALUE,g=0;g<p;g++)f=Math.min(f,this.getColumnCount(q[g]));for(var m=0;m<f;m++)d.push(0);for(var r=[],g=0;g<p;g++){var h=q[g],j=h.getElementsByTagName("COLGROUP");if(j!=null&&j.length>0)j=j[0];for(var k=h.rows,v=k.length,b=0;b<f;b++){for(var e=0;e<v;e++){var c=k[e],n=c.__nextColumn;if(n==null||n==b){var i=c.__cellIndex;if(i==null)i=0;if(i>=c.cells.length){c.__nextColumn=f;continue}var a=c.cells[i];if(a.colSpan<=1){if(d[b]<a.offsetWidth)d[b]=a.offsetWidth}else{if(j!=null)for(var l=b,C=Math.min(b+a.colSpan,f);l<C;l++){var w=t(h,l);if(d[l]<w)d[l]=w}r.push({col:b,cell:a,table:h})}c.__cellIndex=i+1;if(c.__cellIndex>=c.cells.length)c.__nextColumn=f;else c.__nextColumn=(n==null?0:n)+a.colSpan;if(a.rowSpan>1)for(var u=0,B=a.rowSpan-1;u<B;u++){e++;k[e].__nextColumn=c.__nextColumn}}}d[b]=Math.max(d[b],t(h,b))}for(var e=0;e<v;e++){k[e].__cellIndex=null;k[e].__nextColumn=null}}for(var m=0,D=r.length;m<D;m++){for(var y=r[m],a=y.cell,x=y.col,z=parseInt(h.cellSpacing),o=0,s=0,A=a.colSpan;s<A;s++)o+=d[x+s];o+=(a.colSpan-1)*z;if(o<a.offsetWidth)d[x]+=a.offsetWidth-o}return d}};$$.DEBUG={Clear:function(){typeof DEBUG!="undefined"&&DEBUG.Clear()},Write:function(a){typeof DEBUG!="undefined"&&DEBUG.Write(a)},WriteLine:function(a){typeof DEBUG!="undefined"&&DEBUG.WriteLine(a)},Log:function(b,a){typeof DEBUG!="undefined"&&DEBUG.Log(b,a)},Trace:function(){typeof DEBUG!="undefined"&&DEBUG.Trace()}}})(window);var FpSpreadJS=function(c,d,a){this.spread=c;this.context=d;this.childViewIndexes=[];this.cachedValues={};if(a!=null)for(var b in a.cachedValues)this.cachedValues[b]=a.cachedValues[b]};FpSpreadJS.prototype.constructor=FpSpreadJS;FpSpreadJS.prototype.getGridLineOffsetTop=function(a){if(typeof a.__$gridlineOffsetTop$=="undefined")if($$.browser.quirksMode||parseInt(a.cellSpacing)>0||a.rows.length==0||a.rows[0].cells.length==0)a.__$gridlineOffsetTop$=0;else{var d=a.rows[0].cells,b=0;if($$.browser.ie){for(var c=0,g=d.length;c<g;c++){var e=$$(d[c]).border("Top");if(b<e)b=e}a.__$gridlineOffsetTop$=b>1?b>>1:0}else{for(var c=0,g=d.length;c<g;c++){var f=d[c].offsetTop;if(b<f)b=f}a.__$gridlineOffsetTop$=b}}return a.__$gridlineOffsetTop$};FpSpreadJS.prototype.getGridLineOffsetLeft=function(a){if(typeof a.__$gridlineOffsetLeft$=="undefined")if($$.browser.quirksMode||parseInt(a.cellSpacing)>0||a.rows.length==0||a.rows[0].cells.length==0)a.__$gridlineOffsetLeft$=0;else if($$.browser.ie){var b=$$(a.rows[0].cells[0]).border("Left");a.__$gridlineOffsetLeft$=b>1?b>>1:0}else a.__$gridlineOffsetLeft$=a.rows[0].cells[0].offsetLeft;return a.__$gridlineOffsetLeft$};FpSpreadJS.prototype.getGridLineOffsetRight=function(a){if(typeof a.__$gridlineOffsetRight$=="undefined")if($$.browser.quirksMode||parseInt(a.cellSpacing)>0||a.rows.length==0||a.rows[0].cells.length==0)a.__$gridlineOffsetRight$=0;else if($$.browser.ie){var b=$$(a.rows[0].cells[a.rows[0].cells.length-1]).border("Right");a.__$gridlineOffsetRight$=b>1?b>>1:0}else{var c=a.rows[0].cells[a.rows[0].cells.length-1],d=c.offsetLeft+c.offsetWidth;a.__$gridlineOffsetRight$=a.offsetWidth-d}return a.__$gridlineOffsetRight$};FpSpreadJS.prototype.getGridLineOffsetBottom=function(a){if(typeof a.__$gridlineOffsetBottom$=="undefined")if($$.browser.quirksMode||parseInt(a.cellSpacing)>0||a.rows.length==0||a.rows[0].cells.length==0)a.__$gridlineOffsetBottom$=0;else{var d=a.rows[a.rows.length-1].cells,b=0;if($$.browser.ie){for(var c=0,g=d.length;c<g;c++){var f=$$(d[c]).border("Bottom");if(b<f)b=f}a.__$gridlineOffsetBottom$=b>1?b>>1:0}else{for(var c=0,g=d.length;c<g;c++){var h=d[c].offsetTop+d[c].offsetHeight,e=a.offsetHeight-h;if(b<e)b=e}a.__$gridlineOffsetBottom$=b}}return a.__$gridlineOffsetBottom$};FpSpreadJS.prototype.getGridLineOffsetVertical=function(a){return this.getGridLineOffsetTop(a)+this.getGridLineOffsetBottom(a)};FpSpreadJS.prototype.getGridLineOffsetHorizontal=function(a){return this.getGridLineOffsetLeft(a)+this.getGridLineOffsetRight(a)};FpSpreadJS.prototype.getDisplayIndex=function(a){if(a<0)return-1;if(this.childViewIndexes.length==0)return a;var b=this.context,d=[null,null],e=b.getViewport0(),f=b.getViewport1(),g=b.getViewport2(),k=b.getViewport();if(e!=null&&e.rows.length>0)d[0]=e;else if(f!=null&&f.rows.length>0)d[0]=f;if(g!=null&&g.rows.length>0)d[1]=g;else d[1]=k;var h=b.frzRowCount();if(a<h||a<this.childViewIndexes[0])return a;if(a>=h+d[1].rows.length-this.childViewIndexes.length)return-1;var j={nearestPossible:true,getValueHandler:function(c,a){var b=c[a]-(a+1),d=1-1/(a+1);return b+d}},c=$$.utils.binarySearch(this.childViewIndexes,a,j);if(c<0)return a;var i=this.childViewIndexes[c]-(c+1);return a<=i?a+c:a+c+1};FpSpreadJS.prototype.getSheetIndex=function(a){if(a<0)return-1;if(this.childViewIndexes.length==0)return a;var c=this.context,b=[null,null],e=c.getViewport0(),f=c.getViewport1(),g=c.getViewport2(),i=c.getViewport();if(e!=null&&e.rows.length>0)b[0]=e;else if(f!=null&&f.rows.length>0)b[0]=f;if(g!=null&&g.rows.length>0)b[1]=g;else b[1]=i;var h=c.frzRowCount();if(h>0&&a<b[0].rows.length)return a;if(a>=h+b[1].rows.length)return-1;var d=$$.utils.binarySearch(this.childViewIndexes,a,{nearestPossible:true});return d<0?a:a>this.childViewIndexes[d]?a-(d+1):a-d};FpSpreadJS.prototype.getRowRangeFromCell=function(e){var h=this.context.getRowFromCell(e);if(this.context.getAttributeInternal("layoutMode")!=null){var d=e.parentNode.rowIndex,f=this.context.getViewportFromCell(e);if(f!=null){var b=f.rows,a=d,c=a,g=b[d].getAttribute("FpKey");while(a>0&&b[a-1].getAttribute("FpKey")==g)a--;var i=b.length-1;while(c<i&&b[c+1].getAttribute("FpKey")==g)c++;return{row:h-(d-a),rowCount:c-a+1}}}return{row:h,rowCount:1}};FpSpreadJS.prototype.getNextKeyedRow=function(a,b){b.index=-1;b.key=null;if(a<0)return;var d=this.context.GetRowCountInternal(),c=null;while(a<d){c=this.context.getRowKeyFromRow(a);if(c!=null&&c!="newRow"){b.index=a;b.key=c;return}a++}};FpSpreadJS.prototype.getPreviousKeyedRow=function(a,b){b.index=-1;b.key=null;var c=this.context.GetRowCountInternal();if(a>=c)return;while(a>-1){key=this.context.getRowKeyFromRow(a);if(key!=null&&key!="newRow"){b.index=a;b.key=key;return}a--}};FpSpreadJS.prototype.getRowByKey=function(b,e){if(b=="-1")return-1;if(b=="newRow")return this.getIndexOfNewRow(e);var f=this.context,j=parseInt(b),c=0,d=f.GetRowCountInternal()-1,g=-1,a={};while(c<=d){g=c+d>>1;this.getNextKeyedRow(g,a);(a.index==-1||a.index>d)&&this.getPreviousKeyedRow(g-1,a);if(a.index==-1||a.index<c||a.key==b)break;if(parseInt(a.key)<j)c=a.index+1;else d=a.index-1}if(a.key==b){for(var i=a.index,h=a.index-1;h>=0;h--){if(f.getRowKeyFromRow(h)!=b)break;i--}return i}return typeof e!="undefined"?e:f.GetRowCountInternal()>0?0:-1};FpSpreadJS.prototype.getIndexOfNewRow=function(d){var b=this.context.getViewport1();if(b!=null)for(var a=0;a<b.rows.length;a++)if(b.rows[a].getAttribute("FpKey")=="newRow")return a;var c=this.context.getViewport();if(c!=null)for(var e=b!=null?b.rows.length:0,a=0;a<c.rows.length;a++)if(c.rows[a].getAttribute("FpKey")=="newRow")return a+e;return d?d:c!=null?0:-1};FpSpreadJS.prototype.countChildViews=function(){var b=FpSpreadJS.getChildViews(this.spread);this.childViewIndexes=[];for(var a=0;a<b.length;a++){var c=b[a].parentNode.parentNode;this.childViewIndexes.push(c.rowIndex)}};FpSpreadJS.prototype.correctFocusOnActiveCell=function(b){if(this.spread.document.FpActiveSpread!=this.spread)return;if(this.spread.getAttributeInternal("OperationMode")!="Normal")return;if(b!=null&&!this.spread.isHeaderCell(b)){var d=this.spread.getEditor(b),a=this.spread.document.activeElement;if(d!=null&&a!=d&&!FarPoint.System.IsChild(d,a)){if(a!=null&&a!=""){for(var i=[this.context.getFrozColHeader(),this.context.getColHeader(),this.context.getFrozRowHeader(),this.context.getRowHeader()],c=false,f=$$.browser,e=0;e<4;e++){var h=i[e];if(h==null)continue;if(FarPoint.System.IsChild(h,a)||f.version==6&&a==this.context.textBox)if(a.tagName=="INPUT"||a.tagName=="TEXTAREA"||a.tagName=="SELECT"||a.tagName=="BUTTON"){c=true;break}}var g=this.context.getCommandBar();if(g!=null&&f.version==6&&FarPoint.System.IsChild(g,a))c=true;if(c)return}this.spread.setEditorFocus(b)}}};FpSpreadJS.prototype.getNextColumn=function(i,a,g,f,d){var b=null,c=this.spread.GetColCount();if(c==0)return-1;var e=a;do{b=this.spread.getCellFromRowCol(i,a);if(b==null)break;var h=g&&b.getAttribute("TabStop")=="false"||f&&b.getAttribute("canFocus")=="false";if(!h)break;if(b==null)a++;else a+=parseInt(b.colSpan);if(d){if(a==c)a=0;if(a==e)return-1}}while(a<c);return a>=c?-1:a};FpSpreadJS.prototype.isCommandButtonEnabled=function(a){return a!=null&&!a.disabled&&a.className!="aspNetDisabled"};FpSpreadJS.prototype.createPasteCapturing=function(){var a=document.getElementById(this.spread.id+"_PasteCapturing");if(a==null){a=document.createElement("div");a.id=this.spread.id+"_PasteCapturing";a.style.position="absolute";a.style.height="1px";a.style.width="1px";a.style.top="-1000px";a.style.left="-1000px";a.style.whiteSpace="pre";a.setAttribute("contentEditable",true);this.spread.appendChild(a)}};FpSpreadJS.prototype.getExtender=function(a){var b=null;if(a!=null)do{if(a.id!=null&&a.id.indexOf(this.spread.id)>=0){var b=a.getAttribute("Extenders");if(b!=null)break}a=a.parentElement}while(a!=null&&a.parentNode.getAttribute("FpSpread")==null);return b};FpSpreadJS.prototype.buildTargetColsMoved=function(a,f,e){if(a!=null&&a.length>0){var c=a.slice(0,a.length),b=e-f;if(b>0)b--;if(b!=0)for(var d=0;d<c.length;d++)c[d]+=b;return c}return null};FpSpreadJS.prototype.getOperationMode=function(){return FpSpreadJS.attribute(this.spread,"OperationMode")};FpSpreadJS.prototype.getSelectionPolicy=function(){return FpSpreadJS.attribute(this.spread,"SelectionPolicy")};FpSpreadJS.prototype.updateSelectionRangeFromCell=function(d){var m=this.getOperationMode();if(d==null||d.document!=this.spread.document||this.context.getRowKeyFromCell(d)==null||m=="MultiSelect"||m=="ExtendedSelect")return;var s=this.spread,u=FpSpreadJS.attribute(s,"layoutMode");if(FpSpreadJS.attribute(s,"mcctCellType")=="true")return;var e=d.parentNode.getAttribute("FpSpread");if(e=="r"||e=="rh"||e=="ch"){var o=d.getAttribute("col");if(e=="r"&&m!="RowMode"&&o=="-1")return;var b=null,c=null,j=null,k=null;if(e=="r"||e=="ch"){if(o!=null&&o!="-1")c=parseInt(o);else if(o==null){var i=this.context.getColFromCell(d);if(i>=this.context.frzColCount())i=i-this.context.frzColCount();var p=this.context.getColGroup(d.parentNode.parentNode.parentNode);if(p.childNodes.length>i&&p.childNodes[i].getAttribute("FpCol")!=null)c=parseInt(p.childNodes[i].getAttribute("FpCol"))}else c=0;if(e=="ch")b=j=-1}if(e=="r"||e=="rh"){b=this.context.getRowKeyFromCell(d);if(e=="rh")c=k=-1}if(b>-1||b=="newRow")j=1;if(c>-1)k=1;if((b>-1||b=="newRow")&&c>-1&&m!="Normal"&&m!="ReadOnly"){c=-1;k=-1;if(u!=null){var g=d.parentNode.previousSibling;while(g!=null&&g.getAttribute("FpKey")==b)g=g.previousSibling;if(g!=null&&g.getAttribute("FpKey")==b)b=g.getAttribute("FpKey");j=parseInt(s.getAttribute("layoutrowcount"))}else j=1}var r=this.context.getLeadingCellRow(),q=this.context.getLeadingCellCol();if(r>-1&&q>-1&&this.context.getCellFromRowCol(r,q)==d){if(b=="newRow"||b>-1)b=this.context.getRowKeyFromRow(r);if(u==null)if(c>-1)c=this.context.getColKeyFromCol(q)}if(b!=null&&c!=null&&j!=null&&k!=null){for(var f=this.context.getSelection(),w=[],h=0;h<f.childNodes.length;h++){var n=f.childNodes[h];w.push({row:n.getAttribute("row")=="newRow"?"newRow":parseInt(n.getAttribute("row")),col:parseInt(n.getAttribute("col")),rowCount:parseInt(n.getAttribute("rowcount")),colCount:parseInt(n.getAttribute("colcount"))})}var l={row:b=="newRow"?"newRow":parseInt(b),col:parseInt(c),rowCount:j,colCount:k},v=false;if(!FpSpreadJS.isNestedInRanges(l,w))v=true;if(v){for(var a=null,h=0;h<f.childNodes.length;h++)if(f.childNodes[h].getAttribute("anchor")!=null){a=f.childNodes[h];break}if(a==null){if(this.context.createSelectionNode)a=this.context.createSelectionNode(-1,-1,-1,-1);else if(document.all!=null&&this.context.getData)a=this.context.getData().createNode("element","range","");else{a=document.createElement("range");a.style.display="none"}var t=f.childNodes[0];if(t!=null)f.insertBefore(a,t);else f.appendChild(a);a.setAttribute("anchor","true")}a.removeAttribute("rowIndex");a.removeAttribute("colIndex");a.setAttribute("row",l.row);a.setAttribute("col",l.col);a.setAttribute("rowcount",l.rowCount);a.setAttribute("colcount",l.colCount);this.context.updateSelectionViewIndexes(a)}}}};FpSpreadJS.prototype.keepGeneratedSelectionFromAnchorCell=function(){var b=this.context.getSelection();if(b!=null)for(var c=b.childNodes,a=0,e=c.length;a<e;a++){var d=c[a];if(d.getAttribute("anchor")!=null){d.removeAttribute("anchor");break}}};FpSpreadJS.prototype.isOutOfView=function(a){if(a==null)return true;var g=this.context.getTopSpread();if(this.spread!=g&&g!=null)return g.fpSpreadJS.isOutOfView(a);for(var f=[this.context.getViewport1(),this.context.getViewport2(),this.context.getViewport()],h=false,d=0;d<f.length;d++)if(f[d]!=null&&this.context.isChild(a,f[d])){h=true;break}if(!h)return true;var e=this.context.getScrollvp();if(e==null)e=this.context.getViewport().parentNode;var b=e.getBoundingClientRect(),c=a.getBoundingClientRect();return c.top<b.top||c.bottom>b.bottom||c.left<b.left||c.right>b.right};FpSpreadJS.attribute=function(b,a,c){if(typeof c=="undefined")return $$.browser.ie&&$$.browser.version<9?b[a]:b.getAttribute(a);else if($$.browser.ie&&$$.browser.version<9)b[a]=c;else b.setAttribute(a,c)};FpSpreadJS.isChildSpreadRow=function(d,e){if(d==null)return false;if(e>=0&&e<d.rows.length){var a=d.rows[e].cells[0];if(a){var b=null;if(a.children)b=a.children[0];else for(var c=0;c<a.childNodes.length;c++)if(a.childNodes[c].nodeType==1){b=a.childNodes[c];break}if(b!=null&&FpSpreadJS.attribute(b,"FpSpread")=="Spread")return true}}return false};FpSpreadJS.getChildViews=function(e){var a=FpSpreadJS.attribute(e,"expandedRowKeys");if(a==null||a=="")return[];for(var d=[],g=a.split(","),b=0;b<g.length;b++)for(var h=g[b].split("_"),j=h[0],i=parseInt(h[1]),c=0;c<i;c++){var k=e.id+"_"+j+"_"+c,f=document.getElementById(k);f!=null&&d.push(f)}return d};FpSpreadJS.getAllChildViews=function(b){var a=[];FpSpreadJS.loadAllChildViews(b,a);return a};FpSpreadJS.loadAllChildViews=function(d,c){for(var b=FpSpreadJS.getChildViews(d),a=0;a<b.length;a++){c.push(b[a]);FpSpreadJS.loadAllChildViews(b[a],c)}};FpSpreadJS.checkInitLayoutCompleted=function(c){if(!c.initLayoutCompleted)return false;for(var b=FpSpreadJS.getChildViews(c),a=0;a<b.length;a++){var d=b[a];if(!FpSpreadJS.checkInitLayoutCompleted(d))return false}return true};FpSpreadJS.mergeRanges=function(e){if(e.length==0)return null;for(var d=[],c=0;c<e.length;c++){var a=e[c],b={row:a.row,col:a.col,rowCount:a.rowCount,colCount:a.colCount};if(a.row<0&&a.rowCount!=0){b.row=0;b.rowCount=Number.MAX_VALUE}if(a.col<0&&a.colCount!=0){b.col=0;b.colCount=Number.MAX_VALUE}d.push(b)}for(var a=d[d.length-1],c=d.length-2;c>=0;c--){var b=d[c];if(a.row>=b.row&&a.col>=b.col&&a.row+a.rowCount<=b.row+b.rowCount&&a.col+a.colCount<=b.col+b.colCount)a=b}if(a.rowCount==Number.MAX_VALUE)a.row=a.rowCount=-1;if(a.colCount==Number.MAX_VALUE)a.col=a.colCount=-1;return a};FpSpreadJS.isNestedInRanges=function(a,e){if(e.length==0)return false;e.push(a);for(var d=[],c=0;c<e.length;c++){a=e[c];var b={row:a.row,col:a.col,rowCount:a.rowCount,colCount:a.colCount};if(a.row<0&&a.rowCount!=0){b.row=0;b.rowCount=Number.MAX_VALUE}if(a.col<0&&a.colCount!=0){b.col=0;b.colCount=Number.MAX_VALUE}d.push(b)}a=d[d.length-1];for(var c=d.length-2;c>=0;c--){var b=d[c];if(a.row=="newRow"&&b.row=="newRow"&&a.col>=b.col&&a.col+a.colCount<=b.col+b.colCount||a.row>=b.row&&a.col>=b.col&&a.row+a.rowCount<=b.row+b.rowCount&&a.col+a.colCount<=b.col+b.colCount)return true}return false};FpSpreadJS.getAllSpreads=function(a){var b=[a];FpSpreadJS.__getAllChildSpreads(a.id,b);return b};FpSpreadJS.__getAllChildSpreads=function(e,b){for(var c=FpSpreadJS.getChildViews(document.getElementById(e)),a=0;a<c.length;a++){var d=c[a];b.push(d);FpSpreadJS.__getAllChildSpreads(d.id,b)}};FpSpreadJS.getTableRow=function(b){if(b==null)return null;var a=b;do{if(a.tagName=="TR")return a;a=a.parentNode}while(a!=null&&a!=document.body&&a!=document);return null};FpSpreadJS.getTable=function(b){if(b==null)return null;var a=b;do{if(a.tagName=="TABLE")return a;a=a.parentNode}while(a!=null&&a!=document.body&&a!=document);return null};FpSpreadJS.prototype.getDataView=function(){var c=this.spread.getViewport();if(c!=null)c=c.parentNode;var f=c!=null?c.getBoundingClientRect():null,b=this.spread.getViewport1();if(b!=null)b=b.parentNode;var h=b!=null?b.getBoundingClientRect():null,d=this.spread.getRowHeader(),g=d!=null?d.getBoundingClientRect():null,e=this.spread.getBoundingClientRect(),a={left:0,right:0,top:0,bottom:0,width:0,height:0};a.left=d!=null?g.right:e.left;a.right=e.right;a.top=b!=null?h.top:f.top;a.bottom=f.bottom;a.width=a.right-a.left;a.height=a.bottom-a.top;return a}